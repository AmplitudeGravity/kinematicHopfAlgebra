(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    305300,       8425]
NotebookOptionsPosition[    291911,       8210]
NotebookOutlinePosition[    292537,       8230]
CellTagsIndexPosition[    292494,       8227]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Copyright", " ", "2022"}], ",", 
   RowBox[{"Gang", " ", "Chen", " ", 
    RowBox[{"AmplitudeGravity", "/", "kinematicHofpAlgebra"}], " ", "is", " ",
     "licensed", " ", "under", " ", "the", "\n", "GNU", " ", "General", " ", 
    "Public", " ", "License", " ", "v3", ".0", "\n", "\[IndentingNewLine]", 
    "Permissions", " ", "of", " ", "this", " ", "strong", " ", "copyleft", 
    " ", "license", " ", "are", " ", "conditioned", " ", "on", " ", "making", 
    " ", "available", " ", "complete", " ", "source", " ", "code", " ", "of", 
    " ", "licensed", " ", "works", " ", "and", " ", "modifications"}], ",", 
   RowBox[{
   "which", " ", "include", " ", "larger", " ", "works", " ", "using", " ", 
    "a", " ", "licensed", " ", "work"}], ",", 
   RowBox[{"under", " ", "the", " ", "same", " ", 
    RowBox[{"license", ".", "Copyright"}], " ", "and", " ", "license", " ", 
    "notices", " ", "must", " ", "be", " ", 
    RowBox[{"preserved", ".", "Contributors"}], " ", "provide", " ", "an", 
    " ", "express", " ", "grant", " ", "of", " ", "patent", " ", 
    RowBox[{"rights", "."}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.869017756626953*^9, 3.869017796936942*^9}, 
   3.869017940661934*^9, {3.869017980837627*^9, 
   3.869017998586751*^9}},ExpressionUUID->"8b241212-cb5e-4c49-a1af-\
98e2bcd66219"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{
   RowBox[{
   "Updating", " ", "version", " ", "can", " ", "be", " ", "find", " ", "in", 
    " ", "\[IndentingNewLine]", 
    RowBox[{"https", ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{"github", ".", "com"}], "/", "AmplitudeGravity"}], "/", 
    "kinematicHofpAlgebra"}]}], "\[IndentingNewLine]", "  ", "*)"}]], "Input",\

 CellChangeTimes->{{3.869018008537681*^9, 3.869018031037306*^9}, {
  3.869018493558817*^9, 
  3.869018519707972*^9}},ExpressionUUID->"3393b6dd-2dd8-4da7-a9bf-\
4a90e4e4196d"],

Cell[CellGroupData[{

Cell["SubFunctions", "Chapter",
 CellChangeTimes->{{3.854428169619334*^9, 
  3.8544281730372477`*^9}},ExpressionUUID->"6f54012d-343c-4ceb-b753-\
c573c7d67539"],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"51c8b79b-932a-4bdd-86b8-\
9f06849e255f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"nice", ",", "nice2", ",", "niceF"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nice", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", "f", "]"}]}], ",", 
     RowBox[{
      RowBox[{"DOT", "[", 
       RowBox[{"f_", ",", "g_"}], "]"}], "\[RuleDelayed]", "  ", 
      RowBox[{"CenterDot", "[", 
       RowBox[{"f", ",", "g"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"CenterDot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "j_", "]"}]}], "]"}], ":>", 
      RowBox[{"CenterDot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "j", "]"}], ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "i_", "]"}], "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["\[Epsilon]", "i"]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["p", "i"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", "[", "i_", "]"}], "?", "vectorQ"}], "\[RuleDelayed]", 
      " ", 
      SubscriptBox["a", "i"]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"a_", "[", "i_", "]"}], "?", "tensorQ"}], "\[RuleDelayed]", 
      " ", 
      SubscriptBox["a", "i"]}], ",", 
     RowBox[{"spBracket", "\[Rule]", " ", "Diamond"}], ",", 
     RowBox[{
      RowBox[{"spB", "[", "\[Beta]", "]"}], "\[RuleDelayed]", " ", 
      OverscriptBox["u", "_"]}], ",", 
     RowBox[{
      RowBox[{"spA", "[", "\[Alpha]", "]"}], "\[RuleDelayed]", "v"}], ",", 
     RowBox[{
      RowBox[{"k", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}], ",", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}], ",", 
     RowBox[{
      RowBox[{"Q", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"f1_", ",", "f2_", ",", "f3_"}], "]"}], "\[RuleDelayed]", " ", 
      
      SubscriptBox["J", "f2"]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"f1_", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["J", "f2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nice2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"CenterDot", "[", 
       RowBox[{"f_Plus", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", 
       RowBox[{
        RowBox[{"T", "@@", "f"}], ",", "f2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"CenterDot", "[", 
       RowBox[{"f2_", ",", "f_Plus"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", 
       RowBox[{"f2", ",", 
        RowBox[{"T", "@@", "f"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"CircleTimes", "[", 
       RowBox[{"f___", ",", "g_Plus", ",", "f2___"}], "]"}], "\[RuleDelayed]",
       " ", 
      RowBox[{"CircleTimes", "[", 
       RowBox[{"f", ",", 
        RowBox[{"T", "@@", "g"}], ",", "f2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", 
      RowBox[{"TT", "[", 
       RowBox[{
        RowBox[{"{", "f", "}"}], "/.", 
        RowBox[{
         SubscriptBox["p", "i_"], "\[RuleDelayed]", "i"}]}], "]"}]}], " ", 
     ",", 
     RowBox[{
      RowBox[{"TT", "[", "f_", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["p", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"ToString", "/@", 
          RowBox[{"(", "f", ")"}]}]}], "]"}]]}], ",", 
     RowBox[{
      RowBox[{"s", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["s", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"ToString", "/@", 
          RowBox[{"(", "f", ")"}]}]}], "]"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"niceOutPut", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"StyleBox", "[", 
    RowBox[{"f", 
     StyleBox[",",
      FontSize->18], 
     RowBox[{"FontColor", "->", "Red"}], ",", 
     RowBox[{"FontSize", "\[Rule]", "24"}]}], "]"}], "//", 
   "DisplayForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"niceF", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", "f_", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", 
       RowBox[{"f", ",", "f"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", "f__", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", "f", "]"}]}], ",", 
     RowBox[{
      RowBox[{"p", "[", "i__", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["p", "i"]}], ",", 
     RowBox[{
      RowBox[{"F", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["F", "i"]}], ",", 
     RowBox[{
      RowBox[{"a", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["a", "i"]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, {3.8690121319931498`*^9, 3.869012234227087*^9}, {
   3.869012292726038*^9, 3.869012294757619*^9}, {3.869012453843219*^9, 
   3.86901245878794*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"55360a2d-4dd7-400f-a70c-a61b9360a901"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"rmzero", ",", "rmzeroT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmzero", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a_"}], "]"}], ":>", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "]"}], ",", "f__", ",", "v"}], "]"}], ":>", " ", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "]"}], ",", "g___"}], "]"}], ":>", " ", "0"}], ",", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"g___", ",", 
        RowBox[{"p", "[", "]"}]}], "]"}], ":>", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rmzeroT", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"{", "i_", "}"}], ",", "g___"}], "]"}], ":>", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"f__", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "h___"}], "}"}], ",", "g___"}], "]"}], ":>", 
      "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8639100301199923`*^9, 3.8639100395647917`*^9}, {
  3.8640214165550737`*^9, 3.864021456291898*^9}, {3.864021536231971*^9, 
  3.8640215419837313`*^9}, {3.864021580041175*^9, 3.8640215932269697`*^9}, {
  3.8645199733746853`*^9, 3.8645199817494373`*^9}, {3.8645210131438026`*^9, 
  3.864521016442172*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"4149be1f-54e8-4768-affb-873e3ffb7708"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "repg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repg", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"db980e6f-c9eb-40df-82ed-d128a8cd4e6a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotOnshell", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "n", "]"}], ",", "f_"}], "]"}], "\[RuleDelayed]", 
     " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"p", "[", "n", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "0", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"353b453e-7fe1-4c88-9e64-e211a751f1d3"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "sortS", ",", "zeroMomentum", ",", "onshell", ",", "onshellQCD", ",", 
   "massless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Sort", "[", 
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroMomentum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"i_", ",", "n"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshellQCD", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massless", "=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"d39168db-af52-466a-8c1c-3dce7bdae539"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "V2spBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2spBracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_", ",", "m_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.849943435749509*^9, 3.8499434443014603`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"efe94482-f280-4b66-8aa3-fed140d0cead"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "ddmBasis", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddmBasis", "[", "momlist_List", "]"}], " ", "/;", " ", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "momlist", "]"}], ">=", "3"}], ",", "True", ",", 
     
     RowBox[{
      RowBox[{"Message", "[", 
       RowBox[{"ddmBasis", "::", "notenoughpoints"}], "]"}], ";", "False"}]}],
     "]"}]}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"vectorQ", "[", "#", "]"}]}], ",", 
         RowBox[{"declareTensor", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
      "momlist"}], ";", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"#", ",", 
         RowBox[{"momlist", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Append", "[", 
          RowBox[{"#", ",", 
           RowBox[{"momlist", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Permutations", "[", 
         RowBox[{"momlist", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}]}], ")"}]}]}]}], "\n", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.750219695989455*^9, 3.750219699194501*^9}, 
   3.7502200338556128`*^9, 3.750220189898779*^9, {3.81000444896418*^9, 
   3.810004461445541*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"cdcdb279-a5ed-43f3-904b-5176a6e821cb"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"df94535a-4cf7-400a-8f0d-bc011efc1341"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"e91fa3ea-9348-4961-b522-401ec5557bd8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandFdot", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandFdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"66e83810-5681-4752-bf3a-11426cdcbc6b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lt", "=", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
     RowBox[{"ts", "=", 
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
   "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"cc5f4918-d6f8-4850-bf9f-ee49c7cde23b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"4ca1da07-81cb-4631-88a9-f703a50b34d5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"4b80cfac-5cc6-4749-b1cb-94688ff33281"]
}, Closed]],

Cell[CellGroupData[{

Cell["generating the binary products", "Section",
 CellChangeTimes->{{3.764420928752377*^9, 3.7644209329755793`*^9}, {
   3.764421063042801*^9, 3.7644210717599907`*^9}, 
   3.81000614946671*^9},ExpressionUUID->"cfb31aa4-4c33-47e3-9314-\
40b147b11cd7"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Diamond", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a_Plus", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a_", ",", "b_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"c___", ",", "a_Plus", ",", "b___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Diamond", "[", 
        RowBox[{"c", ",", "#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}],
    "//", "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "a__"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "a__"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "b__"}], "]"}]}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s_", ",", "a_J"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s_", ",", "a_J"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s_", ",", "b_J"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"a_p", ",", "s_"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"a_p", ",", "s_"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"b_p", ",", "s_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"a_Diamond", ",", "s_"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"a_Diamond", ",", "s_"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"b_Diamond", ",", "s_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.764498254732809*^9, 3.7644982826684504`*^9}, {
   3.764498424685361*^9, 3.764498432738016*^9}, {3.764498644867629*^9, 
   3.7644986464476223`*^9}, 3.764500349115676*^9, 3.764500948381895*^9, 
   3.76450101835398*^9, {3.764501048396812*^9, 3.764501103402779*^9}, {
   3.764501150206197*^9, 3.764501228600431*^9}, {3.764501731449318*^9, 
   3.76450176700736*^9}, {3.764732228905604*^9, 3.764732230068487*^9}, {
   3.7647523563601637`*^9, 3.76475241086663*^9}, {3.764752507803548*^9, 
   3.7647525352498817`*^9}, {3.764752571096532*^9, 3.764752613972445*^9}, {
   3.764752659317862*^9, 3.764752672805139*^9}, {3.76475581625874*^9, 
   3.764755835868349*^9}, {3.764755889665016*^9, 3.764755926290131*^9}, {
   3.76475596241984*^9, 3.764755987507457*^9}, {3.7647561077766314`*^9, 
   3.76475612616606*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"3b026f50-74e8-47ea-9b65-5708cecb4224"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"BinaryProduct", ",", "addOne"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BinaryProduct", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "v", ",", "bpX", ",", "bpvars2", ",", "h", ",", "h0", ",", "tt"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[GreaterEqual]", "2"}], ",", 
       RowBox[{
        RowBox[{"bpX", "=", 
         RowBox[{"{", 
          RowBox[{"X", "[", 
           RowBox[{
            RowBox[{"v", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"v", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}]}], ";", 
        RowBox[{"bpvars2", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "}"}], "}"}]}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"h", "=", 
         RowBox[{"{", "}"}]}], ";", "\n", "\t", 
        RowBox[{"h0", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "i", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", " ", 
        RowBox[{"tt", "=", 
         RowBox[{"addOne", "[", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "bpX", ",", "bpvars2"}], 
          "]"}]}], ";", 
        RowBox[{"bpX", "=", 
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", 
        RowBox[{"bpvars2", "=", 
         RowBox[{"tt", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", 
         RowBox[{"Length", "[", "v", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "bpX", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"addOne", "[", 
   RowBox[{"vi_", ",", "bpX_", ",", "bpvars2_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "sexpr", ",", "vars2", ",", "lv2", ",", "newvars", ",", "h", ",", "h0"}],
      "}"}], ",", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"h0", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "ii", "]"}], ";"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"sexpr", "=", 
         RowBox[{"bpX", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
        RowBox[{"vars2", "=", 
         RowBox[{"bpvars2", "[", 
          RowBox[{"[", "ii", "]"}], "]"}]}], ";", 
        RowBox[{"lv2", "=", 
         RowBox[{"Length", "[", "vars2", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"h", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"h", ",", 
              RowBox[{"{", 
               RowBox[{"sexpr", "/.", 
                RowBox[{
                 RowBox[{"vars2", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], "\[Rule]", " ", 
                 RowBox[{"X", "[", 
                  RowBox[{
                   RowBox[{"vars2", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], ",", "vi"}], "]"}]}]}], 
               "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newvars", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"vars2", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "/.", 
               RowBox[{
                RowBox[{"vars2", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}], "\[Rule]", " ", 
                RowBox[{"X", "[", 
                 RowBox[{
                  RowBox[{"vars2", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], ",", "vi"}], "]"}]}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "jj"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newvars", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"newvars", ",", 
              RowBox[{"{", "vi", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"h0", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"h0", ",", 
              RowBox[{"{", "newvars", "}"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", "lv2"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"h", ",", 
           RowBox[{"{", 
            RowBox[{"X", "[", 
             RowBox[{"sexpr", ",", "vi"}], "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"h0", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"h0", ",", 
           RowBox[{"{", 
            RowBox[{"{", "vi", "}"}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "bpX", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"h", ",", "h0"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"h", ",", "h0"}], "}"}], "]"}]}]}], "\n", "]"}]}]}], "Input",
 CellChangeTimes->{{3.764499150470868*^9, 3.7644991538833857`*^9}, {
   3.7644993197283077`*^9, 3.764499323670207*^9}, {3.7644993758594923`*^9, 
   3.764499377366589*^9}, {3.764499414229055*^9, 3.764499428421153*^9}, {
   3.7644994727578373`*^9, 3.764499508823946*^9}, {3.7644995652894793`*^9, 
   3.764499625335886*^9}, {3.764499728779695*^9, 3.764499987201515*^9}, {
   3.764500043141925*^9, 3.764500075350494*^9}, 3.764500174386503*^9, {
   3.764500351520545*^9, 3.764500393913095*^9}, {3.764500748103016*^9, 
   3.7645007532173843`*^9}, {3.7645075310512323`*^9, 3.76450753874047*^9}, {
   3.764507990742907*^9, 3.764508019364694*^9}, {3.7645087076932487`*^9, 
   3.764508730859715*^9}, {3.764513549519711*^9, 3.764513575141625*^9}, {
   3.7645592707323103`*^9, 3.764559334442569*^9}, {3.7645601127951527`*^9, 
   3.7645601185417747`*^9}, {3.7645602717899523`*^9, 3.764560272121685*^9}, {
   3.764565720957376*^9, 3.764565725438602*^9}, {3.764580020549958*^9, 
   3.764580075073906*^9}, {3.764580213025371*^9, 3.7645802283533382`*^9}, {
   3.766559872118526*^9, 3.76655987517033*^9}, {3.7665599226312428`*^9, 
   3.7665599695869093`*^9}, {3.7665600113405523`*^9, 3.766560089815435*^9}, {
   3.766560229188816*^9, 3.766560332437546*^9}, 3.766560442833879*^9, {
   3.766560476186955*^9, 3.7665605242999153`*^9}, {3.76656056891439*^9, 
   3.766560575594112*^9}, {3.766560633996934*^9, 3.766560639366222*^9}, {
   3.76656070546583*^9, 3.766560826976877*^9}, {3.766560878666512*^9, 
   3.766560941168352*^9}, {3.766561002829212*^9, 3.766561026209649*^9}, {
   3.7665612246970778`*^9, 3.766561261064747*^9}, {3.7665613233444357`*^9, 
   3.766561334601386*^9}, {3.766561427222404*^9, 3.7665614741617823`*^9}, {
   3.766561530675784*^9, 3.766561586697707*^9}, {3.7665616649610863`*^9, 
   3.766561706800733*^9}, {3.7665618343090773`*^9, 3.76656194275701*^9}, {
   3.766561978090332*^9, 3.76656209113764*^9}, {3.7665622166692753`*^9, 
   3.7665622443711023`*^9}, {3.7665622808080873`*^9, 3.766562337174101*^9}, {
   3.766562434167588*^9, 3.7665624871281347`*^9}, 3.76656254847331*^9, 
   3.7665625962000523`*^9, 3.76656265654951*^9, {3.766562782446332*^9, 
   3.766562797225634*^9}, {3.766562859171282*^9, 3.7665629024744062`*^9}, {
   3.7665629434149027`*^9, 3.766563022070024*^9}, {3.766563052486566*^9, 
   3.766563057168496*^9}, {3.766563185412958*^9, 3.766563185963161*^9}, {
   3.766563343602785*^9, 3.766563353531294*^9}, {3.7665634348388853`*^9, 
   3.76656346038526*^9}, {3.766563495240716*^9, 3.7665635206881933`*^9}, {
   3.766563583697109*^9, 3.766563594209509*^9}, {3.766563643195271*^9, 
   3.766563741287828*^9}, {3.766564506208549*^9, 3.7665645192736483`*^9}, {
   3.766564574928499*^9, 3.766564600673278*^9}, {3.766564641564652*^9, 
   3.766564646362837*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"6d7a5698-6c9f-4875-8fc7-070180e74656"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BinaryProduct", "[", "f_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"BinaryProduct", "[", 
    RowBox[{"Length", "[", "f", "]"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"i_", "/;", 
     RowBox[{"IntegerQ", "[", "i", "]"}]}], "\[RuleDelayed]", " ", 
    RowBox[{"f", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}]}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"d3163509-c76f-4d04-bab0-28699a3c6fcf"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GBinaryProduct", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GBinaryProduct", "[", 
   RowBox[{"h_List", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "h", "]"}], ">", "2"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pts", ",", "res", ",", "r1", ",", "r2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"pts", "=", 
      RowBox[{
       RowBox[{"partition", "[", "h", "]"}], "//", 
       RowBox[{"Cases", "[", 
        RowBox[{"f_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "f", "]"}], "\[Equal]", "2"}]}], "]"}]}]}], 
     ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"pts", ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"r1", "=", 
          RowBox[{"(", 
           RowBox[{"GBinaryProduct", "[", 
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], ")"}]}], ";", 
         RowBox[{"r2", "=", 
          RowBox[{"(", 
           RowBox[{"GBinaryProduct", "[", 
            RowBox[{"pts", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "2"}], "]"}], "]"}], "]"}], ")"}]}], ";", 
         RowBox[{"res", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{
               RowBox[{"r1", "[", 
                RowBox[{"[", "ii1", "]"}], "]"}], ",", 
               RowBox[{"r2", "[", 
                RowBox[{"[", "ii2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii1", ",", 
               RowBox[{"Length", "@", "r1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii2", ",", 
               RowBox[{"Length", "@", "r2"}]}], "}"}]}], "]"}], "//", 
           "Flatten"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pts"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GBinaryProduct", "[", 
   RowBox[{"h_List", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "h", "]"}], "\[Equal]", "2"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"h", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GBinaryProduct", "[", 
   RowBox[{"h_List", "/;", 
    RowBox[{
     RowBox[{"Length", "[", "h", "]"}], "\[Equal]", "1"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"h", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"GBinaryProduct", "[", 
     RowBox[{"h_", "/;", 
      RowBox[{"NumericQ", "[", "h", "]"}]}], "]"}], ":=", "h"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.841301725227972*^9, 3.8413019667843523`*^9}, {
   3.8413030761271563`*^9, 3.841303090252904*^9}, 3.841303149747108*^9, {
   3.841303204946651*^9, 3.841303304186523*^9}, {3.8413033355898743`*^9, 
   3.84130355430499*^9}, {3.841303662678708*^9, 3.841303694509788*^9}, {
   3.841304004183845*^9, 3.841304031298671*^9}, {3.841304194454918*^9, 
   3.8413042525326777`*^9}, {3.84130435886654*^9, 3.8413044152692327`*^9}, {
   3.841304750285976*^9, 3.841304768838931*^9}, {3.841304815047062*^9, 
   3.8413049350330057`*^9}, {3.841305072297193*^9, 3.841305267594993*^9}, 
   3.841305302338414*^9, {3.84130537089082*^9, 3.8413053722814093`*^9}, {
   3.841305631662199*^9, 3.8413056475180893`*^9}, {3.841306327199444*^9, 
   3.841306338028923*^9}, 3.841306409586039*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"95432486-40d0-4c0f-a731-a71280cfa8b8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dianum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dianum", "[", "n_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"(", 
     RowBox[{"n", "-", "2", "+", "1"}], ")"}]], "*", 
   RowBox[{"Binomial", "[", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{"n", "-", "2"}], ")"}]}], ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.766563805462734*^9, 3.766563864708962*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"32678e5b-cacb-4914-871b-e514db6b9001"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandBracket", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{"{", 
     RowBox[{"spBracket", "\[Rule]", " ", "spp"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"spp", "\[Rule]", " ", "spBracket"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "NumQQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumQQ", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"f", "/.", 
      RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], ",", 
     RowBox[{"Q", "[", "___", "]"}]}], "]"}], "//", 
   "Length"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "NumP", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumP", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "f", "}"}], "/.", 
       RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], "//", "Flatten"}], 
     ",", 
     RowBox[{"k", "[", "___", "]"}]}], "]"}], "//", "Length"}]}]}], "Input",
 CellChangeTimes->{{3.766642548533147*^9, 3.766642548861114*^9}, {
   3.7692226933732433`*^9, 3.769222704412487*^9}, 3.7797791837162247`*^9, {
   3.8499438175750732`*^9, 3.849943819774433*^9}, {3.849943860439536*^9, 
   3.849943862731967*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"9fca1398-c03c-43e4-bd99-054cba98489d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "kPart", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kPart", "[", "f_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"CircleTimes", "@@", 
   RowBox[{"(", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], ",", 
      RowBox[{"k", "[", "___", "]"}]}], "]"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ePart", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ePart", "[", "f_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"CircleTimes", "@@", 
   RowBox[{"(", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], ",", 
      RowBox[{"\[Epsilon]", "[", "___", "]"}]}], "]"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.769222813600417*^9, 3.769222843221794*^9}, {
   3.76922287542558*^9, 3.769222980698477*^9}, 3.769223016208407*^9, {
   3.7692237849385357`*^9, 3.769223876423188*^9}, {3.769223992901539*^9, 
   3.769224056214415*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"4a6d63ba-b190-4097-bc1e-1de1dbdb9712"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[ScriptCapitalF]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"a_Plus", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"a_", ",", "b_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{
    RowBox[{"f_", " ", "a_J"}], ",", "b_J"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{
     RowBox[{"f", " ", "a"}], ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", " ", 
     RowBox[{"\[ScriptCapitalF]", "[", " ", 
      RowBox[{"a", ",", "b"}], "]"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", " ", 
   RowBox[{"a_J", ",", 
    RowBox[{"f_", " ", "b_J"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"a", ",", 
     RowBox[{"f", " ", "b"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", " ", 
     RowBox[{"\[ScriptCapitalF]", "[", " ", 
      RowBox[{"a", ",", "b"}], "]"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", " ", 
   RowBox[{
    RowBox[{"g_", " ", "a_J"}], ",", 
    RowBox[{"f_", " ", "b_J"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{
     RowBox[{"g", " ", "a"}], ",", 
     RowBox[{"f", " ", "b"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"g", " ", "f", " ", 
     RowBox[{"\[ScriptCapitalF]", "[", " ", 
      RowBox[{"a", ",", "b"}], "]"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"0", ",", "0"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"0", ",", "f_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"f_", ",", "0"}], "]"}], ":=", "0"}]}], "Input",
 CellChangeTimes->{{3.8100136081445427`*^9, 3.810013610726534*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"bd2f10cc-2728-43f9-9e29-3ecccadfecad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"(*", 
    RowBox[{"F", ","}], "*)"}], 
   RowBox[{"F0", ",", "FL", ",", "FR"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"\[ScriptCapitalF]", "[", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{"p", "[", "j", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"V1_J", ",", "V2_J"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"V1", ",", "V2"}], "]"}], "=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", " ", "0"}]}], ",", 
     RowBox[{"F0", "[", 
      RowBox[{"V1", ",", "V2"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "0"}]}], ",", 
     RowBox[{"FL", "[", 
      RowBox[{"V1", ",", "V2"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "0"}], "&&", " ", 
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "1"}]}], ",", 
     RowBox[{"FR", "[", 
      RowBox[{"V1", ",", "V2"}], "]"}], ",", "\[IndentingNewLine]", "True", 
     ",", 
     RowBox[{"0", 
      RowBox[{"Khigher", "[", 
       RowBox[{"V1", ",", "V2"}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F0", "[", 
   RowBox[{"A_J", ",", "B_J"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Qp", "=", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"Pa", "=", 
       RowBox[{"k", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"Pb", "=", 
       RowBox[{"k", "[", 
        RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ",", 
      RowBox[{"b", "=", 
       RowBox[{
       "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DOT", "[", 
           RowBox[{"b", ",", "Pa"}], "]"}], " ", 
          RowBox[{"J", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", "a"}], "]"}]}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DOT", "[", 
           RowBox[{"a", ",", "Pb"}], "]"}], " ", 
          RowBox[{"J", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", "b"}], "]"}]}], ")"}], "-", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"DOT", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "Pa"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"DOT", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "Pb"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"a", "\[CircleTimes]", "b", "\[CircleTimes]", "Qp"}]}], 
          "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"b", "\[CircleTimes]", "a", "\[CircleTimes]", "Qp"}]}], 
          "]"}]}]}], ")"}], "/.", 
      RowBox[{"DOT", "\[Rule]", " ", "dot"}]}], "//", "Expand"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FL", "[", 
   RowBox[{"A_J", ",", "B_J"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Qp", "=", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"Pa", "=", 
       RowBox[{"k", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"Pb", "=", 
       RowBox[{"k", "[", 
        RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ",", 
      RowBox[{"b", "=", 
       RowBox[{
       "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pa", ",", "Pa"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "b"}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pa", ",", "Pa"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "b"}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ")"}], "/.", 
      RowBox[{"DOT", "\[Rule]", " ", "dot"}]}], "//", "Expand"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FR", "[", 
   RowBox[{"A_J", ",", "B_J"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Qp", "=", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"Pa", "=", 
       RowBox[{"k", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"Pb", "=", 
       RowBox[{"k", "[", 
        RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ",", 
      RowBox[{"b", "=", 
       RowBox[{
       "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pb", ",", "Pb"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{"a", ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["1", "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pb", ",", "Pb"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{"a", ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ")"}], "/.", 
      RowBox[{"DOT", "\[Rule]", " ", "dot"}]}], "//", "Expand"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.810013480381181*^9, {3.849943871802273*^9, 3.849943878768716*^9}, {
   3.851490712233686*^9, 3.85149071634311*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"5c228a1e-30a8-4551-ac44-013adb9fee58"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "ExpandNCM", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
    RowBox[{"a___", ",", "b_Plus", ",", "c___"}], "]"}], "]"}], ":=", 
  RowBox[{"Distribute", "[", 
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "Plus", ",", "h", ",", 
    "Plus", ",", 
    RowBox[{
     RowBox[{"ExpandNCM", "[", 
      RowBox[{"h", "[", "##", "]"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
    RowBox[{"a___", ",", "b_Times", ",", "c___"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Most", "[", "b", "]"}], 
   RowBox[{"ExpandNCM", "[", 
    RowBox[{"h", "[", 
     RowBox[{"a", ",", 
      RowBox[{"Last", "[", "b", "]"}], ",", "c"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "a_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExpandNCM", "[", "#", "]"}], "&"}], "/@", 
   "a"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "c_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "*", 
   RowBox[{"ExpandNCM", "[", 
    RowBox[{"c", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "a_", "]"}], ":=", 
  RowBox[{"ExpandAll", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "NC", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NC", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"NonCommutativeMultiply", "[", 
    RowBox[{"i", ",", "j"}], "]"}], "-", 
   RowBox[{"NonCommutativeMultiply", "[", 
    RowBox[{"j", ",", "i"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.810012974540019*^9, 3.810012994071413*^9}, {
  3.810013034801511*^9, 3.81001303869503*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"b08007f5-74da-4184-8bcc-70e944a2201b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PG", "]"}], 
  RowBox[{"(*", 
   RowBox[{"defined", " ", "the", " ", "propagator", " ", "function"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_p", ",", "f2_p"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_p", ",", "f2_P"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_P", ",", "f2_p"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_P", ",", "f2_P"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}], ",", "f2_p"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_p", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}], ",", "f2_p"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_p", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}], ",", "f2_P"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_P", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}], ",", "f2_P"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_P", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s2_", ",", "f2_P"}], "]"}], ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", "s2", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}]}], "Input",
 CellLabel->
  "In[102]:=",ExpressionUUID->"835d0c66-9e89-4ea6-beb8-e47124c22ee9"]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctionsClosedForm", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 3.810011824102497*^9}, 
   3.843431128166585*^9},ExpressionUUID->"51c8b79b-932a-4bdd-86b8-\
9f06849e255f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"KLTR", ",", "KLTRM"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KLTR", "[", "f_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"KLTR", "[", "f", "]"}], "=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], ">", "2"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"imax", "=", 
          RowBox[{"Max", "[", "f", "]"}]}], ",", "idmax", ",", "fr", ",", 
         "fl"}], "}"}], ",", 
       RowBox[{
        RowBox[{"idmax", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"f", ",", "imax"}], "]"}], "//", "Flatten"}]}], ";", 
        RowBox[{"fr", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"f", ",", "idmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fl", "=", 
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"idmax", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ")"}]}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"2", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "imax", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "/@", "fl"}], ")"}], "//", "Total"}]}], "]"}], 
         RowBox[{"KLTR", "[", "fr", "]"}]}]}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], "\[Equal]", "2"}], ",", 
     RowBox[{"2", 
      RowBox[{"dot", "@@", 
       RowBox[{"(", 
        RowBox[{"p", "/@", "f"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], "<", "2"}], ",", 
     RowBox[{
     "Print", "[", "\"\<Length of f should be large than 2\>\"", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KLTRM", "[", "n_", "]"}], ":=", 
  RowBox[{"KLTR", "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{"#", ",", 
        RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
     RowBox[{"ddmBasis", "[", 
      RowBox[{"Range", "[", "n", "]"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.839994425791482*^9, 3.83999443747307*^9}, {
  3.839994485137151*^9, 3.839994514837348*^9}, {3.839994592103528*^9, 
  3.8399945934682093`*^9}, {3.839994660012353*^9, 3.8399947892205067`*^9}, {
  3.8399948213233433`*^9, 3.839994858056067*^9}, {3.83999500626001*^9, 
  3.839995236474574*^9}, {3.839995334589308*^9, 3.839995449737526*^9}, {
  3.839995499077149*^9, 3.8399955037773733`*^9}, {3.8399955341042213`*^9, 
  3.839995606584497*^9}, {3.839995833962657*^9, 3.839995884233406*^9}, {
  3.8399959914105997`*^9, 3.8399960379865093`*^9}, {3.8399964204765368`*^9, 
  3.839996422705614*^9}, {3.8426128199710913`*^9, 3.8426128352353563`*^9}, {
  3.8499355175006638`*^9, 3.8499355207004642`*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"ea70f9c9-d4d2-46fe-9ada-2ec969aca9f4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"niceT", ",", "niceET"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"niceT", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["T", "f"], "/.", "\[VeryThinSpace]", 
       RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
     RowBox[{"\"\<(\>\"", "<>", 
      RowBox[{"ToString", "/@", 
       RowBox[{"{", "f1", "}"}]}], "<>", "\"\<)\>\""}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"niceET", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i_", "]"}], ":>", 
     SuperscriptBox["t", 
      SubscriptBox["a", "i"]]}], ",", 
    RowBox[{
     RowBox[{"GT", "[", 
      RowBox[{
       RowBox[{"{", "f1___", "}"}], ",", 
       RowBox[{"{", "f2___", "}"}]}], "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["T", "f2"], 
        RowBox[{"\"\<(\>\"", "<>", 
         RowBox[{"ToString", "/@", 
          RowBox[{"{", "f1", "}"}]}], "<>", "\"\<)\>\""}]], "/.", 
       "\[VeryThinSpace]", 
       RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
     RowBox[{"\"\<(\>\"", "<>", 
      RowBox[{"ToString", "/@", 
       RowBox[{"{", "f1", "}"}]}], "<>", "\"\<)\>\""}]}], ",", 
    RowBox[{
     RowBox[{"ET", "[", 
      RowBox[{"f1_GT", ",", 
       RowBox[{"{", "f2__", "}"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{"f1", " ", 
      RowBox[{"tr", "[", 
       RowBox[{"CenterDot", "[", "f2", "]"}], "]"}]}]}]}], "}"}]}]}], "Input",\

 CellChangeTimes->{{3.839469631115183*^9, 3.839469674309537*^9}, {
   3.83956757300841*^9, 3.8395676630792627`*^9}, {3.843126203886073*^9, 
   3.843126224264575*^9}, {3.8499356053075113`*^9, 3.849935627081663*^9}, {
   3.856345045663068*^9, 3.856345048979126*^9}, 3.8563451629641123`*^9, {
   3.867049509541975*^9, 3.8670495351066103`*^9}, {3.8670495682947493`*^9, 
   3.8670495691789017`*^9}, {3.867049664187765*^9, 3.867049709467833*^9}, {
   3.867049751993469*^9, 3.867049752348894*^9}, {3.867049795436908*^9, 
   3.8670498276623898`*^9}, {3.8670504783485203`*^9, 
   3.8670504880616617`*^9}, {3.867050521367712*^9, 3.867050564213861*^9}, {
   3.867050739491564*^9, 3.867050750776265*^9}, 3.867050791473817*^9, {
   3.867050918501417*^9, 3.8670509818995457`*^9}, {3.8670510505459414`*^9, 
   3.86705107091497*^9}, {3.867051113274519*^9, 3.867051160579288*^9}, {
   3.867051196903377*^9, 3.8670512042467947`*^9}, {3.867051277745961*^9, 
   3.867051278233429*^9}, {3.8670513693112087`*^9, 3.867051377269781*^9}, {
   3.867051488371662*^9, 3.867051505313662*^9}, {3.867051579618641*^9, 
   3.867051609457695*^9}, {3.867051776206088*^9, 3.867051780070037*^9}, {
   3.867052229561306*^9, 3.867052251248715*^9}, {3.867052488680396*^9, 
   3.8670525105530787`*^9}, {3.867110221252329*^9, 3.86711022962354*^9}, {
   3.867110289423637*^9, 3.867110293704104*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"84d91cb8-e100-4f54-82fe-9f221285ab55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["T", "f"], "/.", "\[VeryThinSpace]", 
      RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
    RowBox[{"\<\"(\"\>", "<>", 
     RowBox[{"ToString", "/@", 
      RowBox[{"{", "f1", "}"}]}], "<>", "\<\")\"\>"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.839548619664312*^9, 3.8395675743138103`*^9, 3.839567663984125*^9, 
   3.840320641685912*^9, 3.840855735495926*^9, 3.840924431396873*^9, 
   3.841104931024561*^9, 3.842519185268689*^9, 3.842612865371006*^9, 
   3.84312622512184*^9, 3.843431364833078*^9, 3.8465642942147417`*^9, 
   3.847499020831465*^9, 3.849068096519346*^9, {3.84993453882728*^9, 
   3.849934564595379*^9}, 3.851044648504219*^9, 3.851045622652813*^9, 
   3.851339087658826*^9, 3.8514905452282047`*^9, 3.851490784841222*^9, 
   3.851748984274619*^9, 3.8518316283629513`*^9, 3.851849408030963*^9, 
   3.8518569773477907`*^9, 3.851992647512147*^9, 3.852079752067829*^9, 
   3.852205233188251*^9, 3.853201945924086*^9, 3.8533718881849527`*^9, 
   3.853476916960648*^9, 3.854165632530545*^9, 3.854428229326764*^9, 
   3.854428455513752*^9, 3.8545848107355747`*^9, 3.8547768413310957`*^9, 
   3.855028265165945*^9, 3.855293118170321*^9, 3.8556415851892767`*^9, 
   3.855665357942355*^9, 3.855723457246786*^9, 3.856316738227253*^9, 
   3.8563193342551117`*^9, 3.856345057670064*^9, 3.8563451227869596`*^9, 
   3.856345163933029*^9, 3.856397730446745*^9, 3.863825060869616*^9, 
   3.8639070512476263`*^9, 3.864101636503916*^9, 3.864362867277647*^9, 
   3.86436614713616*^9, 3.864474097706633*^9, 3.86487510173453*^9, 
   3.866677314608758*^9, 3.8670337709662724`*^9, 3.867034861844171*^9, {
   3.867035598553287*^9, 3.8670356251321087`*^9}, 3.867050504881651*^9, {
   3.8670505497241163`*^9, 3.867050566629754*^9}, 3.8670506646628113`*^9, 
   3.867050751543448*^9, 3.8670507938304043`*^9, {3.8670511489427223`*^9, 
   3.867051161164236*^9}, 3.8670512052320013`*^9, 3.867051282880905*^9, 
   3.867051378220948*^9, {3.8670514897988234`*^9, 3.867051506082806*^9}, {
   3.8670516103097963`*^9, 3.867051623397407*^9}, 3.867052252394486*^9, 
   3.867052514447427*^9, 3.867110234340056*^9, 3.867110331471683*^9, 
   3.868169388005954*^9, 3.868169430498211*^9, 3.868607314800735*^9, 
   3.86900891788029*^9, 3.869009436634576*^9, 3.8690118964335957`*^9},
 CellLabel->
  "Out[291]=",ExpressionUUID->"954d84af-dd5c-4f80-9456-d1daf2655503"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "i_", "]"}], "\[RuleDelayed]", 
    SuperscriptBox["t", 
     SubscriptBox["a", "i"]]}], ",", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", "f1___", "}"}], ",", 
      RowBox[{"{", "f2___", "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["T", "f2", 
       RowBox[{"\<\"(\"\>", "<>", 
        RowBox[{"ToString", "/@", 
         RowBox[{"{", "f1", "}"}]}], "<>", "\<\")\"\>"}]], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
    RowBox[{"\<\"(\"\>", "<>", 
     RowBox[{"ToString", "/@", 
      RowBox[{"{", "f1", "}"}]}], "<>", "\<\")\"\>"}]}], ",", 
   RowBox[{
    RowBox[{"ET", "[", 
     RowBox[{"f1_GT", ",", 
      RowBox[{"{", "f2__", "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"f1", " ", 
     RowBox[{"tr", "[", 
      RowBox[{"CenterDot", "[", "f2", "]"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.839548619664312*^9, 3.8395675743138103`*^9, 3.839567663984125*^9, 
   3.840320641685912*^9, 3.840855735495926*^9, 3.840924431396873*^9, 
   3.841104931024561*^9, 3.842519185268689*^9, 3.842612865371006*^9, 
   3.84312622512184*^9, 3.843431364833078*^9, 3.8465642942147417`*^9, 
   3.847499020831465*^9, 3.849068096519346*^9, {3.84993453882728*^9, 
   3.849934564595379*^9}, 3.851044648504219*^9, 3.851045622652813*^9, 
   3.851339087658826*^9, 3.8514905452282047`*^9, 3.851490784841222*^9, 
   3.851748984274619*^9, 3.8518316283629513`*^9, 3.851849408030963*^9, 
   3.8518569773477907`*^9, 3.851992647512147*^9, 3.852079752067829*^9, 
   3.852205233188251*^9, 3.853201945924086*^9, 3.8533718881849527`*^9, 
   3.853476916960648*^9, 3.854165632530545*^9, 3.854428229326764*^9, 
   3.854428455513752*^9, 3.8545848107355747`*^9, 3.8547768413310957`*^9, 
   3.855028265165945*^9, 3.855293118170321*^9, 3.8556415851892767`*^9, 
   3.855665357942355*^9, 3.855723457246786*^9, 3.856316738227253*^9, 
   3.8563193342551117`*^9, 3.856345057670064*^9, 3.8563451227869596`*^9, 
   3.856345163933029*^9, 3.856397730446745*^9, 3.863825060869616*^9, 
   3.8639070512476263`*^9, 3.864101636503916*^9, 3.864362867277647*^9, 
   3.86436614713616*^9, 3.864474097706633*^9, 3.86487510173453*^9, 
   3.866677314608758*^9, 3.8670337709662724`*^9, 3.867034861844171*^9, {
   3.867035598553287*^9, 3.8670356251321087`*^9}, 3.867050504881651*^9, {
   3.8670505497241163`*^9, 3.867050566629754*^9}, 3.8670506646628113`*^9, 
   3.867050751543448*^9, 3.8670507938304043`*^9, {3.8670511489427223`*^9, 
   3.867051161164236*^9}, 3.8670512052320013`*^9, 3.867051282880905*^9, 
   3.867051378220948*^9, {3.8670514897988234`*^9, 3.867051506082806*^9}, {
   3.8670516103097963`*^9, 3.867051623397407*^9}, 3.867052252394486*^9, 
   3.867052514447427*^9, 3.867110234340056*^9, 3.867110331471683*^9, 
   3.868169388005954*^9, 3.868169430498211*^9, 3.868607314800735*^9, 
   3.86900891788029*^9, 3.869009436634576*^9, 3.869011896435061*^9},
 CellLabel->
  "Out[292]=",ExpressionUUID->"6d297b92-4201-4999-b14b-143f0260daba"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Tt", ",", "Tp"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tt", "[", "od_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"phat", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "od"}], "]"}]}], ",", "leftv", ",", "num", ",",
       "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
          "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"Length", "@", "od"}]], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v", ",", 
           RowBox[{"p", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tp", "[", 
   RowBox[{"{", "i_", "}"}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", "v"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tp", "[", "f__", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"od", "=", 
        RowBox[{"{", "f", "}"}]}], ",", "phat", ",", "leftv", ",", "num", ",",
        "den"}], "}"}], ",", 
     RowBox[{
      RowBox[{"phat", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"od", "===", 
          RowBox[{"T", "[", 
           RowBox[{"{", "i_", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phat", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"od", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
           RowBox[{"Max", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], "]"}]}], ","}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"phat", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"p", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", "<", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
           "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{",", 
           RowBox[{
            RowBox[{"phat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"p", "@@", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"od", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
              "]"}]}]}]}], "]"}], "*)"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"leftv", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"F", "/@", 
              RowBox[{"od", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"gg_", ",", 
              RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
            "\[RuleDelayed]", " ", 
            RowBox[{"dot", "[", 
             RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"den", "=", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"v", ",", 
            RowBox[{"p", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"GT2F", ",", "GTRM0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GT2F", "[", 
   RowBox[{
    RowBox[{"{", "g__", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", "i_", "}"}], "}"}]}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", "v"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GT2F", "[", 
   RowBox[{"f1_List", ",", "f2_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cod", "=", "f1"}], ",", 
      RowBox[{"od", "=", "f2"}], ",", "phat", ",", "leftv", ",", "num", ",", 
      "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", 
                RowBox[{"od", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"MinimalBy", "[", 
            RowBox[{
             RowBox[{"od", "//", "Flatten"}], ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#1"}], "]"}], "&"}]}], "]"}], "//", 
           "First"}], "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v", ",", 
           RowBox[{"p", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GTRM0", "[", 
    RowBox[{"f1_List", ",", "f2_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cod", "=", "f1"}], ",", 
       RowBox[{"od", "=", "f2"}], ",", "phat"}], "}"}], ",", 
     RowBox[{
      RowBox[{"phat", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "od"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"phat", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"od", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
           RowBox[{"Max", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], "]"}]}], ","}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"phat", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"p", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"cod", ",", "#"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"cod", ",", 
                 RowBox[{"od", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}],
                "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{",", 
           RowBox[{
            RowBox[{"phat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"p", "@@", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"od", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
              "]"}]}]}]}], "]"}], "*)"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "phat", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"phat", ",", 
          RowBox[{"p", "[", "]"}]}], "]"}], ",", "0", ",", 
        RowBox[{"GT", "[", 
         RowBox[{"f1", ",", "f2"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "TScalar", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TScalar", "[", 
   RowBox[{"{", "i_", "}"}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", 
    RowBox[{"p", "[", "0", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TScalar", "[", "f__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", 
       RowBox[{"{", "f", "}"}]}], ",", "phat", ",", "leftv", ",", "rightv", 
      ",", "num", ",", "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"od", "===", 
         RowBox[{"T", "[", 
          RowBox[{"{", "i_", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"p", "[", "0", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
          "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rightv", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rightv", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"p", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"rightv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"p", "[", "0", "]"}], "+", 
         RowBox[{"p", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "&"}]}], 
           "]"}]}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"rightv", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "0", "]"}], "+", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "+", 
            RowBox[{"p", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
              "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ET2F", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ET2F", "[", "f_ET", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"flavor", "=", 
       RowBox[{"f", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"od", "=", 
       RowBox[{"f", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"cod", "=", 
       RowBox[{"f", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "phat", ",", "leftv", 
      ",", "rightv", ",", "num", ",", "den", ",", "scalars"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"scalars", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "cod", "]"}], ",", 
        RowBox[{"Flatten", "[", "od", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"od", "===", 
         RowBox[{"T", "[", 
          RowBox[{"{", "i_", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"scalars", ",", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", 
                RowBox[{"od", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rightv", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"rightv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"scalars", ",", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", 
                RowBox[{"od", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"rightv", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"dot", "[", 
        RowBox[{"p", "@@", "scalars"}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "@@", "scalars"}], ")"}], "+", 
            RowBox[{"p", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
              "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"flavor", "=", 
      RowBox[{"CenterDot", "@@", 
       RowBox[{"(", 
        RowBox[{"flavor", "/.", 
         RowBox[{
          RowBox[{"a", "[", "i_", "]"}], ":>", 
          SuperscriptBox["t", 
           RowBox[{"a", "[", "i", "]"}]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"flavor", " ", 
      RowBox[{"num", "/", "den"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ET2F2s", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ET2F2s", "[", "f_ET", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"flavor", "=", 
       RowBox[{"f", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"od", "=", 
       RowBox[{"f", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"cod", "=", 
       RowBox[{"f", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", "phat", ",", "leftv", 
      ",", "rightv", ",", "num", ",", "den", ",", "refs", ",", "sc", ",", 
      "refg"}], "}"}], ",", 
    RowBox[{
     RowBox[{"leftv", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"refs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "cod", "]"}], ",", 
          RowBox[{"Flatten", "[", "od", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Min", "[", 
          RowBox[{"Flatten", "[", "od", "]"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sc", "=", 
      RowBox[{"First", "@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "cod", "]"}], ",", 
         RowBox[{"Flatten", "[", "od", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"refg", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Flatten", "[", "od", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"cod", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "sc"}], "&&", 
           RowBox[{
            RowBox[{"cod", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "==", "refg"}]}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"cod", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "refg"}], "&&", 
           RowBox[{
            RowBox[{"cod", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "==", "sc"}]}], ")"}]}], 
        "]"}], ",", 
       RowBox[{
        RowBox[{"num", "=", "0"}], ";", 
        RowBox[{"Return", "[", "num", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"od", "===", 
         RowBox[{"T", "[", 
          RowBox[{"{", "i_", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"leftv", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"p", "@@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "cod", "]"}], ",", 
         RowBox[{"Flatten", "[", "od", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"leftv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"refs", ",", 
               RowBox[{"od", "\[LeftDoubleBracket]", 
                RowBox[{"1", ";;", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], 
                "\[RightDoubleBracket]"}]}], "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", 
                RowBox[{"od", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rightv", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rightv", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"p", "@@", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "cod", "]"}], ",", 
         RowBox[{"Flatten", "[", "od", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"rightv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"refs", ",", 
               RowBox[{"od", "\[LeftDoubleBracket]", 
                RowBox[{"1", ";;", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], 
                "\[RightDoubleBracket]"}]}], "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", 
                RowBox[{"od", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", 
                  RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"rightv", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"p", "@@", "refs"}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"dot", "[", 
           RowBox[{"(", 
            RowBox[{"p", "@@", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"refs", ",", 
                 RowBox[{"od", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ";;", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], 
                  "\[RightDoubleBracket]"}]}], "]"}], "]"}], "]"}]}], ")"}], 
           "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"flavor", "=", 
      RowBox[{"CenterDot", "@@", 
       RowBox[{"(", 
        RowBox[{"flavor", "/.", 
         RowBox[{
          RowBox[{"a", "[", "i_", "]"}], ":>", 
          SuperscriptBox["t", 
           RowBox[{"a", "[", "i", "]"}]]}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"flavor", " ", 
      RowBox[{"num", "/", "den"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8405234179021606`*^9, 3.840523506308812*^9}, {
   3.8405235505376873`*^9, 3.840523613832405*^9}, {3.840523646764225*^9, 
   3.8405236553442373`*^9}, {3.8405237210304337`*^9, 
   3.8405237504615793`*^9}, {3.840523880523397*^9, 3.840523894971196*^9}, {
   3.840523944679134*^9, 3.8405239530387278`*^9}, {3.8405239990585546`*^9, 
   3.8405242280541162`*^9}, {3.840524276328244*^9, 3.840524453398039*^9}, {
   3.840524534078959*^9, 3.840524534181641*^9}, {3.8405248086333714`*^9, 
   3.840524822206621*^9}, {3.840524852931211*^9, 3.840524944961101*^9}, {
   3.840524975141419*^9, 3.8405249880828657`*^9}, {3.840525291960122*^9, 
   3.840525305514349*^9}, {3.840525345879817*^9, 3.840525415511939*^9}, {
   3.8405254504294662`*^9, 3.840525457239025*^9}, {3.84052593662122*^9, 
   3.840526055964221*^9}, {3.8405261292360353`*^9, 3.8405261338174257`*^9}, {
   3.840526224737644*^9, 3.840526235041646*^9}, {3.84054440563081*^9, 
   3.840544412471218*^9}, {3.8405444831405993`*^9, 3.840544511426354*^9}, {
   3.849934332742257*^9, 3.849934333013976*^9}, {3.849934515782876*^9, 
   3.849934516592381*^9}, {3.849934974864478*^9, 3.8499349752130547`*^9}, {
   3.849935262774529*^9, 3.8499352642747173`*^9}, {3.8499353420511227`*^9, 
   3.849935396054686*^9}, {3.8639110427347403`*^9, 3.863911057244348*^9}, {
   3.863911110032012*^9, 3.863911149493325*^9}, {3.86391118455193*^9, 
   3.863911239330574*^9}, {3.864001158448061*^9, 3.864001165758815*^9}, {
   3.8640842139065247`*^9, 3.864084215755389*^9}, {3.864084322215169*^9, 
   3.8640843241310873`*^9}, {3.864098616380303*^9, 3.864098728667776*^9}, {
   3.864098776856051*^9, 3.864098805917819*^9}, {3.8640989228578*^9, 
   3.864098976527803*^9}, {3.864119426739456*^9, 3.864119436103304*^9}, {
   3.864119473203198*^9, 3.864119474880515*^9}, {3.864521792252655*^9, 
   3.86452179620968*^9}, {3.869009323403461*^9, 3.869009331184875*^9}, 
   3.869009400148423*^9, {3.869011882369322*^9, 3.86901188359905*^9}, {
   3.8690124263948727`*^9, 3.8690124285734377`*^9}, {3.8690133451956387`*^9, 
   3.869013356151452*^9}, {3.86901359458435*^9, 3.869013623424124*^9}, {
   3.8690136547276993`*^9, 3.869013667386591*^9}, {3.8690138202728977`*^9, 
   3.869013832404271*^9}, {3.869013917922024*^9, 3.869014054428937*^9}, {
   3.86901409610192*^9, 3.8690141012040663`*^9}, {3.8690142410839043`*^9, 
   3.869014247763886*^9}, {3.869014285103395*^9, 3.869014287937155*^9}, {
   3.869014551736034*^9, 3.869014565730093*^9}, {3.8690148231492653`*^9, 
   3.869014824911422*^9}, {3.8690149441905003`*^9, 3.869014975977803*^9}, {
   3.8690157632671833`*^9, 3.869015819942349*^9}, {3.869015881389398*^9, 
   3.869016064105259*^9}, {3.86901611995938*^9, 3.869016122687435*^9}, 
   3.869016230500791*^9, {3.869017083412108*^9, 3.869017100767144*^9}},
 CellLabel->
  "In[584]:=",ExpressionUUID->"0472f27d-9a7f-4178-9309-50f70c8fbd78"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ET", "[", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", "[", "3", "]"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[539]:=",ExpressionUUID->"81cec74f-2e5a-4d2e-8439-c844ec580913"],

Cell[BoxData[
 RowBox[{"ET", "[", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", "[", "3", "]"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.869016171948285*^9},
 CellLabel->
  "Out[539]=",ExpressionUUID->"e8da5631-a63d-4479-a618-f61dd346fae3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"First", "@", 
  RowBox[{"Complement", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}], "]"}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "}"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8690162061360493`*^9, 3.869016220660206*^9}},
 CellLabel->
  "In[542]:=",ExpressionUUID->"c0c7068b-019d-4230-af4c-f445c496911e"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.869016210959098*^9, 3.869016221211767*^9}},
 CellLabel->
  "Out[542]=",ExpressionUUID->"4c6a429f-9379-4909-b15e-a8df018d1f32"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ET", "[", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", "[", "3", "]"}], "}"}]}], "]"}], "//", "ET2F2s"}]], "Input",\

 CellChangeTimes->{{3.8690148455565453`*^9, 3.869014849268729*^9}, {
  3.869016147549925*^9, 3.869016163756967*^9}, {3.869016246521678*^9, 
  3.869016249379299*^9}},
 CellLabel->
  "In[559]:=",ExpressionUUID->"98736bd3-c1b0-41e3-9144-15c18807b56a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.869016149113937*^9, 3.869016164262866*^9}, {
  3.869016234792961*^9, 3.86901624980577*^9}},
 CellLabel->
  "Out[559]=",ExpressionUUID->"558a32a4-96a9-475a-aa19-ef1a1c0f6dcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "@", 
  RowBox[{"Min", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.869014218693849*^9, 3.8690142360456257`*^9}},
 CellLabel->
  "In[422]:=",ExpressionUUID->"6ec743f6-7eb7-4a60-b7ca-d5ef814e8b22"],

Cell[BoxData[
 RowBox[{"p", "[", "1", "]"}]], "Output",
 CellChangeTimes->{{3.869014225936472*^9, 3.8690142365005503`*^9}},
 CellLabel->
  "Out[422]=",ExpressionUUID->"a2f1abfc-5895-41da-91fb-f65a4bbd6846"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mypartition", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8644275847866993`*^9, 3.8644276706382103`*^9}, {
  3.864427706214572*^9, 3.864427709715233*^9}, {3.864427755559827*^9, 
  3.864427764765161*^9}},
 CellLabel->
  "In[306]:=",ExpressionUUID->"b2ceee9f-0a48-4209-8663-4d3f868954b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "4", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.864427594609951*^9, 3.864427671253285*^9}, 
   3.8644277103431797`*^9, {3.8644277560269423`*^9, 3.8644277654592857`*^9}, 
   3.864474097735807*^9, 3.8648751017661877`*^9, 3.8666773146391907`*^9, 
   3.8670337710031757`*^9, 3.867034861872611*^9, {3.8670355986194887`*^9, 
   3.867035625166457*^9}, 3.86816938803834*^9, 3.868169430532337*^9, 
   3.868607314841063*^9, 3.8690089179238167`*^9, 3.86900943666584*^9, 
   3.86901189646777*^9},
 CellLabel->
  "Out[306]=",ExpressionUUID->"7123092e-3356-4ff4-b3bc-f64f52896029"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "partition", ",", "mypartition", ",", "partitionOrdered", ",", 
   "partitionPreNum"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partition", "[", 
   RowBox[{"{", "x_", "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"{", "x", "}"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partition", "[", 
   RowBox[{"{", 
    RowBox[{"r__", ",", "x_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"{", 
     RowBox[{"r", ",", "x"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplaceList", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b___", ",", 
              RowBox[{"{", "S__", "}"}], ",", "a___"}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"{", 
               RowBox[{"S", ",", "x"}], "}"}], ",", "a"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"{", "S__", "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"S", ",", 
              RowBox[{"{", "x", "}"}]}], "}"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"partition", "[", 
       RowBox[{"{", "r", "}"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mypartition", "[", 
   RowBox[{"ls_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allpt", ",", "tb1", ",", "tb2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "ls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allpt", "=", 
      RowBox[{
       RowBox[{"Permutations", "/@", "allpt"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     RowBox[{"tb1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "j", "}"}], ",", 
             RowBox[{"allpt", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
          RowBox[{"allpt", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"Length", "@", 
               RowBox[{"allpt", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "allpt"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tb2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "j", "}"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       "allpt"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"tb1", ",", "tb2"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mypartition", "[", "ls_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allpt", ",", "tb1", ",", "tb2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "ls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allpt", "=", 
      RowBox[{
       RowBox[{"Permutations", "/@", "allpt"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     RowBox[{"tb1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"allpt", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
          RowBox[{"allpt", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"Length", "@", 
               RowBox[{"allpt", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "allpt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tb2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       "allpt"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Join", "[", 
     RowBox[{"tb1", ",", "tb2"}], "]"}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionPreNum", "[", "ls_", "]"}], ":=", 
  RowBox[{"mypartition", "[", 
   RowBox[{
    RowBox[{"ls", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
    RowBox[{"ls", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionOrdered", "[", "ls_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "allpt", "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "ls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"allpt", "=", 
        RowBox[{
         RowBox[{"Permutations", "/@", "allpt"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"allpt", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
         RowBox[{"allpt", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", 
            RowBox[{"2", ";;", 
             RowBox[{"Length", "@", 
              RowBox[{"allpt", "[", 
               RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "allpt"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8405265652626762`*^9, 3.8405265774733143`*^9}, {
   3.8405268718548527`*^9, 3.840526958498376*^9}, {3.840527014516148*^9, 
   3.840527016426841*^9}, {3.840527219853006*^9, 3.840527300133636*^9}, {
   3.8405277915613937`*^9, 3.840527814878928*^9}, {3.8406856290885677`*^9, 
   3.840685657517951*^9}, {3.841202745678379*^9, 3.841202754536993*^9}, 
   3.842568892163535*^9, {3.8425701408526707`*^9, 3.842570165806718*^9}, 
   3.8425702175552797`*^9, {3.842570260739533*^9, 3.842570331776321*^9}, {
   3.8425704504307756`*^9, 3.842570450475792*^9}, {3.8425713464861794`*^9, 
   3.8425713562442913`*^9}, {3.84257144332904*^9, 3.842571479494907*^9}, {
   3.842571565368428*^9, 3.842571583125154*^9}, {3.8426130292062674`*^9, 
   3.8426130638316193`*^9}},
 CellLabel->
  "In[307]:=",ExpressionUUID->"98f6ff7c-f071-411c-95fb-9bc9ab005816"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"partitionOd", ",", "MyPartitionOd"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionOd", "[", "fl_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "allpt", "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "fl", "]"}]}], ";", 
     RowBox[{"Cases", "[", 
      RowBox[{"allpt", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"Flatten", "[", "x", "]"}], "]"}]}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyPartitionOd", "[", "f_", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"partitionOd", "[", 
      RowBox[{"Sort", "[", "f", "]"}], "]"}], "/.", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Rule", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sort", "[", "f", "]"}], ",", "f"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"x_", "/;", 
     RowBox[{"And", "@@", 
      RowBox[{"OrderedQ", "/@", "x"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.840686399528157*^9, 3.840686408446405*^9}, {
  3.840686496207872*^9, 3.8406865221059637`*^9}, {3.840686572057829*^9, 
  3.840686614220367*^9}, {3.840686942657793*^9, 3.8406869641759377`*^9}, {
  3.8406870311296253`*^9, 3.840687035423389*^9}, {3.8406871674539623`*^9, 
  3.840687168557219*^9}, {3.8424415718901873`*^9, 3.8424415778117037`*^9}, {
  3.842488230992901*^9, 3.842488298268762*^9}, {3.842572415706497*^9, 
  3.842572421861507*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"76ebb2e1-fb6b-4889-9d7e-34f9228369b5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "inLeft", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inLeft", "[", 
   RowBox[{"i_", ",", " ", "ls_", ",", " ", "top_"}], "]"}], ":=", 
  RowBox[{"MemberQ", "[", 
   RowBox[{
    RowBox[{"ls", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"ls", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"top", "//", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"ii_", ",", "i"}], "]"}], "\[RuleDelayed]", " ", "ii"}], 
        "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inLeft", "[", 
   RowBox[{"ls_", ",", " ", "top_"}], "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"inLeft", "[", 
      RowBox[{
       RowBox[{"ls", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", "ls", ",", "top"}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"ii", ",", "2", ",", 
       RowBox[{"Length", "@", "ls"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ConsistentOrder", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConsistentOrder", "[", 
   RowBox[{"nm1_", ",", "top_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "allorder", "}"}], ",", 
    RowBox[{
     RowBox[{"allorder", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "2", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Permutations", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"3", ",", "nm1"}], "]"}], "]"}]}]}], ";", 
     RowBox[{"allorder", "=", 
      RowBox[{"allorder", "//", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"f_", "/;", 
           RowBox[{"inLeft", "[", 
            RowBox[{"f", ",", "top"}], "]"}]}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.842419806383766*^9, 3.8424199412089443`*^9}, {
   3.8424199940657454`*^9, 3.8424200286763763`*^9}, {3.842420444552554*^9, 
   3.842420445011114*^9}, 3.8424213239079*^9, {3.8424216057077913`*^9, 
   3.842421627034822*^9}, {3.84242166211164*^9, 3.8424216845191793`*^9}, {
   3.8424217674777822`*^9, 3.84242177712002*^9}, {3.84242950933322*^9, 
   3.8424295110326357`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"915d91cd-c71e-4996-b17e-e6d137cb7421"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"order2Mfun", ",", "list2top"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list2top", "[", "ls_List", "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ls", "]"}], "\[Equal]", "1"}], ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"ls", "[", 
         RowBox[{"[", 
          RowBox[{"ii", "-", "1"}], "]"}], "]"}], ",", 
        RowBox[{"ls", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "2", ",", 
        RowBox[{"Length", "@", "ls"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order2Mfun", "[", 
   RowBox[{"od_", ",", "top_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ls", ",", "allowedPartitions"}], "}"}], ",", 
    RowBox[{
     RowBox[{"allowedPartitions", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"MyPartitionOd", "[", "od", "]"}], ",", 
        RowBox[{"f_", "/;", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"top", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"list2top", "/@", "f"}], "//", "Flatten"}], ")"}]}], 
           ")"}]}]}]}], "]"}]}], ";", " ", 
     RowBox[{"ls", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"M", "@@@", "allowedPartitions"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"f1_", ",", "f___"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"L", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", "f1"}], "]"}]}], ",", "f"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ls", "[", 
         RowBox[{"[", "iii", "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"List", "[", 
          RowBox[{"f1_", ",", "g___"}], "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"top", "//", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Rule", "[", 
                 RowBox[{"ii_", ",", "f1"}], "]"}], "\[RuleDelayed]", " ", 
                "ii"}], "]"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "f1", ",", "g"}], "]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"iii", ",", 
         RowBox[{"Length", "@", "ls"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8424296813789883`*^9, 3.842429684320457*^9}, {
   3.8424297361143417`*^9, 3.84242974122054*^9}, {3.8424298383197002`*^9, 
   3.842430025912467*^9}, {3.842430056461475*^9, 3.842430073852194*^9}, {
   3.842430128031891*^9, 3.842430300339055*^9}, {3.842430418039826*^9, 
   3.8424304581372147`*^9}, {3.842430595130908*^9, 3.8424306019792213`*^9}, {
   3.842430822826119*^9, 3.842430824491026*^9}, 3.842441586221746*^9, {
   3.8424902772312593`*^9, 3.842490366455612*^9}, {3.8424904122243233`*^9, 
   3.842490425389668*^9}, {3.842569649491745*^9, 3.842569651441369*^9}, 
   3.842570481555649*^9, 3.842572456318274*^9},
 CellLabel->
  "In[322]:=",ExpressionUUID->"4f2228f5-f4bc-446d-ba13-19a94d114a66"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Mt", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mt", "[", "ls_M", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", 
       RowBox[{"List", "@@", "ls"}]}], ",", "phat", ",", "leftv", ",", "num", 
      ",", "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"od", "/.", 
         RowBox[{
          RowBox[{"L", "[", "f___", "]"}], "\[RuleDelayed]", 
          RowBox[{"{", "}"}]}]}], "/.", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"f1_", ",", "f___"}], "]"}], "\[RuleDelayed]", " ", 
         "f1"}]}], "//", "Flatten"}]}], ";", " ", 
     RowBox[{"phat", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"p", "/@", "phat"}]}], "]"}]}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"od", "=", 
      RowBox[{
       RowBox[{"od", "/.", 
        RowBox[{
         RowBox[{"L", "[", "f___", "]"}], "\[RuleDelayed]", 
         RowBox[{"{", "f", "}"}]}]}], "/.", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"f1_", ",", "f___"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"{", "f", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"leftv", ",", "od"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"(*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"Length", "@", "od"}]], "*)"}], 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v", ",", 
           RowBox[{"p", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mt", "[", 
   RowBox[{"a_", " ", "ls_M"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"Mt", "[", "ls", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.842430840979085*^9, 3.842430852674786*^9}, 
   3.842431084940221*^9, {3.842431132658041*^9, 3.8424312052286787`*^9}, {
   3.8424312380841208`*^9, 3.8424312470716963`*^9}, {3.8424312795583363`*^9, 
   3.842431366972395*^9}, {3.842431401307167*^9, 3.842431478145885*^9}, {
   3.842431528162805*^9, 3.842431570148491*^9}, 3.842431620536182*^9, {
   3.842431741997093*^9, 3.842431747822502*^9}, 3.8425320668196793`*^9, {
   3.846565452622879*^9, 3.846565489243559*^9}, 3.8499381680908813`*^9, {
   3.849938377147605*^9, 3.849938380818019*^9}, {3.849938413853136*^9, 
   3.849938421162908*^9}, 3.849939067547724*^9, 3.849940338552994*^9, {
   3.853387493283533*^9, 3.853387506027759*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"b0f0e953-3846-4b11-bc15-1d8ecf344bb8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Tt", "/@", 
      RowBox[{"mypartition", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ")"}], "//", "expandF"}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.849934859049008*^9, 3.849934899094037*^9}, {
   3.8499357420187387`*^9, 3.84993575065245*^9}, 3.8544284125678368`*^9, 
   3.854428480533188*^9},
 CellLabel->
  "In[328]:=",ExpressionUUID->"58a3d160-9174-49f5-9daf-a9c702f5dc0e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "NumPre", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumPre", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "alltop", ",", "lenTop", ",", "allods", ",", "res", ",", "res2"}], "}"}],
     ",", 
    RowBox[{
     RowBox[{"alltop", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"List", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"KLTRM", "[", "n", "]"}], "//.", "nice"}], "/.", 
                 RowBox[{
                  RowBox[{"CenterDot", "[", 
                   RowBox[{
                    SubscriptBox["p", "i_"], ",", 
                    SubscriptBox["p", "j_"]}], "]"}], "\[RuleDelayed]", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"1", ",", "i_"}], "]"}], "\[RuleDelayed]", " ", 
                 RowBox[{"0", "/;", 
                  RowBox[{"i", ">", "2"}]}]}]}], "//", "Union"}], "//", 
              "Expand"}], "//", "Total"}], ")"}], "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_s"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "]"}], "/.", 
         RowBox[{"Plus", "\[Rule]", " ", "List"}]}], "//", "Flatten"}], "//", 
       "Union"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"alltop", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@@", "alltop"}], ")"}], "/.", 
       RowBox[{"s", "\[Rule]", " ", "Rule"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"lenTop", "=", 
      RowBox[{"Length", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Keys", "@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Counts", "[", "#1", "]"}], ",", 
              RowBox[{
               RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}]}], ")"}], "&"}],
          "/@", 
         RowBox[{"(", 
          RowBox[{"Flatten", "/@", 
           RowBox[{"(", 
            RowBox[{"alltop", "/.", 
             RowBox[{"Rule", "\[Rule]", " ", "List"}]}], ")"}]}], ")"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allods", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{
          RowBox[{"ConsistentOrder", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", 
            RowBox[{"alltop", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"alltop", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "alltop"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"allods", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"f1_", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"order2Mfun", "[", 
               RowBox[{"#", ",", "f2"}], "]"}], "&"}], "/@", "f1"}], 
            ")"}]}]}], "//", "Flatten"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "alltop"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"res", ",", "lenTop"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Total", "/@", "res"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", "lenTop"}], ")"}]}], "/.", 
       RowBox[{
        RowBox[{"M", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"Length", "[", 
           RowBox[{"{", "f", "}"}], "]"}]], 
         RowBox[{"M", "[", "f", "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"M", "[", "f___", "]"}], "\[RuleDelayed]", "  ", 
        RowBox[{"Mt", "[", 
         RowBox[{"M", "[", "f", "]"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.853202164447188*^9, 3.85320217100595*^9}, {
   3.853202316807131*^9, 3.853202332415065*^9}, {3.853202366464652*^9, 
   3.8532023671973677`*^9}, {3.853202475537047*^9, 3.853202498162573*^9}, {
   3.853202563179946*^9, 3.853202586505467*^9}, {3.853215144189726*^9, 
   3.8532151816508217`*^9}, {3.8533875651127367`*^9, 
   3.8533875664069777`*^9}, {3.853387601858445*^9, 3.85338761779875*^9}, {
   3.853387656481176*^9, 3.853387660644102*^9}, {3.8533876917549267`*^9, 
   3.8533876941755342`*^9}, {3.853387849172793*^9, 3.853387887643906*^9}, 
   3.853387958572192*^9},
 CellLabel->
  "In[329]:=",ExpressionUUID->"84770e70-7f73-47e4-98a4-d78342eb9e92"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "ET2GT", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ET2GT", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"a", "[", "i_", "]"}], ":>", 
     SuperscriptBox["t", 
      SubscriptBox["a", "i"]]}]}], "/.", 
   RowBox[{
    RowBox[{"ET", "[", 
     RowBox[{"f1_GT", ",", 
      RowBox[{"{", "f2__", "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"f1", " ", 
     RowBox[{"tr", "[", 
      RowBox[{"CenterDot", "[", "f2", "]"}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.867108514590242*^9, 3.867108535216876*^9}, 
   3.867108567662366*^9, {3.867108644397539*^9, 3.867108647810176*^9}},
 CellLabel->
  "In[331]:=",ExpressionUUID->"90439321-0d9a-46df-82a5-aea5e28fe481"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"NumPre", "[", "4", "]"}], "//.", "nice"}], "*)"}]], "Input",
 CellChangeTimes->{{3.853917747020267*^9, 3.853917755402676*^9}, 
   3.854428484426598*^9},
 CellLabel->
  "In[333]:=",ExpressionUUID->"189cf105-7455-4566-b8eb-b5851bef6c67"]
}, Closed]],

Cell[CellGroupData[{

Cell["Algebra", "Section",
 CellChangeTimes->{{3.727085275547757*^9, 3.727085279642453*^9}, {
   3.749130217309951*^9, 3.749130238938786*^9}, 
   3.749179644362186*^9},ExpressionUUID->"da8a9d91-1b54-46b0-af96-\
6c4c1159d0e7"],

Cell[CellGroupData[{

Cell["subprogramme", "Subsubsection",
 CellChangeTimes->{{3.728292153199686*^9, 
  3.728292158406268*^9}},ExpressionUUID->"aa4171ce-ee5f-4149-a43e-\
f7491bb6e9f7"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "shuffle", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shuffle", "[", 
   RowBox[{"s1_List", ",", "s2_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"shuffle", "[", 
    RowBox[{"s1", ",", "s2"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "tp", ",", "ord"}], "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"Permutations", "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "&"}], "/@", "s1"}], ",", 
           RowBox[{
            RowBox[{"0", "&"}], "/@", "s2"}]}], "]"}]}], "\[Transpose]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"tp", "=", 
       RowBox[{"BitXor", "[", 
        RowBox[{"p", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ord", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Accumulate", "[", "p", "]"}], " ", "p"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Accumulate", "[", "tp", "]"}], "+", 
           RowBox[{"Length", "[", "s1", "]"}]}], ")"}], " ", "tp"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"Part", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{"s1", ",", "s2"}], "]"}], "}"}], ",", "ord", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}]}]}], 
    "]"}]}]}]}], "Input",
 CellLabel->
  "In[177]:=",ExpressionUUID->"9ffb383e-0cc5-4273-924c-fe799c24189a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"mC", ",", "nMC"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mC", "[", "f_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "f", "]"}], "=!=", "Plus"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], ">=", "2"}]}], ",", "True", ",", 
    "False"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMC", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"mC", "[", "f", "]"}], "]"}], "&&", " ", 
   RowBox[{
    RowBox[{"Head", "[", "f", "]"}], "=!=", "Plus"}]}]}]}], "Input",
 CellChangeTimes->{{3.856319318471849*^9, 3.8563193431920757`*^9}, {
   3.856320334312257*^9, 3.856320419240469*^9}, {3.8563205875649557`*^9, 
   3.856320594112719*^9}, {3.856320724920815*^9, 3.856320731151589*^9}, {
   3.8563297731533337`*^9, 3.8563298018032017`*^9}, {3.856334061482956*^9, 
   3.856334085687231*^9}, {3.856334158046072*^9, 3.8563341610118017`*^9}, {
   3.856334203490497*^9, 3.856334212033517*^9}, {3.856334288755166*^9, 
   3.856334294958416*^9}, 3.856334326466332*^9},
 CellLabel->
  "In[179]:=",ExpressionUUID->"ebe53da6-2405-474d-baaf-490009e2f361"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"ExpandNCM", ",", "ExpandT", ",", "GetTId"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
    RowBox[{"a___", ",", "b_Plus", ",", "c___"}], "]"}], "]"}], ":=", 
  RowBox[{"Distribute", "[", 
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "Plus", ",", "h", ",", 
    "Plus", ",", 
    RowBox[{
     RowBox[{"ExpandNCM", "[", 
      RowBox[{"h", "[", "##", "]"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
    RowBox[{"a___", ",", "b_Times", ",", "c___"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Most", "[", "b", "]"}], 
   RowBox[{"ExpandNCM", "[", 
    RowBox[{"h", "[", 
     RowBox[{"a", ",", 
      RowBox[{"Last", "[", "b", "]"}], ",", "c"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "a_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExpandNCM", "[", "#", "]"}], "&"}], "/@", 
   "a"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "c_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "*", 
   RowBox[{"ExpandNCM", "[", 
    RowBox[{"c", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "a_", "]"}], ":=", 
  RowBox[{"ExpandAll", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandT", "[", "f_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NonCommutativeMultiply", "@@", "f"}], "//", "ExpandNCM"}], 
      ")"}], "/.", 
     RowBox[{
      RowBox[{"T", "[", "hh__", "]"}], ":>", " ", "hh"}]}], "/.", 
    RowBox[{"NonCommutativeMultiply", "->", " ", "T"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandCT", "[", "f_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NonCommutativeMultiply", "@@", "f"}], "//", "ExpandNCM"}], 
     ")"}], "/.", 
    RowBox[{"NonCommutativeMultiply", "->", " ", "CircleTimes"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTId", "[", "f_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"T", "[", "hh__", "]"}], ":>", " ", "hh"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ExpandCircleTimes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandCircleTimes", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "/.", 
      RowBox[{"CircleTimes", "->", "NonCommutativeMultiply"}]}], "//", 
     "ExpandNCM"}], ")"}], "/.", 
   RowBox[{"NonCommutativeMultiply", "->", "CircleTimes"}]}]}]}], "Input",
 CellChangeTimes->{{3.856331822553081*^9, 3.8563319201712914`*^9}, {
  3.856332130050441*^9, 3.856332226769471*^9}, {3.8563453592245083`*^9, 
  3.856345406962907*^9}, {3.864021262354207*^9, 3.8640212631965113`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"81855e2f-3ffd-4f70-a2f3-dabfe460f2ae"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[FivePointedStar]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "mC"}], ",", 
    RowBox[{"g_T", "?", "mC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "g"}], "]"}]}], "]"}], "//",
       "ExpandT"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{"f", ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "ExpandT"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "ExpandT"}], ")"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "nMC"}], ",", 
    RowBox[{"g_T", "?", "mC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "GetTId"}], ")"}]}], 
     "]"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{"f", ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "ExpandT"}], ")"}], "-", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "GetTId"}], ")"}]}], 
     "]"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "mC"}], ",", 
    RowBox[{"g_T", "?", "nMC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "g"}], "]"}]}], "]"}], "//",
       "ExpandT"}], ")"}], "+", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "GetTId"}], ")"}]}], 
     "]"}], "-", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"T", "[", "hh__", "]"}], ":>", " ", "hh"}]}], ")"}]}], 
     "]"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "nMC"}], ",", 
    RowBox[{"g_T", "?", "nMC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "+", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
    RowBox[{"T", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"g", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_Plus", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_", ",", "g_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_Times", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_", ",", "g_Times"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"\[DoubleStruckCapitalI]", ",", "g_"}], "]"}], ":=", 
  "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"g_", ",", "\[DoubleStruckCapitalI]"}], "]"}], ":=", 
  "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f1_", ",", "f2_", ",", "g__"}], "]"}], ":=", 
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"\[FivePointedStar]", "[", 
     RowBox[{"f1", ",", "f2"}], "]"}], ",", "g"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", "g_T", "]"}], ":=", 
  "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_GT", ",", "g_GT"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "==", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "==", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{
     RowBox[{"T", "@@", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "/.", 
     RowBox[{
      RowBox[{"T", "[", "h___", "]"}], ":>", " ", 
      RowBox[{"GT", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{"#1", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "#"}], "]"}], 
             "&"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", "h", "}"}]}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"\[FivePointedStar]", "[", 
      RowBox[{
       RowBox[{"T", "@@", 
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"T", "@@", 
        RowBox[{"g", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"T", "[", "h__", "]"}], ":>", " ", 
      RowBox[{"GT", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{"#1", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "#"}], "]"}], 
             "&"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", "h", "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_ET", " ", ",", "g_ET"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "groupGens", "}"}], ",", 
    RowBox[{
     RowBox[{"groupGens", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"GT", "[", "gg__", "]"}], ":>", 
       RowBox[{"ET", "[", 
        RowBox[{
         RowBox[{"GT", "[", "gg", "]"}], ",", "groupGens"}], "]"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[FivePointedStar]", "[", 
     RowBox[{
      RowBox[{"f_GT", " ", "h_tr"}], ",", "g_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"h", " ", 
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{"f", " ", ",", "g"}], "]"}]}], "//", 
      RowBox[{"Expand", "\[IndentingNewLine]", 
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{"f_", " ", ",", 
         RowBox[{"g_GT", " ", "h_tr"}]}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"h", " ", 
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{"f", " ", ",", "g"}], "]"}]}], "//", "Expand"}]}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8563191594251137`*^9, 3.856319223417831*^9}, {
   3.856319257175762*^9, 3.856319305365706*^9}, {3.856319976718423*^9, 
   3.856320218369108*^9}, {3.856320252485381*^9, 3.8563202543741827`*^9}, {
   3.856320298002324*^9, 3.856320302663621*^9}, {3.856320604353388*^9, 
   3.856320619683857*^9}, {3.856320710164442*^9, 3.856320736317131*^9}, {
   3.856320819477583*^9, 3.856320878478187*^9}, {3.8563209139140453`*^9, 
   3.85632096668184*^9}, {3.856329223068709*^9, 3.8563292579462023`*^9}, {
   3.856329296539744*^9, 3.856329410385338*^9}, {3.856329514847363*^9, 
   3.856329648339566*^9}, {3.8563297646477747`*^9, 3.856329769224903*^9}, {
   3.856329809013173*^9, 3.85632985414421*^9}, {3.8563299958647213`*^9, 
   3.856330010629747*^9}, {3.856330127525535*^9, 3.8563301333989553`*^9}, {
   3.8563301711283207`*^9, 3.856330179424288*^9}, {3.85633025449926*^9, 
   3.856330269185977*^9}, {3.8563306034896297`*^9, 3.856330724273782*^9}, {
   3.856331638043936*^9, 3.856331652512753*^9}, {3.8563317082017717`*^9, 
   3.856331734577879*^9}, {3.856331935956551*^9, 3.856331959186226*^9}, {
   3.856332051418643*^9, 3.856332059112619*^9}, {3.856332172567361*^9, 
   3.856332176521573*^9}, {3.856332424309197*^9, 3.856332512543316*^9}, {
   3.8563334863364*^9, 3.856333644817451*^9}, 3.85633386133387*^9, {
   3.856333932731287*^9, 3.856333933116054*^9}, {3.856334222188333*^9, 
   3.856334245796074*^9}, {3.85634405027798*^9, 3.856344108089128*^9}, {
   3.856345685495426*^9, 3.856345712974819*^9}, {3.856401049370289*^9, 
   3.856401107609158*^9}, {3.856403332111394*^9, 3.8564033721547413`*^9}, {
   3.856412979290757*^9, 3.856412997304871*^9}, {3.856526220409972*^9, 
   3.856526245974831*^9}, {3.863830613634076*^9, 3.863830614175213*^9}, {
   3.863838245251693*^9, 3.863838284353326*^9}, {3.864001646885152*^9, 
   3.864001650368113*^9}, {3.8640016842922497`*^9, 3.864001729387974*^9}, {
   3.8640017672487164`*^9, 3.864001802688643*^9}, 3.8640018328625097`*^9, {
   3.8670344011776953`*^9, 3.867034455660643*^9}, {3.8670345471831417`*^9, 
   3.8670345686568317`*^9}, {3.867036310992589*^9, 3.86703635171941*^9}, {
   3.867036397495845*^9, 3.8670364033793383`*^9}, {3.8670364699796886`*^9, 
   3.8670364750546923`*^9}, 3.8670367572135344`*^9, {3.867036956302236*^9, 
   3.867037097158066*^9}, {3.8670371412616158`*^9, 3.867037168207168*^9}, {
   3.867037301568342*^9, 3.867037304798341*^9}, {3.8670374401260433`*^9, 
   3.867037442023959*^9}, {3.867037484740986*^9, 3.867037493393705*^9}, {
   3.867048401041164*^9, 3.8670484411596813`*^9}, {3.867048689445307*^9, 
   3.867048706033613*^9}, {3.867048835439487*^9, 3.867048836623272*^9}, {
   3.8670489376832447`*^9, 3.86704903149479*^9}, {3.86704908574683*^9, 
   3.867049189795974*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"f2717780-8787-4623-8120-caef4ecabb88"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[ScriptCapitalK]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalK]", "[", 
   RowBox[{"i_", ",", "0"}], "]"}], ":=", 
  RowBox[{"ET", "[", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", "[", "i", "]"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalK]", "[", 
   RowBox[{"i_", ",", "1"}], "]"}], ":=", 
  RowBox[{"ET", "[", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "i", "}"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.867034710461698*^9, 3.867034734322834*^9}, {
  3.867034887191278*^9, 3.867034888550497*^9}, {3.867035650819004*^9, 
  3.867035785291233*^9}, {3.867035967475918*^9, 3.867035977673946*^9}, {
  3.867036209889843*^9, 3.867036210042486*^9}, {3.867038880754631*^9, 
  3.867038886704546*^9}, {3.867038973711566*^9, 3.867039008424569*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"88067925-6de4-4adf-b660-fee27f053564"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalOmega]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{"f", ",", "g"}], "]"}], "-", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{"g", ",", "f"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{"f1_", ",", "f2_", ",", "g__"}], "]"}], ":=", 
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", 
     RowBox[{"f1", ",", "f2"}], "]"}], ",", "g"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.863907801646339*^9, 3.8639078028123903`*^9}, {
  3.863907970708768*^9, 3.863907973951502*^9}, {3.8639080934595346`*^9, 
  3.8639081472676373`*^9}, {3.863908180432868*^9, 3.8639082452117853`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"441bd8c5-3adf-43ab-bfb6-e9a8ffcdce3e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "S", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "f_T", "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], ">", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "f"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"f", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ";;", 
             RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}]}], "]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "f", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"-", "f"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "f_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", "S"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "f_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", "S"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "\[DoubleStruckCapitalI]", "]"}], ":=", 
  "\[DoubleStruckCapitalI]"}]}], "Input",
 CellChangeTimes->{{3.856341767589827*^9, 3.856341787236245*^9}, 
   3.856342993267667*^9, {3.856343662477735*^9, 3.856343842104086*^9}, {
   3.856343977685211*^9, 3.856343979034301*^9}, {3.856344572414899*^9, 
   3.856344601934135*^9}, {3.8563452884732933`*^9, 3.856345292677517*^9}, {
   3.856345663314186*^9, 3.85634567551547*^9}, {3.85640337999352*^9, 
   3.8564033825549173`*^9}, {3.856412697206216*^9, 3.856412739952289*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"cc89f358-78bf-40fe-962a-c94d366446b3"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalDelta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_T", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], ">", "1"}], ",", 
    RowBox[{
     RowBox[{"CircleTimes", "[", 
      RowBox[{"\[DoubleStruckCapitalI]", ",", "f"}], "]"}], "+", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"f", ",", "\[DoubleStruckCapitalI]"}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CircleTimes", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "i"}], "]"}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ";;", 
             RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}]}], "]"}], "//",
         "ExpandCT"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "f", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
    ",", 
    RowBox[{
     RowBox[{"CircleTimes", "[", 
      RowBox[{"\[DoubleStruckCapitalI]", ",", "f"}], "]"}], "+", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"f", ",", "\[DoubleStruckCapitalI]"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[CapitalDelta]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[CapitalDelta]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_GT", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[CapitalDelta]", "[", 
    RowBox[{"T", "@@", 
     RowBox[{"f", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "h__", "]"}], ":>", 
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", "h", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "\[DoubleStruckCapitalI]", "]"}], ":=", 
  RowBox[{"CircleTimes", "[", 
   RowBox[{"\[DoubleStruckCapitalI]", ",", "\[DoubleStruckCapitalI]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.856344692802022*^9, 3.856344861263785*^9}, {
   3.856344903038559*^9, 3.856344946890854*^9}, {3.856345431300519*^9, 
   3.856345435091799*^9}, {3.856345529021326*^9, 3.8563455420262012`*^9}, 
   3.856345847718631*^9, {3.8563459495745363`*^9, 3.856345952867259*^9}, {
   3.856403387620563*^9, 3.856403400466671*^9}, {3.863838141446711*^9, 
   3.8638381421102953`*^9}, {3.863838372108491*^9, 3.86383837563701*^9}, {
   3.864021127405699*^9, 3.864021151348419*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"1485dcfb-cc31-40fb-a75c-a3b44fa8a20c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"picCTR", ",", "picCTL"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picCTR", "[", "ls_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"f__", ",", "g_"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"g", "===", "\[DoubleStruckCapitalI]"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"List", "@@", "g"}], "]"}], "]"}], "=!=", "ls"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picCTL", "[", "ls_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"g_", ",", "f__"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"g", "===", "\[DoubleStruckCapitalI]"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"List", "@@", "g"}], "]"}], "]"}], "=!=", "ls"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"picTR", ",", "picTL"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picTR", "[", "h_T", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"f__", ",", "g_"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{"g", "=!=", "h"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picTL", "[", "h_T", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"g_", ",", "f__"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{"g", "=!=", "h"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.856399620803289*^9, 3.856399698507834*^9}, {
   3.856399731098884*^9, 3.856399745574304*^9}, {3.8563998310084057`*^9, 
   3.856399858003364*^9}, {3.8563998906339417`*^9, 3.856399955720414*^9}, {
   3.856400695446101*^9, 3.856400754295403*^9}, {3.856400809950757*^9, 
   3.8564008280537863`*^9}, {3.856403410367573*^9, 3.8564034127158003`*^9}, 
   3.856413007279652*^9},
 CellLabel->
  "In[225]:=",ExpressionUUID->"109aa14b-d071-455f-85a8-485af7850572"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"CtCut", ",", "CTCut"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CtCut", "[", "f__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", 
       RowBox[{"{", "f", "}"}]}], ",", "phat", ",", "leftv", ",", "num", ",", 
      "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"od", ",", "\[DoubleStruckCapitalI]"}], "]"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"First", "[", 
              RowBox[{"Min", "[", 
               RowBox[{
               "od", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"leftv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"od", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CTCut", "[", "f__", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"CtCut", "@@", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "f", "}"}], "/.", 
        RowBox[{
         RowBox[{"T", "[", "g__", "]"}], ":>", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "g", "}"}], "]"}]}]}], ")"}], ")"}]}], ")"}], 
   RowBox[{"Times", "[", "f", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.864013314707815*^9, 3.864013418131531*^9}, {
   3.864013449310534*^9, 3.864013473661511*^9}, {3.864013650450053*^9, 
   3.864013676242391*^9}, 3.864015042182406*^9, {3.8641022729568253`*^9, 
   3.864102294335894*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"6081fdd3-4eb3-431d-9d57-c725f3951126"],

Cell[CellGroupData[{

Cell[BoxData["SortBy"], "Input",
 CellChangeTimes->{{3.864102055014082*^9, 3.864102059338228*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"6734054c-f8df-4c5f-b05e-e13ef842e031"],

Cell[BoxData["SortBy"], "Output",
 CellChangeTimes->{
  3.864362867467437*^9, 3.8643661473169193`*^9, 3.8644740979111977`*^9, 
   3.8648751019430656`*^9, 3.866677314817376*^9, 3.867033771183186*^9, 
   3.867034862126466*^9, {3.867035598829199*^9, 3.867035625385405*^9}, 
   3.8681693882266903`*^9, 3.868169437673685*^9, 3.868607315104979*^9, 
   3.869008918107621*^9, 3.8690095107758293`*^9},
 CellLabel->
  "Out[234]=",ExpressionUUID->"547a689b-22b0-410d-acc3-41a53054909d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MinimalBy", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "4", ",", "1"}], "}"}], ",", "#1"}], "]"}],
     "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8641019916314383`*^9, 3.8641019933029833`*^9}, {
  3.864102176828389*^9, 3.8641022493743677`*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"1585890d-e2d6-4f4e-bbf7-b8cea6d4b7d2"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{{3.8641022216069736`*^9, 3.864102235983807*^9}, 
   3.864362867472823*^9, 3.864366147332725*^9, 3.864474097916811*^9, 
   3.864875101948475*^9, 3.866677314824753*^9, 3.867033771189108*^9, 
   3.8670348621346607`*^9, {3.8670355988361683`*^9, 3.867035625391366*^9}, 
   3.8681693882328463`*^9, 3.868169437679203*^9, 3.868607315113391*^9, 
   3.869008918114365*^9, 3.8690095107800303`*^9},
 CellLabel->
  "Out[235]=",ExpressionUUID->"e9cf6a43-268e-47bc-8f44-a1ebed450a58"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"GT2Cut", ",", "CT2GT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GT2Cut", "[", 
   RowBox[{"fc_", ",", "fk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", "fk"}], ",", 
      RowBox[{"odc", "=", "fc"}], ",", "phat", ",", "leftv", ",", "num", ",", 
      "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"odc", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"odc", ",", 
                RowBox[{
                 RowBox[{"MinimalBy", "[", 
                  RowBox[{
                   RowBox[{
                   "od", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"odc", ",", "#1"}], "]"}], "&"}]}], "]"}], "//", 
                 "First"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"leftv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{
             RowBox[{"MinimalBy", "[", 
              RowBox[{
               RowBox[{
               "od", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"odc", ",", "#1"}], "]"}], "&"}]}], "]"}], "//", 
             "First"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CT2GT", "[", "f__", "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[DoubleStruckCapitalI]"}], "]"}], ",", 
    RowBox[{"Return", "[", "0", "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"GT2Cut", "@@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "f", "}"}], "/.", 
             RowBox[{
              RowBox[{"GT", "[", 
               RowBox[{"c_", ",", "g_"}], "]"}], ":>", "c"}]}], ")"}], "//", 
           "Union"}], "//", "Flatten"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", "f", "}"}], "/.", 
           RowBox[{
            RowBox[{"GT", "[", 
             RowBox[{"c_", ",", "g_"}], "]"}], ":>", 
            RowBox[{"Flatten", "[", "g", "]"}]}]}], ")"}]}], "}"}]}], ")"}], 
     RowBox[{"Times", "[", "f", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.864005726313146*^9, 3.8640057267126703`*^9}, {
   3.8640073262593*^9, 3.864007336198358*^9}, {3.864012275149953*^9, 
   3.864012305338114*^9}, {3.864012436466858*^9, 3.864012449061061*^9}, {
   3.8640126440948772`*^9, 3.864012667128831*^9}, {3.864014420471593*^9, 
   3.864014467932979*^9}, {3.864014557387258*^9, 3.864014575458349*^9}, {
   3.864016026746132*^9, 3.864016045185341*^9}, {3.8640161247111053`*^9, 
   3.864016129503875*^9}, 3.864016960933386*^9, {3.864017043020999*^9, 
   3.864017060264268*^9}, {3.864017153492383*^9, 3.864017236480606*^9}, {
   3.864017277005508*^9, 3.864017327444517*^9}, {3.864017358098238*^9, 
   3.8640173809283543`*^9}, {3.8640176954876537`*^9, 
   3.8640176969752502`*^9}, {3.864017791410964*^9, 3.864017809265267*^9}, {
   3.864102346196558*^9, 3.864102384095622*^9}, {3.864102448244149*^9, 
   3.864102450679813*^9}, 3.864102624671569*^9},
 CellLabel->
  "In[236]:=",ExpressionUUID->"dcf534f1-3d4f-44fc-973c-a5c1e3eb1583"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalDelta]", "[", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.856345570013097*^9, 3.856345588088924*^9}, {
   3.86382705094645*^9, 3.863827092896261*^9}, {3.863827353985824*^9, 
   3.863827361527443*^9}, {3.863828337562736*^9, 3.863828369771544*^9}, {
   3.8638284240732737`*^9, 3.86382846280264*^9}, {3.863828502545103*^9, 
   3.863828510264798*^9}, {3.863828565378174*^9, 3.863828572412634*^9}, {
   3.863828810177979*^9, 3.8638288388068037`*^9}, 3.863838419527261*^9, {
   3.864013123322544*^9, 3.86401314527297*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"fd0a54cd-2351-4ce9-9e2a-36e47215275e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[DoubleStruckCapitalI]", "\[CircleTimes]", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}], "\[CircleTimes]", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", ",", "3"}], "}"}], "}"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "]"}], "\[CircleTimes]", 
   "\[DoubleStruckCapitalI]"}]}]], "Output",
 CellChangeTimes->{
  3.86382883945164*^9, 3.863907051428915*^9, {3.864013129979299*^9, 
   3.864013145988575*^9}, 3.8641016366821213`*^9, 3.86436286749641*^9, 
   3.864366147344948*^9, 3.864474097939362*^9, 3.8648751019692507`*^9, 
   3.866677314845685*^9, 3.867033771213726*^9, 3.867034862159521*^9, {
   3.86703559886001*^9, 3.867035625415627*^9}, 3.868169388257236*^9, 
   3.8681694377001057`*^9, 3.868607315138029*^9, 3.869008918142356*^9, 
   3.869009510798912*^9},
 CellLabel->
  "Out[239]=",ExpressionUUID->"490b9568-cfd3-4adb-b1c6-efd8831fc955"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}], "\[CircleTimes]", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], "/.", 
  RowBox[{"CircleTimes", "->", "CT2GT"}]}]], "Input",
 CellChangeTimes->{{3.864102479551299*^9, 3.864102511183682*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"ea5119f4-f7f9-4db1-bdc4-6a8ab5a87518"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"p", "[", "4", "]"}]}], "]"}], " ", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}], " ", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], 
  RowBox[{"dot", "[", 
   RowBox[{"v", ",", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}]]], "Output",
 CellChangeTimes->{{3.864102492500392*^9, 3.8641025273723507`*^9}, 
   3.8641026415989532`*^9, 3.864362867501753*^9, 3.864366147351097*^9, 
   3.8644740979544783`*^9, 3.864875101985063*^9, 3.8666773148590403`*^9, 
   3.867033771231745*^9, 3.867034862180586*^9, {3.867035598865028*^9, 
   3.867035625421728*^9}, 3.868169388276455*^9, 3.868169437716316*^9, 
   3.868607315144485*^9, 3.8690089181613407`*^9, 3.869009510816085*^9},
 CellLabel->
  "Out[240]=",ExpressionUUID->"2f29328b-71fc-4a15-81a5-f0559f949302"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalOmega]", "[", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "2", "}"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.863830348110487*^9, 3.8638303517092876`*^9}, {
  3.863838209579482*^9, 3.863838217261692*^9}, {3.864001882583105*^9, 
  3.864001924797205*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"15afbb5c-2510-40ae-b3a7-ab109d212069"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], "+", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}], "+", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}], "+", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], "-", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}], "-", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.8638303522694073`*^9, 3.8638306221846743`*^9, {3.8638381946375723`*^9, 
   3.8638382177073708`*^9}, 3.863838294904525*^9, 3.863907051434423*^9, 
   3.8640018956667833`*^9, 3.864001925871306*^9, 3.864101636687339*^9, 
   3.864362867518488*^9, 3.8643661473662786`*^9, 3.864474097959735*^9, 
   3.8648751019903593`*^9, 3.866677314864687*^9, 3.867033771237236*^9, 
   3.86703486218781*^9, {3.867035598870243*^9, 3.8670356254393387`*^9}, 
   3.868169388283205*^9, 3.868169437722349*^9, 3.868607315151219*^9, 
   3.869008918166971*^9, 3.869009510820822*^9},
 CellLabel->
  "Out[241]=",ExpressionUUID->"7dcd75c2-06fd-4930-898b-b66a55ee8703"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Chapter",
 CellChangeTimes->{{3.854428181759294*^9, 
  3.85442818627633*^9}},ExpressionUUID->"33fa4030-ed72-4bf1-ab48-\
7145b1dd9e42"],

Cell[CellGroupData[{

Cell["four-pointCK three-scalar", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.8690095454796762`*^9, 
  3.869009579711589*^9}},ExpressionUUID->"817e9074-7fca-4457-9306-\
18f83bbf601a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0E0ow3Ecx/G1orSDZ7t4SLJYWDRsNPlfWA7K04pkY00zZcxEyyy2RmsO
MkoteTh4fogpRsptlox5WmoeUiT/EpmHw/D7fg+fXrfP4Z3cpK5UMBkMRhIZ
eM0N5Rt3acq6VFoOaks2asGeBQdqH3rONBOFVh0PNAe1AlCrkxaCztl5Daif
XUaVJqUFvGddWcEuU+IM6DNwUPXyOw0WV32ikr3wN9BWwUanWn6jB4lMbkgM
GOaYdoP16SuodjPgB5tvftCl1rqofWKbTI6q7aZ48ODCho57btWgcewBLRBp
sr2HNHU304cea/qFoP9lBJVXT/L/iLXUAsqUSY9A32sT+hnXyWlw01QKT4/m
5sUG1ohCSxa6w5JtrxPdbCX6zVbNnRCPey/R+JqEVVDUzkXNrkDEKZH/UhgJ
Dm9RdY/Eog8x2mJ3KoLEskUX2r0nsYDnAjmqu59IpT2kX7YnDfx6MuSAHeKM
fFA12ui1npHfqgH0Hwc+HpM=
  "],
 CellLabel->
  "In[245]:=",ExpressionUUID->"78349c61-2062-4fef-91df-16bac98b954e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8671077331244783`*^9, 3.867107770016876*^9}, 
   3.869008935636294*^9, 3.8690095244219227`*^9, 3.869009556476042*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"300a029f-4e33-4524-b4b5-917987935555"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "pre"}], "-", "numerator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"preNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"1", ",", "0"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"ET", "[", "f__", "]"}], ":>", 
       RowBox[{"ET2F", "[", 
        RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
      RowBox[{"tr", "[", 
       RowBox[{"f", ",", 
        RowBox[{"t", "^", 
         RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "//.", 
    "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.86816929518775*^9, 3.868169325503978*^9}, {
   3.868169462928048*^9, 3.8681694794877234`*^9}, {3.8690096139605627`*^9, 
   3.869009623822521*^9}, {3.8690110033636847`*^9, 3.8690110081703367`*^9}, 
   3.8690119438512077`*^9, {3.8690125432609367`*^9, 3.869012575460663*^9}, {
   3.869012781996496*^9, 3.869012787536962*^9}, {3.86901747407027*^9, 
   3.869017476493034*^9}},ExpressionUUID->"e4b6b7f9-edd8-4a81-81e2-\
9bd92b796f82"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{
    SubscriptBox["p", "1"], "\[CenterDot]", 
    SubscriptBox["F", "3"], "\[CenterDot]", 
    SubscriptBox["p", "2"]}], " ", 
   RowBox[{"tr", "[", 
    RowBox[{
     SuperscriptBox["t", 
      SubscriptBox["a", "1"]], ",", 
     SuperscriptBox["t", 
      SubscriptBox["a", "2"]], ",", 
     SuperscriptBox["t", 
      SubscriptBox["a", "4"]]}], "]"}]}], 
  RowBox[{
   SubscriptBox["p", 
    RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
   SubscriptBox["p", 
    RowBox[{"1", ",", "2"}]]}]]], "Output",
 CellChangeTimes->{
  3.868169326453335*^9, {3.8681694511968117`*^9, 3.868169479940092*^9}, 
   3.869008937889398*^9, 3.869009527708951*^9, {3.869009619004876*^9, 
   3.869009624308172*^9}, 3.869011008667276*^9, 3.8690112780894747`*^9, 
   3.869011693384818*^9, 3.869011724592535*^9, 3.869011812321857*^9, 
   3.869011944334138*^9, 3.8690125438351383`*^9, 3.869012576139936*^9},
 CellLabel->
  "Out[378]=",ExpressionUUID->"c8d6d820-21c5-47e4-90fa-b9a6428ffa8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "in", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], 
  RowBox[{"bcjNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "0"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"ET", "[", "f__", "]"}], ":>", 
        RowBox[{"ET2F", "[", 
         RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"t", "^", 
          RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
     "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.869012583259577*^9, 3.869012642019123*^9}, {
   3.869012755831274*^9, 3.8690127748427*^9}, 
   3.869017479301708*^9},ExpressionUUID->"76c4e133-e3c5-414d-aa29-\
3c6d00072ad6"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]]}]], "Output",
 CellChangeTimes->{{3.869012623545829*^9, 3.869012642546542*^9}},
 CellLabel->
  "Out[380]=",ExpressionUUID->"4eeae3f7-6daa-4bb3-817b-89f7b6ac0999"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "beyond", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inputOP", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"1", ",", "0"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"2", ",", "0"}], "]"}]}], "}"}]}], " ", ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Set", " ", "input", " ", 
      RowBox[{"operators", ":", " ", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}]}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "the", " ", "particle", " ", "label"}], ",",
      " ", 
     RowBox[{"j", " ", "is", " ", "the", " ", "particle", " ", "spin"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bcjNumG", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bpeff2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", 
          RowBox[{"i_", ":>", 
           RowBox[{
            RowBox[{"inputOP", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/;", 
            RowBox[{"NumberQ", "[", "i", "]"}]}]}]}], "/.", 
         RowBox[{"X", "->", "\[CapitalOmega]"}]}], "/.", 
        RowBox[{
         RowBox[{"ET", "[", "f__", "]"}], ":>", 
         RowBox[{"ET2F", "[", 
          RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"t", "^", 
           RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
      "niceF"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869012746718834*^9, 3.869012747249916*^9}, {
  3.8690127942815332`*^9, 3.869012969209333*^9}, {3.869013013154786*^9, 
  3.869013135838513*^9}, {3.869017487805229*^9, 
  3.869017493763782*^9}},ExpressionUUID->"b6739c3d-ed5a-4c97-964f-\
af473ded1b19"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]]}]], "Output",
 CellChangeTimes->{{3.8690127449163322`*^9, 3.869012747738381*^9}, 
   3.8690129358282413`*^9, 3.86901296993078*^9, {3.869013013666724*^9, 
   3.869013091877961*^9}, {3.869013131478684*^9, 3.8690131364935503`*^9}},
 CellLabel->
  "Out[400]=",ExpressionUUID->"972a2eb7-223b-40d1-9561-2f650ecc4c4f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["four-pointCK two-scalar", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.8690095454796762`*^9, 3.869009579711589*^9}, {3.869013163073915*^9, 
  3.869013164565288*^9}},ExpressionUUID->"23a98e14-a6e4-45f9-affb-\
e5a7325e2c29"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0E0ow3Ecx/G1orSDZ7t4SLJYWDRsNPlfWA7K04pkY00zZcxEyyy2RmsO
MkoteTh4fogpRsptlox5WmoeUiT/EpmHw/D7fg+fXrfP4Z3cpK5UMBkMRhIZ
eM0N5Rt3acq6VFoOaks2asGeBQdqH3rONBOFVh0PNAe1AlCrkxaCztl5Daif
XUaVJqUFvGddWcEuU+IM6DNwUPXyOw0WV32ikr3wN9BWwUanWn6jB4lMbkgM
GOaYdoP16SuodjPgB5tvftCl1rqofWKbTI6q7aZ48ODCho57btWgcewBLRBp
sr2HNHU304cea/qFoP9lBJVXT/L/iLXUAsqUSY9A32sT+hnXyWlw01QKT4/m
5sUG1ohCSxa6w5JtrxPdbCX6zVbNnRCPey/R+JqEVVDUzkXNrkDEKZH/UhgJ
Dm9RdY/Eog8x2mJ3KoLEskUX2r0nsYDnAjmqu59IpT2kX7YnDfx6MuSAHeKM
fFA12ui1npHfqgH0Hwc+HpM=
  "],
 CellLabel->
  "In[401]:=",ExpressionUUID->"5332646f-1609-4151-ba7f-ff5386a69414"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8671077331244783`*^9, 3.867107770016876*^9}, 
   3.869008935636294*^9, 3.8690095244219227`*^9, 3.869009556476042*^9, 
   3.8690131908260717`*^9},
 CellLabel->
  "Out[402]=",ExpressionUUID->"794f104b-a97a-4fa3-91fc-ee4a0e3a85f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "pre"}], "-", "numerator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"preNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"ET", "[", "f__", "]"}], ":>", 
        RowBox[{"ET2F2s", "[", 
         RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"t", "^", 
          RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
     "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.86816929518775*^9, 3.868169325503978*^9}, {
   3.868169462928048*^9, 3.8681694794877234`*^9}, {3.8690096139605627`*^9, 
   3.869009623822521*^9}, {3.8690110033636847`*^9, 3.8690110081703367`*^9}, 
   3.8690119438512077`*^9, {3.8690125432609367`*^9, 3.869012575460663*^9}, {
   3.869012781996496*^9, 3.869012787536962*^9}, {3.8690141495155*^9, 
   3.8690141684965277`*^9}, {3.869015050319406*^9, 3.869015070543192*^9}, {
   3.869017375570051*^9, 
   3.869017395101398*^9}},ExpressionUUID->"57748248-a69e-4ce1-9360-\
33ddece748bb"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "3"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.868169326453335*^9, {3.8681694511968117`*^9, 3.868169479940092*^9}, 
   3.869008937889398*^9, 3.869009527708951*^9, {3.869009619004876*^9, 
   3.869009624308172*^9}, 3.869011008667276*^9, 3.8690112780894747`*^9, 
   3.869011693384818*^9, 3.869011724592535*^9, 3.869011812321857*^9, 
   3.869011944334138*^9, 3.8690125438351383`*^9, 3.869012576139936*^9, {
   3.869014154422172*^9, 3.869014170732709*^9}, 3.869014256323368*^9, 
   3.869014312499539*^9, 3.869014579320953*^9, 3.86901499148769*^9, {
   3.869015050793645*^9, 3.86901507148388*^9}},
 CellLabel->
  "Out[492]=",ExpressionUUID->"72ebd11d-e3da-4501-aad2-b4e189de02ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"preNumeratorAnti", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"3", ",", "0"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"ET", "[", "f__", "]"}], ":>", 
       RowBox[{"ET2F2s", "[", 
        RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
      RowBox[{"tr", "[", 
       RowBox[{"f", ",", 
        RowBox[{"t", "^", 
         RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
    "niceF"}]}]], "Input",
 CellChangeTimes->{{3.869014609414502*^9, 3.8690146214371862`*^9}, {
  3.8690150894893007`*^9, 3.869015100190031*^9}},
 CellLabel->
  "In[494]:=",ExpressionUUID->"e90150c7-ff15-45aa-8814-97f583554fba"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "3"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.869014622095397*^9, {3.869015094157449*^9, 3.869015100627625*^9}},
 CellLabel->
  "Out[494]=",ExpressionUUID->"be10154f-c3e8-4bbf-86f8-ecabf5e33c63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "in", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], 
  RowBox[{"bcjNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"ET", "[", "f__", "]"}], ":>", 
        RowBox[{"ET2F2s", "[", 
         RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"t", "^", 
          RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
     "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.869012583259577*^9, 3.869012642019123*^9}, {
   3.869012755831274*^9, 3.8690127748427*^9}, {3.869015114946846*^9, 
   3.869015147413125*^9}, 
   3.869017398436391*^9},ExpressionUUID->"28e9a5df-0a80-498c-a4fd-\
5d33b4740eb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["t", 
        SubscriptBox["a", "3"]], ",", 
       SuperscriptBox["t", 
        SubscriptBox["a", "4"]]}], "]"}]}], 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"3", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"3", ",", "1"}]]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "3"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{{3.869012623545829*^9, 3.869012642546542*^9}, {
   3.869015123625246*^9, 3.869015148070993*^9}, 3.8690162711665688`*^9},
 CellLabel->
  "Out[561]=",ExpressionUUID->"f8d720f6-ab98-4ee4-8dbe-fc3339dbd5b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "beyond", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inputOP", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"1", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"3", ",", "0"}], "]"}]}], "}"}]}], " ", ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Set", " ", "input", " ", 
      RowBox[{"operators", ":", " ", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}]}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "the", " ", "particle", " ", "label"}], ",",
      " ", 
     RowBox[{"j", " ", "is", " ", "the", " ", "particle", " ", "spin"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bcjNumG", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bpeff2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", 
          RowBox[{"i_", ":>", 
           RowBox[{
            RowBox[{"inputOP", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/;", 
            RowBox[{"NumberQ", "[", "i", "]"}]}]}]}], "/.", 
         RowBox[{"X", "->", "\[CapitalOmega]"}]}], "/.", 
        RowBox[{
         RowBox[{"ET", "[", "f__", "]"}], ":>", 
         RowBox[{"ET2F2s", "[", 
          RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"t", "^", 
           RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
      "niceF"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869012746718834*^9, 3.869012747249916*^9}, {
  3.8690127942815332`*^9, 3.869012969209333*^9}, {3.869013013154786*^9, 
  3.869013135838513*^9}, {3.8690163508006268`*^9, 3.869016371412492*^9}, {
  3.869017404878447*^9, 
  3.869017409655086*^9}},ExpressionUUID->"dda77831-8a0d-4d92-bd35-\
09eaf2905d89"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{
      SubscriptBox["p", "3"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "3"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["t", 
        SubscriptBox["a", "3"]], ",", 
       SuperscriptBox["t", 
        SubscriptBox["a", "4"]]}], "]"}]}], 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"3", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"3", ",", "1"}]]}]]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "3"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "3"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"3", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{{3.8690127449163322`*^9, 3.869012747738381*^9}, 
   3.8690129358282413`*^9, 3.86901296993078*^9, {3.869013013666724*^9, 
   3.869013091877961*^9}, {3.869013131478684*^9, 3.8690131364935503`*^9}, {
   3.86901635578586*^9, 3.869016371789898*^9}},
 CellLabel->
  "Out[564]=",ExpressionUUID->"822fedbf-81c3-4229-b291-a8e926d7850a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["five-pointCK three-scalar", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.8690095454796762`*^9, 3.869009579711589*^9}, {3.86901639952699*^9, 
  3.869016400658622*^9}},ExpressionUUID->"4b6996f2-81d1-4fe4-b04d-\
bdfaf7d49183"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0E0ow3Ecx/G1orSDZ7sgksU8RcNmkf8FOShPqy0x1jSUMRMtI6zRmiIP
pZbYDjbPMeUp5TZLm2dSnkPav0Tm4eDh9/0ePr1un8M7ukZZImcyGIwoMvCC
68vr3aQp42x+EajOWxaD7TY7aup/TtITBUZNCqj/UfNBtaZKCG5YrCpQa5lD
FTqFAbxlnRnBVl2kGTzv4qDKuTcazC39QEVb/q/gSDEbnaz7De4jMrk+IaCf
fcoJVsTPo+oV7yVYe/WNzjZIgraJjVIZqjTpwsGdkxF0zH2tBHtH79GsbFXq
4S5N3Zg7UZeqWwBeeoZQWdkE748opmwoU1q1B56/1KAfYS2cSidNxaRo0fSM
UO8iUWBIRtdZ0rUlopOtQL/Y9dP7RFfHKRpeHrEAZjdxUb3DG3BA5HmEgeDA
KiV5JOa8F6B1pg35D7FwxoG2bYkM4DFfhmpux2NpN+mX6o4DP5+60sDmgsRM
sH64+tB4RH5Le9CHu8KEQeK6VYT+A0O8J9I=
  "],
 CellLabel->
  "In[565]:=",ExpressionUUID->"9e1ccd26-ef44-4db4-ba62-0e19b5f79f43"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", 
       RowBox[{"X", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", "4"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{"3", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8671077331244783`*^9, 3.867107770016876*^9}, 
   3.869008935636294*^9, 3.8690095244219227`*^9, 3.869009556476042*^9, 
   3.869016411095448*^9},
 CellLabel->
  "Out[566]=",ExpressionUUID->"f827d97d-b095-4040-a5ff-5aaef0bdffa0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "pre"}], "-", "numerator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"preNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"1", ",", "0"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"4", ",", "1"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"ET", "[", "f__", "]"}], ":>", 
       RowBox[{"ET2F", "[", 
        RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
      RowBox[{"tr", "[", 
       RowBox[{"f", ",", 
        RowBox[{"t", "^", 
         RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "//.", 
    "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.86816929518775*^9, 3.868169325503978*^9}, {
   3.868169462928048*^9, 3.8681694794877234`*^9}, {3.8690096139605627`*^9, 
   3.869009623822521*^9}, {3.8690110033636847`*^9, 3.8690110081703367`*^9}, 
   3.8690119438512077`*^9, {3.8690125432609367`*^9, 3.869012575460663*^9}, {
   3.869012781996496*^9, 3.869012787536962*^9}, {3.869016424465212*^9, 
   3.869016433257565*^9}, 3.8690173452635317`*^9, {3.8690174199291487`*^9, 
   3.869017422101261*^9}},ExpressionUUID->"9fb0869b-181d-48b6-be4e-\
3541f723c1e2"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"2", ",", "4"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.868169326453335*^9, {3.8681694511968117`*^9, 3.868169479940092*^9}, 
   3.869008937889398*^9, 3.869009527708951*^9, {3.869009619004876*^9, 
   3.869009624308172*^9}, 3.869011008667276*^9, 3.8690112780894747`*^9, 
   3.869011693384818*^9, 3.869011724592535*^9, 3.869011812321857*^9, 
   3.869011944334138*^9, 3.8690125438351383`*^9, 3.869012576139936*^9, 
   3.869016438447342*^9},
 CellLabel->
  "Out[567]=",ExpressionUUID->"ffb45f73-c177-4558-bd51-dd94dd799478"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"preNumerator", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"1", ",", "0"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"2", ",", "0"}], "]"}], ",", 
        RowBox[{"\[ScriptCapitalK]", "[", 
         RowBox[{"4", ",", "1"}], "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"ET", "[", "f__", "]"}], ":>", 
       RowBox[{"ET2F", "[", 
        RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
      RowBox[{"tr", "[", 
       RowBox[{"f", ",", 
        RowBox[{"t", "^", 
         RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
    "niceF"}]}]], "Input",
 CellChangeTimes->{{3.869016462618657*^9, 3.86901647531238*^9}},
 CellLabel->
  "In[569]:=",ExpressionUUID->"943c97f5-a0d5-4523-af62-51c706691f77"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8690164668274403`*^9, 3.869016475865736*^9}},
 CellLabel->
  "Out[569]=",ExpressionUUID->"a47b5ac7-b1ac-43b4-b5e7-3ca1b1e8be05"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "in", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], 
  RowBox[{"bcjNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "0"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"4", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"ET", "[", "f__", "]"}], ":>", 
        RowBox[{"ET2F", "[", 
         RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"t", "^", 
          RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
     "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.869012583259577*^9, 3.869012642019123*^9}, {
   3.869012755831274*^9, 3.8690127748427*^9}, 3.869016533210186*^9, {
   3.869017182155456*^9, 3.869017196095768*^9}, 
   3.869017322560588*^9},ExpressionUUID->"f491960b-807b-4d31-8066-\
04bd1e0da0fc"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"2", ",", "4"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "3"}]]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"2", ",", "4"}]], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]]}]], "Output",
 CellChangeTimes->{{3.869012623545829*^9, 3.869012642546542*^9}, 
   3.8690165346658373`*^9, 3.86901719957673*^9},
 CellLabel->
  "Out[599]=",ExpressionUUID->"ba921eb5-385c-4317-9281-927003d63f40"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "beyond", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inputOP", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"1", ",", "0"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"4", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"2", ",", "0"}], "]"}]}], "}"}]}], " ", ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Set", " ", "input", " ", 
      RowBox[{"operators", ":", " ", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}]}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "the", " ", "particle", " ", "label"}], ",",
      " ", 
     RowBox[{"j", " ", "is", " ", "the", " ", "particle", " ", "spin"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bcjNumG", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bpeff2", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/.", 
          RowBox[{"i_", ":>", 
           RowBox[{
            RowBox[{"inputOP", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/;", 
            RowBox[{"NumberQ", "[", "i", "]"}]}]}]}], "/.", 
         RowBox[{"X", "->", "\[CapitalOmega]"}]}], "/.", 
        RowBox[{
         RowBox[{"ET", "[", "f__", "]"}], ":>", 
         RowBox[{"ET2F", "[", 
          RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"t", "^", 
           RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
      "niceF"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869012746718834*^9, 3.869012747249916*^9}, {
  3.8690127942815332`*^9, 3.869012969209333*^9}, {3.869013013154786*^9, 
  3.869013135838513*^9}, {3.8690165687327538`*^9, 3.869016584200803*^9}, {
  3.8690173339469433`*^9, 
  3.8690173401445713`*^9}},ExpressionUUID->"78fde08c-503b-44b1-b815-\
575140837d1f"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"2", ",", "4"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "2"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "3"}]]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "3"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "-", 
  FractionBox[
   RowBox[{"4", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"2", ",", "4"}]], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}], "\[CenterDot]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["p", "4"], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "2"], "\[CenterDot]", 
     SubscriptBox["F", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "2"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "1"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"1", ",", "2"}]]}]]}]], "Output",
 CellChangeTimes->{{3.8690127449163322`*^9, 3.869012747738381*^9}, 
   3.8690129358282413`*^9, 3.86901296993078*^9, {3.869013013666724*^9, 
   3.869013091877961*^9}, {3.869013131478684*^9, 3.8690131364935503`*^9}, 
   3.8690165848838463`*^9},
 CellLabel->
  "Out[571]=",ExpressionUUID->"02530f16-006a-400f-acea-fca7601c0ecd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["five-pointCK two-scalar", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.8690095454796762`*^9, 3.869009579711589*^9}, {3.869013163073915*^9, 
  3.869013164565288*^9}, {3.86901640347239*^9, 
  3.8690164046186666`*^9}},ExpressionUUID->"64ee664b-fb04-4fa5-856f-\
f56107066b94"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", 
    RowBox[{"n", "-", "1"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0E0ow3Ecx/G1mpKDZ7uMSMTCmoaNyP8yclCeViSbLdooY6ZpYWGN1hR5
KLXk4cA8xxSzlBtLxjymhqVI+5fIPBw8/L7fw6fX7XN4J8jV5Q1MBoMRTwbe
cIME/bs0ZVkqKgW14o1qsNNmR62Dz+kmosii54GmH60Q1OqleaBjbkEDds8t
o0qj0gz6Qq4sYIcxbha8NiSj6uU3Giys+EAlztBXcKyMjU6rfiMHiEwuKwoM
ts+4wNrUFVS7GfCCjbff6FJzTcQesUWmQNVWIwfcvxhDJ9x3arB//AHNzdfw
PYc0dT/bgx5rekWg1z+CKiqnBH/EasqGMmXSI/D6RY5+xLQn17loKpHXjWZl
RwfWiCJzBroTItteJ7rYSvSL3TR/QjzuukQ5VbGrYH4rFzUdBMJOiQJ/Xjg4
tEXVPBIL3otRldXR8EMsWTxAdU6JGTwXKlC9bzKJdpN+fHcK+PlkyATbitNy
wKbReo/ljPxW9KEqxrd4mKhj/aL/N6EnHA==
  "],
 CellLabel->
  "In[572]:=",ExpressionUUID->"6f47fbfa-d791-495e-b0ba-fb387023d70e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}], ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", 
       RowBox[{"X", "[", 
        RowBox[{"3", ",", "4"}], "]"}]}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", "4"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"X", "[", 
      RowBox[{"3", ",", "4"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}], ",", "4"}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8671077331244783`*^9, 3.867107770016876*^9}, 
   3.869008935636294*^9, 3.8690095244219227`*^9, 3.869009556476042*^9, 
   3.8690131908260717`*^9, 3.869016633048568*^9},
 CellLabel->
  "Out[573]=",ExpressionUUID->"8071c500-c64f-4164-95e7-9afd450219d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "pre"}], "-", "numerator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"preNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"4", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"ET", "[", "f__", "]"}], ":>", 
        RowBox[{"ET2F2s", "[", 
         RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"t", "^", 
          RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
     "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.86816929518775*^9, 3.868169325503978*^9}, {
   3.868169462928048*^9, 3.8681694794877234`*^9}, {3.8690096139605627`*^9, 
   3.869009623822521*^9}, {3.8690110033636847`*^9, 3.8690110081703367`*^9}, 
   3.8690119438512077`*^9, {3.8690125432609367`*^9, 3.869012575460663*^9}, {
   3.869012781996496*^9, 3.869012787536962*^9}, {3.8690141495155*^9, 
   3.8690141684965277`*^9}, {3.869015050319406*^9, 3.869015070543192*^9}, {
   3.8690166396416607`*^9, 3.869016644304433*^9}, {3.869017452855124*^9, 
   3.8690174545155*^9}},ExpressionUUID->"38d53818-8fe7-43c7-81ad-\
4f0cb13dd74c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["t", 
        SubscriptBox["a", "4"]], ",", 
       SuperscriptBox["t", 
        SubscriptBox["a", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
      SubscriptBox["p", 
       RowBox[{"4", ",", "1"}]]}], " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["p", 
       RowBox[{"4", ",", "1", ",", "2"}]]}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.868169326453335*^9, {3.8681694511968117`*^9, 3.868169479940092*^9}, 
   3.869008937889398*^9, 3.869009527708951*^9, {3.869009619004876*^9, 
   3.869009624308172*^9}, 3.869011008667276*^9, 3.8690112780894747`*^9, 
   3.869011693384818*^9, 3.869011724592535*^9, 3.869011812321857*^9, 
   3.869011944334138*^9, 3.8690125438351383`*^9, 3.869012576139936*^9, {
   3.869014154422172*^9, 3.869014170732709*^9}, 3.869014256323368*^9, 
   3.869014312499539*^9, 3.869014579320953*^9, 3.86901499148769*^9, {
   3.869015050793645*^9, 3.86901507148388*^9}, 3.869016645399892*^9, 
   3.869017213646759*^9},
 CellLabel->
  "Out[600]=",ExpressionUUID->"f1c80d4b-a427-4cd0-9859-1b12f735a941"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "in", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], 
  RowBox[{"bcjNumerator", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"1", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"2", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"\[ScriptCapitalK]", "[", 
          RowBox[{"4", ",", "0"}], "]"}]}], "]"}], "/.", 
       RowBox[{
        RowBox[{"ET", "[", "f__", "]"}], ":>", 
        RowBox[{"ET2F2s", "[", 
         RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
      RowBox[{
       RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
       RowBox[{"tr", "[", 
        RowBox[{"f", ",", 
         RowBox[{"t", "^", 
          RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
     "niceF"}]}]}]], "Input",
 CellChangeTimes->{{3.869012583259577*^9, 3.869012642019123*^9}, {
   3.869012755831274*^9, 3.8690127748427*^9}, {3.869015114946846*^9, 
   3.869015147413125*^9}, 3.869016800949233*^9, 
   3.869017266125304*^9},ExpressionUUID->"3665a4bf-2a22-46a6-833b-\
2c612a3a69d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["t", 
        SubscriptBox["a", "4"]], ",", 
       SuperscriptBox["t", 
        SubscriptBox["a", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
      SubscriptBox["p", 
       RowBox[{"4", ",", "1"}]]}], " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["p", 
       RowBox[{"4", ",", "1", ",", "2"}]]}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]]}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "2"}]]}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{{3.869012623545829*^9, 3.869012642546542*^9}, {
   3.869015123625246*^9, 3.869015148070993*^9}, 3.8690162711665688`*^9, 
   3.869016809694612*^9, 3.869017227590912*^9},
 CellLabel->
  "Out[601]=",ExpressionUUID->"0fbd347d-2b26-4635-b19c-6a5be3bc1857"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generate", " ", "BCJ", " ", "numerator", " ", "beyond", " ", "the", " ", 
    "DDM", " ", "basis"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"inputOP", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"1", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"2", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"3", ",", "1"}], "]"}], ",", 
      RowBox[{"\[ScriptCapitalK]", "[", 
       RowBox[{"4", ",", "0"}], "]"}]}], "}"}]}], " ", ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Set", " ", "input", " ", 
      RowBox[{"operators", ":", " ", 
       RowBox[{"\[ScriptCapitalK]", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}]}], ",", " ", 
     RowBox[{"i", " ", "is", " ", "the", " ", "particle", " ", "label"}], ",",
      " ", 
     RowBox[{"j", " ", "is", " ", "the", " ", "particle", " ", "spin"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"bcjNumG", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"bpeff2", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "/.", 
          RowBox[{"i_", ":>", 
           RowBox[{
            RowBox[{"inputOP", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/;", 
            RowBox[{"NumberQ", "[", "i", "]"}]}]}]}], "/.", 
         RowBox[{"X", "->", "\[CapitalOmega]"}]}], "/.", 
        RowBox[{
         RowBox[{"ET", "[", "f__", "]"}], ":>", 
         RowBox[{"ET2F2s", "[", 
          RowBox[{"ET", "[", "f", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"CenterDot", "[", "f__", "]"}], ":>", 
        RowBox[{"tr", "[", 
         RowBox[{"f", ",", 
          RowBox[{"t", "^", 
           RowBox[{"a", "[", "n", "]"}]}]}], "]"}]}]}], "/.", "rmzero"}], "//.",
      "niceF"}]}]}]}]], "Input",
 CellChangeTimes->{{3.869012746718834*^9, 3.869012747249916*^9}, {
  3.8690127942815332`*^9, 3.869012969209333*^9}, {3.869013013154786*^9, 
  3.869013135838513*^9}, {3.8690163508006268`*^9, 3.869016371412492*^9}, {
  3.869016852619245*^9, 3.869016878194784*^9}, {3.8690172741565523`*^9, 
  3.869017304628399*^9}},ExpressionUUID->"5ba17ce1-7990-4605-8f18-\
971cabb9b6bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["F", "3"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{
      SubscriptBox["p", "4"], "\[CenterDot]", 
      SubscriptBox["F", "1"], "\[CenterDot]", 
      SubscriptBox["F", "2"], "\[CenterDot]", 
      SubscriptBox["p", "4"]}], " ", 
     RowBox[{"tr", "[", 
      RowBox[{
       SuperscriptBox["t", 
        SubscriptBox["a", "4"]], ",", 
       SuperscriptBox["t", 
        SubscriptBox["a", "5"]]}], "]"}]}], 
    RowBox[{
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
      SubscriptBox["p", 
       RowBox[{"4", ",", "1"}]]}], " ", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
      SubscriptBox["p", 
       RowBox[{"4", ",", "1", ",", "2"}]]}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]]}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"1", ",", "2"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "2"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "2"}]]}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1"}]]}], " ", 
    RowBox[{
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]], "\[CenterDot]", 
     SubscriptBox["p", 
      RowBox[{"4", ",", "1", ",", "3"}]]}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SubscriptBox["p", "4"], "\[CenterDot]", 
     SubscriptBox["F", "3"], "\[CenterDot]", 
     SubscriptBox["F", "2"], "\[CenterDot]", 
     SubscriptBox["F", "1"], "\[CenterDot]", 
     SubscriptBox["p", "4"]}], " ", 
    RowBox[{"tr", "[", 
     RowBox[{
      SuperscriptBox["t", 
       SubscriptBox["a", "4"]], ",", 
      SuperscriptBox["t", 
       SubscriptBox["a", "5"]]}], "]"}]}], 
   RowBox[{
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]], "\[CenterDot]", 
    SubscriptBox["p", 
     RowBox[{"4", ",", "1"}]]}]]}]], "Output",
 CellChangeTimes->{{3.8690127449163322`*^9, 3.869012747738381*^9}, 
   3.8690129358282413`*^9, 3.86901296993078*^9, {3.869013013666724*^9, 
   3.869013091877961*^9}, {3.869013131478684*^9, 3.8690131364935503`*^9}, {
   3.86901635578586*^9, 3.869016371789898*^9}, {3.869016854806409*^9, 
   3.869016878626039*^9}, 3.869017235980132*^9},
 CellLabel->
  "Out[602]=",ExpressionUUID->"c62581ec-7a80-433d-93de-dae506a4e9c3"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1019, 796},
WindowMargins->{{195, Automatic}, {Automatic, 27}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"37b6de1f-9a11-4454-a12e-725d44bf4cdf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1369, 24, 234, "Input",ExpressionUUID->"8b241212-cb5e-4c49-a1af-98e2bcd66219"],
Cell[1930, 46, 558, 15, 104, "Input",ExpressionUUID->"3393b6dd-2dd8-4da7-a9bf-4a90e4e4196d"],
Cell[CellGroupData[{
Cell[2513, 65, 159, 3, 86, "Chapter",ExpressionUUID->"6f54012d-343c-4ceb-b753-c573c7d67539"],
Cell[CellGroupData[{
Cell[2697, 72, 157, 3, 87, "Section",ExpressionUUID->"51c8b79b-932a-4bdd-86b8-9f06849e255f"],
Cell[2857, 77, 7929, 180, 374, "Input",ExpressionUUID->"55360a2d-4dd7-400f-a70c-a61b9360a901"],
Cell[10789, 259, 1610, 46, 130, "Input",ExpressionUUID->"4149be1f-54e8-4768-affb-873e3ffb7708"],
Cell[12402, 307, 1660, 50, 182, "Input",ExpressionUUID->"db980e6f-c9eb-40df-82ed-d128a8cd4e6a"],
Cell[14065, 359, 4831, 116, 182, "Input",ExpressionUUID->"353b453e-7fe1-4c88-9e64-e211a751f1d3"],
Cell[18899, 477, 4528, 135, 442, "Input",ExpressionUUID->"d39168db-af52-466a-8c1c-3dce7bdae539"],
Cell[23430, 614, 1173, 30, 104, "Input",ExpressionUUID->"efe94482-f280-4b66-8aa3-fed140d0cead"],
Cell[24606, 646, 1698, 49, 234, "Input",ExpressionUUID->"cdcdb279-a5ed-43f3-904b-5176a6e821cb"],
Cell[26307, 697, 2351, 72, 182, "Input",ExpressionUUID->"df94535a-4cf7-400a-8f0d-bc011efc1341"],
Cell[28661, 771, 1197, 35, 156, "Input",ExpressionUUID->"e91fa3ea-9348-4961-b522-401ec5557bd8"],
Cell[29861, 808, 2532, 67, 208, "Input",ExpressionUUID->"66e83810-5681-4752-bf3a-11426cdcbc6b"],
Cell[32396, 877, 1209, 28, 104, "Input",ExpressionUUID->"cc5f4918-d6f8-4850-bf9f-ee49c7cde23b"],
Cell[33608, 907, 1227, 32, 104, "Input",ExpressionUUID->"4ca1da07-81cb-4631-88a9-f703a50b34d5"],
Cell[34838, 941, 611, 16, 78, "Input",ExpressionUUID->"4b80cfac-5cc6-4749-b1cb-94688ff33281"]
}, Closed]],
Cell[CellGroupData[{
Cell[35486, 962, 251, 4, 68, "Section",ExpressionUUID->"cfb31aa4-4c33-47e3-9314-40b147b11cd7"],
Cell[35740, 968, 5759, 168, 442, "Input",ExpressionUUID->"3b026f50-74e8-47ea-9b65-5708cecb4224"],
Cell[41502, 1138, 8575, 199, 702, "Input",ExpressionUUID->"6d7a5698-6c9f-4875-8fc7-070180e74656"],
Cell[50080, 1339, 437, 11, 51, "Input",ExpressionUUID->"d3163509-c76f-4d04-bab0-28699a3c6fcf"],
Cell[50520, 1352, 3917, 103, 286, "Input",ExpressionUUID->"95432486-40d0-4c0f-a731-a71280cfa8b8"],
Cell[54440, 1457, 572, 15, 101, "Input",ExpressionUUID->"32678e5b-cacb-4914-871b-e514db6b9001"],
Cell[55015, 1474, 1453, 37, 182, "Input",ExpressionUUID->"9fca1398-c03c-43e4-bd99-054cba98489d"],
Cell[56471, 1513, 1143, 26, 182, "Input",ExpressionUUID->"4a6d63ba-b190-4097-bc1e-1de1dbdb9712"],
Cell[57617, 1541, 2688, 79, 260, "Input",ExpressionUUID->"bd2f10cc-2728-43f9-9e29-3ecccadfecad"],
Cell[60308, 1622, 11933, 340, 855, "Input",ExpressionUUID->"5c228a1e-30a8-4551-ac44-013adb9fee58"],
Cell[72244, 1964, 2096, 58, 286, "Input",ExpressionUUID->"b08007f5-74da-4184-8bcc-70e944a2201b"],
Cell[74343, 2024, 5908, 193, 494, "Input",ExpressionUUID->"835d0c66-9e89-4ea6-beb8-e47124c22ee9"]
}, Closed]],
Cell[CellGroupData[{
Cell[80288, 2222, 190, 3, 68, "Section",ExpressionUUID->"51c8b79b-932a-4bdd-86b8-9f06849e255f"],
Cell[80481, 2227, 2982, 76, 260, "Input",ExpressionUUID->"ea70f9c9-d4d2-46fe-9ada-2ec969aca9f4"],
Cell[CellGroupData[{
Cell[83488, 2307, 3154, 72, 147, "Input",ExpressionUUID->"84d91cb8-e100-4f54-82fe-9f221285ab55"],
Cell[86645, 2381, 2576, 44, 51, "Output",ExpressionUUID->"954d84af-dd5c-4f80-9456-d1daf2655503"],
Cell[89224, 2427, 3168, 62, 97, "Output",ExpressionUUID->"6d297b92-4201-4999-b14b-143f0260daba"]
}, Open  ]],
Cell[92407, 2492, 45038, 1221, 3758, "Input",ExpressionUUID->"0472f27d-9a7f-4178-9309-50f70c8fbd78"],
Cell[CellGroupData[{
Cell[137470, 3717, 414, 13, 51, "Input",ExpressionUUID->"81cec74f-2e5a-4d2e-8439-c844ec580913"],
Cell[137887, 3732, 457, 14, 51, "Output",ExpressionUUID->"e8da5631-a63d-4479-a618-f61dd346fae3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138381, 3751, 481, 13, 51, "Input",ExpressionUUID->"c0c7068b-019d-4230-af4c-f445c496911e"],
Cell[138865, 3766, 177, 3, 51, "Output",ExpressionUUID->"4c6a429f-9379-4909-b15e-a8df018d1f32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139079, 3774, 621, 18, 51, "Input",ExpressionUUID->"98736bd3-c1b0-41e3-9144-15c18807b56a"],
Cell[139703, 3794, 225, 4, 51, "Output",ExpressionUUID->"558a32a4-96a9-475a-aa19-ef1a1c0f6dcc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139965, 3803, 299, 7, 51, "Input",ExpressionUUID->"6ec743f6-7eb7-4a60-b7ca-d5ef814e8b22"],
Cell[140267, 3812, 206, 4, 51, "Output",ExpressionUUID->"a2f1abfc-5895-41da-91fb-f65a4bbd6846"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140510, 3821, 372, 8, 51, "Input",ExpressionUUID->"b2ceee9f-0a48-4209-8663-4d3f868954b2"],
Cell[140885, 3831, 2683, 83, 104, "Output",ExpressionUUID->"7123092e-3356-4ff4-b3bc-f64f52896029"]
}, Open  ]],
Cell[143583, 3917, 7342, 208, 624, "Input",ExpressionUUID->"98f6ff7c-f071-411c-95fb-9bc9ab005816"],
Cell[150928, 4127, 1620, 40, 156, "Input",ExpressionUUID->"76ebb2e1-fb6b-4889-9d7e-34f9228369b5"],
Cell[152551, 4169, 2612, 72, 234, "Input",ExpressionUUID->"915d91cd-c71e-4996-b17e-e6d137cb7421"],
Cell[155166, 4243, 3551, 94, 286, "Input",ExpressionUUID->"4f2228f5-f4bc-446d-ba13-19a94d114a66"],
Cell[158720, 4339, 4194, 109, 396, "Input",ExpressionUUID->"b0f0e953-3846-4b11-bc15-1d8ecf344bb8"],
Cell[162917, 4450, 515, 14, 51, "Input",ExpressionUUID->"58a3d160-9174-49f5-9daf-a9c702f5dc0e"],
Cell[163435, 4466, 5515, 147, 469, "Input",ExpressionUUID->"84770e70-7f73-47e4-98a4-d78342eb9e92"],
Cell[168953, 4615, 759, 20, 78, "Input",ExpressionUUID->"90439321-0d9a-46df-82a5-aea5e28fe481"],
Cell[169715, 4637, 288, 7, 51, "Input",ExpressionUUID->"189cf105-7455-4566-b8eb-b5851bef6c67"]
}, Closed]],
Cell[CellGroupData[{
Cell[170040, 4649, 225, 4, 68, "Section",ExpressionUUID->"da8a9d91-1b54-46b0-af96-6c4c1159d0e7"],
Cell[CellGroupData[{
Cell[170290, 4657, 163, 3, 41, "Subsubsection",ExpressionUUID->"aa4171ce-ee5f-4149-a43e-f7491bb6e9f7"],
Cell[170456, 4662, 1621, 47, 182, "Input",ExpressionUUID->"9ffb383e-0cc5-4273-924c-fe799c24189a"],
Cell[172080, 4711, 1214, 28, 104, "Input",ExpressionUUID->"ebe53da6-2405-474d-baaf-490009e2f361"],
Cell[173297, 4741, 3233, 93, 442, "Input",ExpressionUUID->"81855e2f-3ffd-4f70-a2f3-dabfe460f2ae"],
Cell[176533, 4836, 15355, 432, 910, "Input",ExpressionUUID->"f2717780-8787-4623-8120-caef4ecabb88"],
Cell[191891, 5270, 1183, 30, 104, "Input",ExpressionUUID->"88067925-6de4-4adf-b660-fee27f053564"],
Cell[193077, 5302, 933, 21, 104, "Input",ExpressionUUID->"441bd8c5-3adf-43ab-bfb6-e9a8ffcdce3e"],
Cell[194013, 5325, 2355, 65, 208, "Input",ExpressionUUID->"cc89f358-78bf-40fe-962a-c94d366446b3"],
Cell[196371, 5392, 3188, 85, 260, "Input",ExpressionUUID->"1485dcfb-cc31-40fb-a75c-a3b44fa8a20c"],
Cell[199562, 5479, 2042, 54, 182, "Input",ExpressionUUID->"109aa14b-d071-455f-85a8-485af7850572"],
Cell[201607, 5535, 4678, 129, 364, "Input",ExpressionUUID->"6081fdd3-4eb3-431d-9d57-c725f3951126"],
Cell[CellGroupData[{
Cell[206310, 5668, 181, 3, 51, "Input",ExpressionUUID->"6734054c-f8df-4c5f-b05e-e13ef842e031"],
Cell[206494, 5673, 475, 8, 51, "Output",ExpressionUUID->"547a689b-22b0-410d-acc3-41a53054909d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207006, 5686, 511, 14, 51, "Input",ExpressionUUID->"1585890d-e2d6-4f4e-bbf7-b8cea6d4b7d2"],
Cell[207520, 5702, 539, 9, 51, "Output",ExpressionUUID->"e9cf6a43-268e-47bc-8f44-a1ebed450a58"]
}, Open  ]],
Cell[208074, 5714, 6592, 172, 520, "Input",ExpressionUUID->"dcf534f1-3d4f-44fc-973c-a5c1e3eb1583"],
Cell[CellGroupData[{
Cell[214691, 5890, 917, 20, 51, "Input",ExpressionUUID->"fd0a54cd-2351-4ce9-9e2a-36e47215275e"],
Cell[215611, 5912, 1779, 49, 104, "Output",ExpressionUUID->"490b9568-cfd3-4adb-b1c6-efd8831fc955"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217427, 5966, 719, 21, 51, "Input",ExpressionUUID->"ea5119f4-f7f9-4db1-bdc4-6a8ab5a87518"],
Cell[218149, 5989, 1293, 34, 73, "Output",ExpressionUUID->"2f29328b-71fc-4a15-81a5-f0559f949302"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219479, 6028, 608, 17, 51, "Input",ExpressionUUID->"15afbb5c-2510-40ae-b3a7-ab109d212069"],
Cell[220090, 6047, 1974, 59, 78, "Output",ExpressionUUID->"7dcd75c2-06fd-4930-898b-b66a55ee8703"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222137, 6114, 152, 3, 86, "Chapter",ExpressionUUID->"33fa4030-ed72-4bf1-ab48-7145b1dd9e42"],
Cell[CellGroupData[{
Cell[222314, 6121, 519, 8, 87, "Section",ExpressionUUID->"817e9074-7fca-4457-9306-18f83bbf601a"],
Cell[CellGroupData[{
Cell[222858, 6133, 861, 19, 78, "Input",ExpressionUUID->"78349c61-2062-4fef-91df-16bac98b954e"],
Cell[223722, 6154, 520, 14, 51, "Output",ExpressionUUID->"300a029f-4e33-4524-b4b5-917987935555"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224279, 6173, 1390, 35, 130, "Input",ExpressionUUID->"e4b6b7f9-edd8-4a81-81e2-9bd92b796f82"],
Cell[225672, 6210, 1025, 27, 79, "Output",ExpressionUUID->"c8d6d820-21c5-47e4-90fa-b9a6428ffa8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226734, 6242, 1201, 33, 130, "Input",ExpressionUUID->"76c4e133-e3c5-414d-aa29-3c6d00072ad6"],
Cell[227938, 6277, 1307, 42, 79, "Output",ExpressionUUID->"4eeae3f7-6daa-4bb3-817b-89f7b6ac0999"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229282, 6324, 2110, 56, 182, "Input",ExpressionUUID->"b6739c3d-ed5a-4c97-964f-af473ded1b19"],
Cell[231395, 6382, 1456, 44, 79, "Output",ExpressionUUID->"972a2eb7-223b-40d1-9561-2f650ecc4c4f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[232900, 6432, 563, 8, 68, "Section",ExpressionUUID->"23a98e14-a6e4-45f9-affb-e5a7325e2c29"],
Cell[CellGroupData[{
Cell[233488, 6444, 861, 19, 78, "Input",ExpressionUUID->"5332646f-1609-4151-ba7f-ff5386a69414"],
Cell[234352, 6465, 548, 15, 51, "Output",ExpressionUUID->"794f104b-a97a-4fa3-91fc-ee4a0e3a85f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234937, 6485, 1544, 38, 130, "Input",ExpressionUUID->"57748248-a69e-4ce1-9360-33ddece748bb"],
Cell[236484, 6525, 1222, 30, 79, "Output",ExpressionUUID->"72ebd11d-e3da-4501-aad2-b4e189de02ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237743, 6560, 1040, 28, 104, "Input",ExpressionUUID->"e90150c7-ff15-45aa-8814-97f583554fba"],
Cell[238786, 6590, 744, 23, 79, "Output",ExpressionUUID->"be10154f-c3e8-4bbf-86f8-ecabf5e33c63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239567, 6618, 1253, 34, 130, "Input",ExpressionUUID->"28e9a5df-0a80-498c-a4fd-5d33b4740eb5"],
Cell[240823, 6654, 1359, 42, 79, "Output",ExpressionUUID->"f8d720f6-ab98-4ee4-8dbe-fc3339dbd5b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242219, 6701, 2163, 57, 182, "Input",ExpressionUUID->"dda77831-8a0d-4d92-bd35-09eaf2905d89"],
Cell[244385, 6760, 1483, 44, 79, "Output",ExpressionUUID->"822fedbf-81c3-4229-b291-a8e926d7850a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[245917, 6810, 564, 8, 68, "Section",ExpressionUUID->"4b6996f2-81d1-4fe4-b04d-bdfaf7d49183"],
Cell[CellGroupData[{
Cell[246506, 6822, 873, 19, 78, "Input",ExpressionUUID->"9e1ccd26-ef44-4db4-ba62-0e19b5f79f43"],
Cell[247382, 6843, 1223, 38, 78, "Output",ExpressionUUID->"f827d97d-b095-4040-a5ff-5aaef0bdffa0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[248642, 6886, 1557, 38, 130, "Input",ExpressionUUID->"9fb0869b-181d-48b6-be4e-3541f723c1e2"],
Cell[250202, 6926, 3268, 102, 142, "Output",ExpressionUUID->"ffb45f73-c177-4558-bd51-dd94dd799478"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253507, 7033, 1070, 29, 104, "Input",ExpressionUUID->"943c97f5-a0d5-4523-af62-51c706691f77"],
Cell[254580, 7064, 179, 3, 51, "Output",ExpressionUUID->"a47b5ac7-b1ac-43b4-b5e7-3ca1b1e8be05"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254796, 7072, 1365, 36, 130, "Input",ExpressionUUID->"f491960b-807b-4d31-8066-04bd1e0da0fc"],
Cell[256164, 7110, 5728, 189, 203, "Output",ExpressionUUID->"ba921eb5-385c-4317-9281-927003d63f40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261929, 7304, 2251, 59, 182, "Input",ExpressionUUID->"78fde08c-503b-44b1-b815-575140837d1f"],
Cell[264183, 7365, 5856, 191, 203, "Output",ExpressionUUID->"02530f16-006a-400f-acea-fca7601c0ecd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[270088, 7562, 613, 9, 68, "Section",ExpressionUUID->"64ee664b-fb04-4fa5-856f-f56107066b94"],
Cell[CellGroupData[{
Cell[270726, 7575, 873, 19, 78, "Input",ExpressionUUID->"6f47fbfa-d791-495e-b0ba-fb387023d70e"],
Cell[271602, 7596, 1247, 38, 78, "Output",ExpressionUUID->"8071c500-c64f-4164-95e7-9afd450219d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[272886, 7639, 1682, 40, 130, "Input",ExpressionUUID->"38d53818-8fe7-43c7-81ad-4f0cb13dd74c"],
Cell[274571, 7681, 3164, 91, 137, "Output",ExpressionUUID->"f1c80d4b-a427-4cd0-9859-1b12f735a941"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277772, 7777, 1367, 36, 130, "Input",ExpressionUUID->"3665a4bf-2a22-46a6-833b-2c612a3a69d2"],
Cell[279142, 7815, 5122, 161, 195, "Output",ExpressionUUID->"0fbd347d-2b26-4635-b19c-6a5be3bc1857"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284301, 7981, 2297, 59, 182, "Input",ExpressionUUID->"5ba17ce1-7990-4605-8f18-971cabb9b6bf"],
Cell[286601, 8042, 5270, 163, 195, "Output",ExpressionUUID->"c62581ec-7a80-433d-93de-dae506a4e9c3"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

