(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    320083,       8455]
NotebookOptionsPosition[    300024,       8183]
NotebookOutlinePosition[    300648,       8203]
CellTagsIndexPosition[    300605,       8200]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Loading Packages", "Section",
 CellChangeTimes->{{3.851831445638886*^9, 
  3.851831451080901*^9}},ExpressionUUID->"14683071-943c-4012-bcab-\
810b516799fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\>\"", 
  "]"}], "\n", 
 RowBox[{"Get", "[", "\"\<KiHA.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.849852812872097*^9, 3.849852815421134*^9}, {
   3.8514905747464647`*^9, 3.851490575829479*^9}, 3.852687594094639*^9, 
   3.852705286286529*^9, {3.8527053858912477`*^9, 3.852705418586442*^9}, {
   3.853201921107329*^9, 3.853201921420554*^9}, 3.8552931097900457`*^9, {
   3.8563167236231318`*^9, 3.856316724143917*^9}, 3.9364337696894197`*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"63b04dbe-df92-4309-b176-b1a6da73bcf5"],

Cell[BoxData["\<\"/Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\"\>"],\
 "Output",
 CellChangeTimes->{{3.93643333854895*^9, 3.9364333667749767`*^9}, 
   3.936433775051779*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"4e3f3971-efcc-479e-84c3-435281ff5b3d"],

Cell["\<\
 KiHA(v6.0),Copyright 2022,author Gang Chen. It is licensed under the GNU \
General Public License v3.0. 
 KiHA is based on the work of Kinematic Hopf Algebra in CTP of Queen Mary \
University of London. It generates the duality all-n numerator for \
colour-kinematic duality and double copy in heavy mass effective 
 theory(HEFT), YM, YM-Scalar, YM-fermion, F3+F4 theory and DF2+YM theory. \
KiHA is built on some basic functions written by Gustav Mogull and Gregor \
Kaelin.
 use ?KiHA`* for help and a series of papers (2111.15649, 2208.05519, \
2208.05886,2310.11943) for more reference.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.936433775057599*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"16e51e20-a1a4-454b-8317-d54a5f7c2ce8"]
}, Open  ]],

Cell[TextData[StyleBox["All momentum are incoming",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.93649180624807*^9, 
  3.936491815132268*^9}},ExpressionUUID->"efa4edab-1682-4823-b682-\
9d89a1db6ee6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]", ",", "v", ",", "W"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"declareVectorHead", "[", 
  RowBox[{"{", 
   RowBox[{"p", ",", "pld", ",", "\[Epsilon]", ",", "v"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareTensorHead", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"F", ",", "H", ",", "W", ",", "V"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<rank\>\"", "\[Rule]", " ", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]", ",", "v", ",", "W"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.84986941234763*^9, 3.849869419397002*^9}, {
  3.849870567849285*^9, 3.849870590592388*^9}, {3.849873920169284*^9, 
  3.849873921735065*^9}, {3.849935554482378*^9, 3.849935554779604*^9}, {
  3.8514913447670803`*^9, 3.851491346495552*^9}, {3.8519987975360727`*^9, 
  3.851998798237175*^9}, {3.852265992561047*^9, 3.852265998572448*^9}, {
  3.8526875159826403`*^9, 3.8526875171320972`*^9}, {3.8532319636690273`*^9, 
  3.8532319646047087`*^9}, {3.936433804906311*^9, 3.936433813702405*^9}, {
  3.936433910137753*^9, 3.936433913342781*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"0b95de27-aa10-41ff-8c11-306948bffc6e"],

Cell[CellGroupData[{

Cell[BoxData["\<\"p undeclared as a tensor header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.9364339141503696`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"44a198dc-fd6c-473d-b62a-f00957808d66"],

Cell[BoxData["\<\"p declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.936433914152625*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"2d8032d5-6d8c-4375-8a5c-4edf7415f065"],

Cell[BoxData["\<\"pld undeclared as a tensor header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.9364339141553993`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"85f602a4-1a64-402a-9b08-80dccce93009"],

Cell[BoxData["\<\"pld declared as a 4-dimensional vector header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.936433914157275*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"a767b95b-de16-4f8b-9766-22df0489c890"],

Cell[BoxData["\<\"\[Epsilon] undeclared as a tensor header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.936433914159039*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"3fe2e1d5-19d6-4698-a54a-ddb67d8a6225"],

Cell[BoxData["\<\"\[Epsilon] declared as a 4-dimensional vector \
header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.9364339141607513`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"06230f49-1443-4b00-9fe3-2170eaf1cb14"],

Cell[BoxData["\<\"v undeclared as a tensor header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.9364339141624727`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"52cb5ae4-23b4-4efb-8385-6f1548fc2416"],

Cell[BoxData["\<\"v declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.936433914164156*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"ffba3feb-4fee-43aa-b58a-2bb347dbc9f6"],

Cell[BoxData["\<\"F declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.9364339141658363`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"263aa773-8b9a-4689-85b4-52bfa70bb925"],

Cell[BoxData["\<\"H declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.936433914167527*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"89532f42-b4d5-436f-97b4-d215522436f6"],

Cell[BoxData["\<\"W declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.9364339141691017`*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"ec2df2d8-0500-44a9-b62d-7c69320d9ff5"],

Cell[BoxData["\<\"V declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.863825055538989*^9, 3.863907040137385*^9, 3.864101628218305*^9, 
   3.864362859854875*^9, {3.864366123505486*^9, 3.86436614037685*^9}, 
   3.864474070228355*^9, 3.864875011879442*^9, 3.8666773088751793`*^9, 
   3.8670337671564093`*^9, 3.867034852608376*^9, 3.8670349133672647`*^9, 
   3.8670356195324793`*^9, 3.868169350330546*^9, 3.868169409421844*^9, 
   3.8686073086070766`*^9, 3.93643333858494*^9, 3.936433779319878*^9, 
   3.93643381437473*^9, 3.936433914170656*^9},
 CellLabel->
  "During evaluation of \
In[34]:=",ExpressionUUID->"9e0de6ee-a369-45dd-963c-e436a0e608d4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SubFunctions", "Chapter",
 CellChangeTimes->{{3.854428169619334*^9, 
  3.8544281730372477`*^9}},ExpressionUUID->"6f54012d-343c-4ceb-b753-\
c573c7d67539"],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"51c8b79b-932a-4bdd-86b8-\
9f06849e255f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "nice2", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nice", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"CenterDot", "[", "f", "]"}]}], ",", 
       RowBox[{
        RowBox[{"DOT", "[", 
         RowBox[{"f_", ",", "g_"}], "]"}], "\[RuleDelayed]", "  ", 
        RowBox[{"CenterDot", "[", 
         RowBox[{"f", ",", "g"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"CenterDot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i_", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "j_", "]"}]}], "]"}], ":>", 
        RowBox[{"CenterDot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "j", "]"}], ",", 
          RowBox[{"p", "[", "i", "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i_", "]"}], "]"}], "\[RuleDelayed]", " ", 
        SubscriptBox["\[Epsilon]", "i"]}], ",", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
        SubscriptBox["p", "i"]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"a_", "[", "i_", "]"}], "?", "vectorQ"}], "\[RuleDelayed]", 
        " ", 
        SubscriptBox["a", "i"]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"a_", "[", "i_", "]"}], "?", "tensorQ"}], "\[RuleDelayed]", 
        " ", 
        SubscriptBox["a", "i"]}], ",", 
       RowBox[{"spBracket", "\[Rule]", " ", "Diamond"}], ",", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], "\[RuleDelayed]", " ", 
        OverscriptBox["u", "_"]}], ",", 
       RowBox[{
        RowBox[{"spA", "[", "\[Alpha]", "]"}], "\[RuleDelayed]", "v"}], ",", 
       RowBox[{
        RowBox[{"k", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}], ",", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}], ",", 
       RowBox[{
        RowBox[{"Q", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}], ",", 
       RowBox[{
        RowBox[{"J", "[", 
         RowBox[{"f1_", ",", "f2_", ",", "f3_"}], "]"}], "\[RuleDelayed]", 
        " ", 
        SubscriptBox["J", "f2"]}], ",", 
       RowBox[{
        RowBox[{"J", "[", 
         RowBox[{"f1_", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
        SubscriptBox["J", "f2"]}]}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nice2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"CenterDot", "[", 
       RowBox[{"f_Plus", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", 
       RowBox[{
        RowBox[{"T", "@@", "f"}], ",", "f2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"CenterDot", "[", 
       RowBox[{"f2_", ",", "f_Plus"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"CenterDot", "[", 
       RowBox[{"f2", ",", 
        RowBox[{"T", "@@", "f"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"CircleTimes", "[", 
       RowBox[{"f___", ",", "g_Plus", ",", "f2___"}], "]"}], "\[RuleDelayed]",
       " ", 
      RowBox[{"CircleTimes", "[", 
       RowBox[{"f", ",", 
        RowBox[{"T", "@@", "g"}], ",", "f2"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", 
      RowBox[{"TT", "[", 
       RowBox[{
        RowBox[{"{", "f", "}"}], "/.", 
        RowBox[{
         SubscriptBox["p", "i_"], "\[RuleDelayed]", "i"}]}], "]"}]}], " ", 
     ",", 
     RowBox[{
      RowBox[{"TT", "[", "f_", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["p", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"ToString", "/@", 
          RowBox[{"(", "f", ")"}]}]}], "]"}]]}], ",", 
     RowBox[{
      RowBox[{"s", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
      SubscriptBox["s", 
       RowBox[{"ToExpression", "[", 
        RowBox[{"StringJoin", "@@", 
         RowBox[{"ToString", "/@", 
          RowBox[{"(", "f", ")"}]}]}], "]"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"niceOutPut", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"StyleBox", "[", 
    RowBox[{"f", 
     StyleBox[",",
      FontSize->18], 
     RowBox[{"FontColor", "->", "Red"}], ",", 
     RowBox[{"FontSize", "\[Rule]", "24"}]}], "]"}], "//", 
   "DisplayForm"}]}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, {3.936433935148858*^9, 3.9364339397502403`*^9}},
 CellLabel->
  "In[309]:=",ExpressionUUID->"55360a2d-4dd7-400f-a70c-a61b9360a901"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "repg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repg", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}},
 CellLabel->
  "In[312]:=",ExpressionUUID->"db980e6f-c9eb-40df-82ed-d128a8cd4e6a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotOnshell", "[", "n_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "n", "]"}], ",", "f_"}], "]"}], "\[RuleDelayed]", 
     " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"f_", ",", 
       RowBox[{"p", "[", "n", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", "f"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "0", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", 
        RowBox[{"p", "[", "n", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "0", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "n", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"353b453e-7fe1-4c88-9e64-e211a751f1d3"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "sortS", ",", "zeroMomentum", ",", "onshell", ",", "onshellQCD", ",", 
   "massless"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Sort", "[", 
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeroMomentum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"i_", ",", "n"}], "]"}], "\[RuleDelayed]", 
   RowBox[{"-", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshellQCD", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{
     RowBox[{"n", "-", "2"}], ",", 
     RowBox[{"n", "-", "1"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"s", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"s", "[", 
     RowBox[{
      RowBox[{"n", "-", "2"}], ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massless", "=", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"d39168db-af52-466a-8c1c-3dce7bdae539"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "V2spBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2spBracket", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_", ",", "m_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"spBracket", "[", 
       RowBox[{
        RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"f", "/.", 
         RowBox[{
          RowBox[{"CircleTimes", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
          "g"}]}], ",", 
        RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.849943435749509*^9, 3.8499434443014603`*^9}},
 CellLabel->
  "In[329]:=",ExpressionUUID->"efe94482-f280-4b66-8aa3-fed140d0cead"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->
  "In[333]:=",ExpressionUUID->"df94535a-4cf7-400a-8f0d-bc011efc1341"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->
  "In[336]:=",ExpressionUUID->"e91fa3ea-9348-4961-b522-401ec5557bd8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandFdot", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandFdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"66e83810-5681-4752-bf3a-11426cdcbc6b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFDirect", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "//.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], "]"}]}]}]}]}]}]}], "Input",\

 CellLabel->
  "In[534]:=",ExpressionUUID->"01c993fa-ade8-4950-82a8-f3dc7b951d13"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lt", "=", 
        RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
     RowBox[{"ts", "=", 
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
   "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}},
 CellLabel->
  "In[342]:=",ExpressionUUID->"cc5f4918-d6f8-4850-bf9f-ee49c7cde23b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"4ca1da07-81cb-4631-88a9-f703a50b34d5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->
  "In[346]:=",ExpressionUUID->"4b80cfac-5cc6-4749-b1cb-94688ff33281"]
}, Open  ]],

Cell[CellGroupData[{

Cell["generating the binary products", "Section",
 CellChangeTimes->{{3.764420928752377*^9, 3.7644209329755793`*^9}, {
   3.764421063042801*^9, 3.7644210717599907`*^9}, 
   3.81000614946671*^9},ExpressionUUID->"cfb31aa4-4c33-47e3-9314-\
40b147b11cd7"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Diamond", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a_Plus", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a_", ",", "b_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Plus", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Diamond", "[", 
         RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"c___", ",", "a_Plus", ",", "b___"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Diamond", "[", 
        RowBox[{"c", ",", "#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}]}],
    "//", "Expand"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "a__"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "a__"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "b__"}], "]"}]}], "]"}], ":=", 
  RowBox[{"-", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s_", ",", "a_J"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s_", ",", "a_J"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s_", ",", "b_J"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"a_p", ",", "s_"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"a_p", ",", "s_"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"b_p", ",", "s_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"b___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"a_Diamond", ",", "s_"}], "]"}], ",", "c___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"b", ",", 
     RowBox[{"Times", "[", "a", "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"a_Diamond", ",", "s_"}], "]"}], ",", "b___"}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{
     RowBox[{"Times", "[", "a", "]"}], ",", "b"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Diamond", "[", 
   RowBox[{"a___", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"b_Diamond", ",", "s_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s", " ", 
   RowBox[{"Diamond", "[", 
    RowBox[{"a", ",", 
     RowBox[{"Times", "[", "b", "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.764498254732809*^9, 3.7644982826684504`*^9}, {
   3.764498424685361*^9, 3.764498432738016*^9}, {3.764498644867629*^9, 
   3.7644986464476223`*^9}, 3.764500349115676*^9, 3.764500948381895*^9, 
   3.76450101835398*^9, {3.764501048396812*^9, 3.764501103402779*^9}, {
   3.764501150206197*^9, 3.764501228600431*^9}, {3.764501731449318*^9, 
   3.76450176700736*^9}, {3.764732228905604*^9, 3.764732230068487*^9}, {
   3.7647523563601637`*^9, 3.76475241086663*^9}, {3.764752507803548*^9, 
   3.7647525352498817`*^9}, {3.764752571096532*^9, 3.764752613972445*^9}, {
   3.764752659317862*^9, 3.764752672805139*^9}, {3.76475581625874*^9, 
   3.764755835868349*^9}, {3.764755889665016*^9, 3.764755926290131*^9}, {
   3.76475596241984*^9, 3.764755987507457*^9}, {3.7647561077766314`*^9, 
   3.76475612616606*^9}},
 CellLabel->
  "In[348]:=",ExpressionUUID->"3b026f50-74e8-47ea-9b65-5708cecb4224"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dianum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dianum", "[", "n_", "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"(", 
     RowBox[{"n", "-", "2", "+", "1"}], ")"}]], "*", 
   RowBox[{"Binomial", "[", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{"n", "-", "2"}], ")"}]}], ",", 
     RowBox[{"n", "-", "2"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.766563805462734*^9, 3.766563864708962*^9}},
 CellLabel->
  "In[367]:=",ExpressionUUID->"32678e5b-cacb-4914-871b-e514db6b9001"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandBracket", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandBracket", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{"{", 
     RowBox[{"spBracket", "\[Rule]", " ", "spp"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"spp", "\[Rule]", " ", "spBracket"}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "NumQQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumQQ", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"f", "/.", 
      RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], ",", 
     RowBox[{"Q", "[", "___", "]"}]}], "]"}], "//", 
   "Length"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "NumP", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumP", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "f", "}"}], "/.", 
       RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], "//", "Flatten"}], 
     ",", 
     RowBox[{"k", "[", "___", "]"}]}], "]"}], "//", "Length"}]}]}], "Input",
 CellChangeTimes->{{3.766642548533147*^9, 3.766642548861114*^9}, {
   3.7692226933732433`*^9, 3.769222704412487*^9}, 3.7797791837162247`*^9, {
   3.8499438175750732`*^9, 3.849943819774433*^9}, {3.849943860439536*^9, 
   3.849943862731967*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"9fca1398-c03c-43e4-bd99-054cba98489d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "kPart", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kPart", "[", "f_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"CircleTimes", "@@", 
   RowBox[{"(", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], ",", 
      RowBox[{"k", "[", "___", "]"}]}], "]"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ePart", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ePart", "[", "f_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"CircleTimes", "@@", 
   RowBox[{"(", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], ",", 
      RowBox[{"\[Epsilon]", "[", "___", "]"}]}], "]"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.769222813600417*^9, 3.769222843221794*^9}, {
   3.76922287542558*^9, 3.769222980698477*^9}, 3.769223016208407*^9, {
   3.7692237849385357`*^9, 3.769223876423188*^9}, {3.769223992901539*^9, 
   3.769224056214415*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"4a6d63ba-b190-4097-bc1e-1de1dbdb9712"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[ScriptCapitalF]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"a_Plus", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"#", ",", "b"}], "]"}], "&"}], "/@", "a"}], ")"}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"a_", ",", "b_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"\[ScriptCapitalF]", "[", 
        RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", "b"}], ")"}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{
    RowBox[{"f_", " ", "a_J"}], ",", "b_J"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{
     RowBox[{"f", " ", "a"}], ",", "b"}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", " ", 
     RowBox[{"\[ScriptCapitalF]", "[", " ", 
      RowBox[{"a", ",", "b"}], "]"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", " ", 
   RowBox[{"a_J", ",", 
    RowBox[{"f_", " ", "b_J"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"a", ",", 
     RowBox[{"f", " ", "b"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"f", " ", 
     RowBox[{"\[ScriptCapitalF]", "[", " ", 
      RowBox[{"a", ",", "b"}], "]"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", " ", 
   RowBox[{
    RowBox[{"g_", " ", "a_J"}], ",", 
    RowBox[{"f_", " ", "b_J"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{
     RowBox[{"g", " ", "a"}], ",", 
     RowBox[{"f", " ", "b"}]}], "]"}], "=", 
   RowBox[{
    RowBox[{"g", " ", "f", " ", 
     RowBox[{"\[ScriptCapitalF]", "[", " ", 
      RowBox[{"a", ",", "b"}], "]"}]}], "//", 
    "Expand"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"0", ",", "0"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"0", ",", "f_"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"f_", ",", "0"}], "]"}], ":=", "0"}]}], "Input",
 CellChangeTimes->{{3.8100136081445427`*^9, 3.810013610726534*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"bd2f10cc-2728-43f9-9e29-3ecccadfecad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"(*", 
    RowBox[{"F", ","}], "*)"}], 
   RowBox[{"F0", ",", "FL", ",", "FR"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"\[ScriptCapitalF]", "[", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"J", "[", 
       RowBox[{
        RowBox[{"p", "[", "j", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalF]", "[", 
   RowBox[{"V1_J", ",", "V2_J"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[ScriptCapitalF]", "[", 
    RowBox[{"V1", ",", "V2"}], "]"}], "=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "0"}], "&&", 
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", " ", "0"}]}], ",", 
     RowBox[{"F0", "[", 
      RowBox[{"V1", ",", "V2"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "1"}], "&&", 
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "0"}]}], ",", 
     RowBox[{"FL", "[", 
      RowBox[{"V1", ",", "V2"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "0"}], "&&", " ", 
      RowBox[{
       RowBox[{"NumQQ", "[", 
        RowBox[{"V2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}], "\[Equal]", "1"}]}], ",", 
     RowBox[{"FR", "[", 
      RowBox[{"V1", ",", "V2"}], "]"}], ",", "\[IndentingNewLine]", "True", 
     ",", 
     RowBox[{"0", 
      RowBox[{"Khigher", "[", 
       RowBox[{"V1", ",", "V2"}], "]"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F0", "[", 
   RowBox[{"A_J", ",", "B_J"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Qp", "=", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"Pa", "=", 
       RowBox[{"k", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"Pb", "=", 
       RowBox[{"k", "[", 
        RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ",", 
      RowBox[{"b", "=", 
       RowBox[{
       "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DOT", "[", 
           RowBox[{"b", ",", "Pa"}], "]"}], " ", 
          RowBox[{"J", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", "a"}], "]"}]}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DOT", "[", 
           RowBox[{"a", ",", "Pb"}], "]"}], " ", 
          RowBox[{"J", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", "b"}], "]"}]}], ")"}], "-", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"DOT", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "Pa"}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"DOT", "[", 
          RowBox[{"a", ",", "b"}], "]"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "Pb"}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"a", "\[CircleTimes]", "b", "\[CircleTimes]", "Qp"}]}], 
          "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"J", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{
            "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"b", "\[CircleTimes]", "a", "\[CircleTimes]", "Qp"}]}], 
          "]"}]}]}], ")"}], "/.", 
      RowBox[{"DOT", "\[Rule]", " ", "dot"}]}], "//", "Expand"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FL", "[", 
   RowBox[{"A_J", ",", "B_J"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Qp", "=", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"Pa", "=", 
       RowBox[{"k", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"Pb", "=", 
       RowBox[{"k", "[", 
        RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ",", 
      RowBox[{"b", "=", 
       RowBox[{
       "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "4"]}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pa", ",", "Pa"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "b"}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pa", ",", "Pa"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{
             RowBox[{"a", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "b"}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ")"}], "/.", 
      RowBox[{"DOT", "\[Rule]", " ", "dot"}]}], "//", "Expand"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FR", "[", 
   RowBox[{"A_J", ",", "B_J"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Qp", "=", 
       RowBox[{"Q", "[", 
        RowBox[{
         RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"Pa", "=", 
       RowBox[{"k", "[", 
        RowBox[{"A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"Pb", "=", 
       RowBox[{"k", "[", 
        RowBox[{"B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"A", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      ",", 
      RowBox[{"b", "=", 
       RowBox[{
       "B", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], "}"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         FractionBox["1", "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pb", ",", "Pb"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{"a", ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         FractionBox["1", "4"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DOT", "[", 
            RowBox[{"Pb", ",", "Pb"}], "]"}], " ", 
           RowBox[{"DOT", "[", 
            RowBox[{"a", ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
           RowBox[{"J", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "A", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{
              "B", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", 
             RowBox[{"b", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ")"}], "/.", 
      RowBox[{"DOT", "\[Rule]", " ", "dot"}]}], "//", "Expand"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.810013480381181*^9, {3.849943871802273*^9, 3.849943878768716*^9}, {
   3.851490712233686*^9, 3.85149071634311*^9}},
 CellLabel->
  "In[388]:=",ExpressionUUID->"5c228a1e-30a8-4551-ac44-013adb9fee58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "PG", "]"}], 
  RowBox[{"(*", 
   RowBox[{"defined", " ", "the", " ", "propagator", " ", "function"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_p", ",", "f2_p"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_p", ",", "f2_P"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_P", ",", "f2_p"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f1_P", ",", "f2_P"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "]"}], 
     ",", 
     RowBox[{"P", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
      "]"}]}], "]"}], 
   RowBox[{"P", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f1", "+", "f2"}], ")"}], "/.", 
      RowBox[{
       RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "//", 
     "Expand"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}], ",", "f2_p"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_p", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}], ",", "f2_p"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_p", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}], ",", "f2_P"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_P", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_p"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}], ",", "f2_P"}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f1", ",", "f2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{"f2_P", ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PG", "[", 
   RowBox[{
    RowBox[{"Times", "[", 
     RowBox[{"s2_", ",", "f2_P"}], "]"}], ",", 
    RowBox[{"Times", "[", 
     RowBox[{"s1_", ",", "f1_P"}], "]"}]}], "]"}], ":=", 
  RowBox[{"s1", " ", "s2", " ", 
   RowBox[{"PG", "[", 
    RowBox[{"f2", ",", "f1"}], "]"}]}]}]}], "Input",
 CellLabel->
  "In[394]:=",ExpressionUUID->"835d0c66-9e89-4ea6-beb8-e47124c22ee9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["JQCD", "Section",
 CellChangeTimes->{{3.727085275547757*^9, 3.727085279642453*^9}, {
   3.749130217309951*^9, 3.749130238938786*^9}, 3.749179644362186*^9, {
   3.8499439361591043`*^9, 
   3.8499439375302067`*^9}},ExpressionUUID->"61a905e8-3881-4aee-91b0-\
455fa0d6f63b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "replace", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"replace", "[", 
     RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
       RowBox[{"otherDDMOrder", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"JYM", ",", "JYMFast"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JYM", "[", "gg_List", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "gg", "]"}], "\[Equal]", "1"}], ",", 
    RowBox[{"EJ", "[", 
     RowBox[{"gg", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerVector", ",", "PPVector", ",", "Amp", ",", "bp"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"bp", "=", 
        RowBox[{"BinaryProduct", "[", "gg", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numerVector", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"bp", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "/.", 
                    RowBox[{"i_", "\[RuleDelayed]", " ", 
                    RowBox[{
                    RowBox[{"J", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "i", "]"}], ",", 
                    RowBox[{"\[Epsilon]", "[", 
                    RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}], "/;", 
                    RowBox[{"IntegerQ", "[", "i", "]"}]}]}]}], "/.", 
                    RowBox[{"X", "\[Rule]", " ", "\[ScriptCapitalF]"}]}], "/.",
                     "V2spBracket"}], "/.", 
                   RowBox[{
                    RowBox[{"k", "[", "f_", "]"}], "\[RuleDelayed]", " ", 
                    "f"}]}], "/.", 
                  RowBox[{
                   RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", 
                   "f"}]}], "//", "expandBracket"}], ")"}], "/.", 
               RowBox[{
                RowBox[{"spBracket", "[", 
                 RowBox[{
                  RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "f___", ",", 
                  RowBox[{"Q", "[", "g_", "]"}], ",", 
                  RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], 
                "\[RuleDelayed]", "0"}]}], "//", "expandBracket"}], ")"}], "/.", 
            RowBox[{
             RowBox[{"spBracket", "[", 
              RowBox[{
               RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "f___", ",", 
               RowBox[{"Q", "[", "g_", "]"}], ",", 
               RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], 
             "\[RuleDelayed]", "0"}]}], "//", "Expand"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "@", "bp"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "numerVector", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PPVector", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"bp", "/.", 
               RowBox[{"(", 
                RowBox[{"i_", "\[RuleDelayed]", " ", 
                 RowBox[{
                  RowBox[{"p", "[", "i", "]"}], "/;", 
                  RowBox[{"IntegerQ", "[", "i", "]"}]}]}], ")"}]}], "/.", 
              RowBox[{"X", "\[Rule]", " ", "PG"}]}], "/.", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"P", "[", "f_", "]"}], ",", "f1_"}], "]"}], 
              "\[RuleDelayed]", " ", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"k", "[", "f", "]"}], ",", "f1"}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"f1_", ",", 
               RowBox[{"P", "[", "f_", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
             
             RowBox[{"dot", "[", 
              RowBox[{"f1", ",", 
               RowBox[{"k", "[", "f", "]"}]}], "]"}]}]}], "/.", 
           RowBox[{
            RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "1"}]}], 
          ")"}], "/", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"gg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "gg", "]"}]}], "}"}]}], "]"}], "]"}], 
           ",", 
           RowBox[{"k", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"gg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "gg", "]"}]}], "}"}]}], "]"}], "]"}]}],
           "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"/.", 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"gg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "gg", "]"}]}], "}"}]}], "]"}], "]"}], 
           "\[RuleDelayed]", " ", "1"}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[RuleDelayed]", " ", "1"}]}], 
        "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Amp", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"numerVector", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/", 
               RowBox[{"PPVector", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "@", "PPVector"}]}], "}"}]}], "]"}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"/.", 
               RowBox[{
                RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}],
               "/.", 
              RowBox[{
               RowBox[{"k", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], 
             "*)"}], "/.", 
            RowBox[{
             RowBox[{"spBracket", "[", 
              RowBox[{
               RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "f___", ",", 
               RowBox[{"\[CapitalOmega]", "[", "g_", "]"}], ",", 
               RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], 
             "\[RuleDelayed]", "0"}]}], "//", "expandBracket"}], ")"}], "/.", 
         
         RowBox[{
          RowBox[{"spBracket", "[", 
           RowBox[{
            RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "f_", ",", 
            RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], "\[RuleDelayed]", 
          " ", 
          RowBox[{"dot", "[", 
           RowBox[{"f", ",", "v"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "JYMFast", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JYMFast", "[", "gg_List", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "gg", "]"}], "\[Equal]", "1"}], ",", 
    RowBox[{"EJ", "[", 
     RowBox[{"gg", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerVector", ",", "PPVector", ",", "Amp", ",", "bp"}], "}"}],
       ",", 
      RowBox[{
       RowBox[{"bp", "=", 
        RowBox[{"BinaryProduct", "[", "gg", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numerVector", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"bp", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], "/.", 
              RowBox[{"i_", "\[RuleDelayed]", " ", 
               RowBox[{
                RowBox[{"J", "[", 
                 RowBox[{
                  RowBox[{"p", "[", "i", "]"}], ",", 
                  RowBox[{"\[Epsilon]", "[", 
                   RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}], "/;", 
                RowBox[{"IntegerQ", "[", "i", "]"}]}]}]}], "/.", 
             RowBox[{"X", "\[Rule]", " ", "\[ScriptCapitalF]"}]}], "/.", 
            "V2spBracket"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"spBracket", "[", 
               RowBox[{
                RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "f_", ",", 
                RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], 
              "\[RuleDelayed]", " ", 
              RowBox[{"dot", "[", 
               RowBox[{"f", ",", "v"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"spBracket", "[", 
               RowBox[{
                RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "f___", ",", 
                RowBox[{"Q", "[", "g_", "]"}], ",", 
                RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], 
              "\[RuleDelayed]", "0"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", 
            RowBox[{"Length", "@", "bp"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "numerVector", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"PPVector", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"bp", "[", 
                  RowBox[{"[", "kk", "]"}], "]"}], "/.", 
                 RowBox[{"(", 
                  RowBox[{"i_", "\[RuleDelayed]", " ", 
                   RowBox[{
                    RowBox[{"p", "[", "i", "]"}], "/;", 
                    RowBox[{"IntegerQ", "[", "i", "]"}]}]}], ")"}]}], "/.", 
                RowBox[{"X", "\[Rule]", " ", "PG"}]}], "/.", 
               RowBox[{
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"P", "[", "f_", "]"}], ",", "f1_"}], "]"}], 
                "\[RuleDelayed]", " ", 
                RowBox[{"dot", "[", 
                 RowBox[{
                  RowBox[{"k", "[", "f", "]"}], ",", "f1"}], "]"}]}]}], "/.", 
              
              RowBox[{
               RowBox[{"dot", "[", 
                RowBox[{"f1_", ",", 
                 RowBox[{"P", "[", "f_", "]"}]}], "]"}], "\[RuleDelayed]", 
               " ", 
               RowBox[{"dot", "[", 
                RowBox[{"f1", ",", 
                 RowBox[{"k", "[", "f", "]"}]}], "]"}]}]}], "/.", 
             RowBox[{
              RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "1"}]}], 
            ")"}], "/", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"k", "[", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"gg", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "gg", "]"}]}], "}"}]}], "]"}], "]"}],
              ",", 
             RowBox[{"k", "[", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"gg", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"Length", "[", "gg", "]"}]}], "}"}]}], "]"}], 
              "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"kk", ",", 
            RowBox[{"Length", "@", "bp"}]}], "}"}]}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"/.", 
          RowBox[{
           RowBox[{"P", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"gg", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "gg", "]"}]}], "}"}]}], "]"}], "]"}], 
           "\[RuleDelayed]", " ", "1"}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"1", ",", "1"}], "]"}], "\[RuleDelayed]", " ", "1"}]}], 
        "*)"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Amp", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"numerVector", "[", 
            RowBox[{"[", "jj", "]"}], "]"}], "/", 
           RowBox[{"PPVector", "[", 
            RowBox[{"[", "jj", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"jj", ",", 
            RowBox[{"Length", "@", "PPVector"}]}], "}"}]}], "]"}]}]}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"/.", 
        RowBox[{
         RowBox[{"P", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "/.", 
       
       RowBox[{
        RowBox[{"k", "[", "f_", "]"}], "\[RuleDelayed]", " ", "f"}]}], "*)"}],
      "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"FP", ",", "EJ", ",", "BP"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FP", "[", 
   RowBox[{"f_List", ",", "vv_"}], "]"}], ":=", 
  FractionBox["1", 
   RowBox[{"2", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "@@", "f"}], ")"}], ",", "vv"}], 
     "]"}]}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BP", "[", "f_List", "]"}], ":=", 
  FractionBox["1", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "/@", "f"}], ")"}], "//", "Total"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "/@", "f"}], ")"}], "//", "Total"}]}], 
    "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EJ", "[", 
   RowBox[{"i_", "/;", 
    RowBox[{"IntegerQ", "[", "i", "]"}]}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", 
     RowBox[{"p", "[", "i", "]"}], "]"}], ",", "v"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.767513288354941*^9, 3.767513321607121*^9}, {
   3.7675136232372313`*^9, 3.767513637724576*^9}, {3.767513668163639*^9, 
   3.767513682011446*^9}, {3.767513730352708*^9, 3.767513761126479*^9}, {
   3.767515953741918*^9, 3.767516034297084*^9}, {3.767516100987088*^9, 
   3.767516105938249*^9}, 3.767516170187014*^9, {3.767516604586947*^9, 
   3.76751667579123*^9}, {3.76751670766059*^9, 3.767516758628324*^9}, {
   3.767516796317315*^9, 3.7675168073656263`*^9}, {3.767516850328354*^9, 
   3.767516857909975*^9}, {3.7675169705934753`*^9, 3.767517023699308*^9}, {
   3.7676570068457317`*^9, 3.767657027484312*^9}, {3.7676618464351397`*^9, 
   3.767661847447671*^9}, {3.777815270753941*^9, 3.7778152713266373`*^9}, {
   3.784444826251099*^9, 3.7844448271434593`*^9}, {3.784444862797866*^9, 
   3.784444863163842*^9}, {3.7844460218837547`*^9, 3.784446049039831*^9}, {
   3.784447711767681*^9, 3.7844478494552*^9}, {3.813208054737514*^9, 
   3.813208064718638*^9}, {3.8132084329480124`*^9, 3.813208473722816*^9}, {
   3.813634092011067*^9, 3.813634097380372*^9}, 3.817555421900948*^9, 
   3.817555455359584*^9, {3.839565438883327*^9, 3.839565439373126*^9}, 
   3.840322529220057*^9, {3.849943954899047*^9, 3.849943956796442*^9}, {
   3.849957595153757*^9, 3.849957598649881*^9}, 3.849957755052649*^9, {
   3.8499586247269287`*^9, 3.84995862899298*^9}, {3.849958819131783*^9, 
   3.84995882585406*^9}, {3.85002170121329*^9, 3.850021715874568*^9}, {
   3.850093260096649*^9, 3.850093261406396*^9}, 3.8510452273407583`*^9, 
   3.851045665348428*^9, {3.864366590781118*^9, 3.864366610948011*^9}, {
   3.864446414315947*^9, 3.8644464273717527`*^9}, 3.864446515176392*^9, {
   3.8644468858894787`*^9, 3.864446958127193*^9}, {3.8645687996092253`*^9, 
   3.864568842666603*^9}, {3.864568879223921*^9, 3.864568910274102*^9}, {
   3.864577119990458*^9, 3.864577136426235*^9}, {3.9364340623159*^9, 
   3.9364340837573843`*^9}, {3.936487407750098*^9, 
   3.9364874452714357`*^9}},ExpressionUUID->"3923b89b-3ed2-4b50-8e4d-\
4031fe113774"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "HEFTAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HEFTAmp", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"T", "@@@", 
       RowBox[{"partitionOd", "[", 
        RowBox[{"Range", "[", "n", "]"}], "]"}]}], ")"}], "//.", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"f1__", ",", "f2_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"T", "[", "f1", "]"}], 
       RowBox[{"T", "[", "f2", "]"}], 
       RowBox[{"FP", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "f1", "}"}], "//", "Flatten"}], ",", "v"}], 
        "]"}]}]}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", "f_", "]"}], ":>", 
     RowBox[{"JQCD", "[", "f", "]"}]}]}], "//", 
   "Total"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TwoScalarAmp", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"JYMFast", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"\[Epsilon]", "[", 
          RowBox[{"p", "[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"p", "[", "i_", "]"}], ":>", 
      RowBox[{"p", "[", 
       RowBox[{"i", "-", "1"}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"k", "[", "f_", "]"}], ":>", "f"}]}], " ", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i_", "]"}], ",", 
      RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}]}]}], "Input",
 CellChangeTimes->{{3.864432882182376*^9, 3.8644329062673597`*^9}, {
   3.864432968026218*^9, 3.8644329861020393`*^9}, {3.86443302230851*^9, 
   3.864433029589757*^9}, 3.864446346629014*^9, {3.864446997321069*^9, 
   3.864447059238318*^9}, {3.864447104707467*^9, 3.864447112749044*^9}, {
   3.864447154722494*^9, 3.8644471549662952`*^9}, {3.8644473118351*^9, 
   3.8644473609610157`*^9}, {3.864447393533472*^9, 3.8644473945374613`*^9}, {
   3.8644474842592793`*^9, 3.8644474937199497`*^9}, {3.864447535321569*^9, 
   3.864447565436989*^9}, {3.864447690072599*^9, 3.864447704461851*^9}, {
   3.864569812763233*^9, 3.8645698144082823`*^9}},
 CellLabel->
  "In[419]:=",ExpressionUUID->"221227f1-430b-47c7-890b-013f834d9af6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Jh", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jh", "[", 
   RowBox[{"f_List", ",", "vv_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len", "=", 
         RowBox[{"Length", "[", "f", "]"}]}], "}"}], ",", 
       RowBox[{"JQCD", "[", 
        RowBox[{"Range", "[", "len", "]"}], "]"}]}], "]"}], "/.", 
     RowBox[{"v", "\[Rule]", " ", "vv"}]}], "/.", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"p", "[", "i_", "]"}], "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", "i_", "]"}], "\[RuleDelayed]", " ", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}]}], "Input",
 CellLabel->
  "In[422]:=",ExpressionUUID->"fa1308b3-ffd8-4afa-8caf-a5fb9dfe4c25"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TwoScalarAmp", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.93643410208121*^9, 3.936434112267535*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"29b4e093-3829-44fa-977b-9ea7842b8619"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "1", "]"}], "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "1", "]"}], "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "0", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}]}], ")"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "1", "]"}], "]"}]}], "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]], "-", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"p", "[", "1", "]"}], "]"}], ",", 
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "1", "]"}], "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "0", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "1", "]"}], "]"}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "2", "]"}], "]"}]}], "]"}]}], 
   RowBox[{"4", " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}]}]]}]], "Output",
 CellChangeTimes->{{3.936434104585766*^9, 3.936434112789947*^9}},
 CellLabel->
  "Out[425]=",ExpressionUUID->"010f3650-9539-471e-8c67-288010cec95c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["SipnBracket", "Section",
 CellChangeTimes->{{3.727085630867755*^9, 3.72708563371425*^9}, {
  3.8100063581494093`*^9, 3.81000637181561*^9}, {3.810011867675029*^9, 
  3.810011868288075*^9}},ExpressionUUID->"a9bf22d1-21a7-4eaf-a108-\
c59191ea6b02"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "moveLeft", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"moveLeft", "[", "order_List", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", "\[Alpha]", ",", 
        RowBox[{"p", "[", "j_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      
      RowBox[{
       RowBox[{"-", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", 
          RowBox[{"p", "[", "j", "]"}], ",", "\[Alpha]", ",", "b"}], "]"}]}], 
       "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], " ", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", "\[Alpha]", ",", "\[Beta]", ",", "b__"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "\[Beta]", ",", "\[Alpha]", ",", "b"}], "]"}]}], 
       "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"p", "[", "0", "]"}]}], "]"}], " ", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", "\[Alpha]", ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i_", "]"}], "]"}], ",", "b__"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "i", "]"}], "]"}], ",", "\[Alpha]", ",", "b"}], 
         "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{"\[Alpha]", ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}], " ", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"p", "[", "j_", "]"}], ",", "\[Beta]", ",", "b__"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "\[Beta]", ",", 
          RowBox[{"p", "[", "j", "]"}], ",", "b"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "0", "]"}], ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], " ", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i_", "]"}], "]"}], ",", "\[Beta]", ",", "b__"}], 
       "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "\[Beta]", ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "i", "]"}], "]"}], ",", "b"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "0", "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}], " ", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"p", "[", "j_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i_", "]"}], "]"}], ",", "b__"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "i", "]"}], "]"}], ",", 
          RowBox[{"p", "[", "j", "]"}], ",", "b"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"p", "[", "i", "]"}], "]"}], ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], " ", 
        RowBox[{"spBracket", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "j_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"spBracket", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "j", "]"}], ",", 
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"p", "[", "j", "]"}]}], "]"}], " ", 
         RowBox[{"spBracket", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"order", ",", "i"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ">", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"order", ",", "j"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spBracket", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", 
         RowBox[{"p", "[", "j_", "]"}], "]"}], ",", "b__"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"spBracket", "[", 
          RowBox[{"a", ",", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"p", "[", "j", "]"}], "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"p", "[", "i", "]"}], "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"p", "[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"p", "[", "j", "]"}], "]"}]}], "]"}], " ", 
         RowBox[{"spBracket", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}]}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"order", ",", "i"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ">", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"order", ",", "j"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}]}]}], 
    "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "normalOrder", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalOrder", "[", 
   RowBox[{"primitive_", ",", "gauge_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"normalOrder", "[", 
    RowBox[{"primitive", ",", "gauge"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"testresult1", ",", "check"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testresult1", "=", 
       RowBox[{"primitive", "//.", 
        RowBox[{"moveLeft", "[", "gauge", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "testresult1", "]"}]}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.718448986650378*^9, 3.718448990832869*^9}, {
   3.718449074805184*^9, 3.718449081819468*^9}, {3.718449171183996*^9, 
   3.718449173277906*^9}, {3.72141168957666*^9, 3.72141169079181*^9}, {
   3.722248013093299*^9, 3.722248017292691*^9}, {3.722248054605105*^9, 
   3.722248077236574*^9}, {3.727157484618753*^9, 3.727157485743351*^9}, {
   3.727157529484777*^9, 3.7271575925639277`*^9}, {3.727157662755822*^9, 
   3.7271577407704906`*^9}, 3.727157865516198*^9, {3.7271579254270973`*^9, 
   3.727157957770762*^9}, {3.727157993035246*^9, 3.727158018473748*^9}, {
   3.727158337281262*^9, 3.727158345796178*^9}, {3.7271633223101377`*^9, 
   3.727163324772565*^9}, {3.7275273648581343`*^9, 3.7275273651874113`*^9}, {
   3.727527398299981*^9, 3.7275274134180803`*^9}, 3.756962174004731*^9, 
   3.756962214055044*^9, 3.756966251470415*^9, {3.756966287871245*^9, 
   3.756966321913574*^9}, 3.75696644624335*^9, 3.756966491095038*^9, {
   3.75696653833174*^9, 3.756966538933036*^9}, 3.756966652955621*^9, 
   3.756966746010159*^9, {3.756966949974287*^9, 3.7569669505271387`*^9}, {
   3.757146176469371*^9, 3.7571462121783867`*^9}, {3.757146499574304*^9, 
   3.757146512451357*^9}, 3.75904920521968*^9, {3.810004725068688*^9, 
   3.8100047441216993`*^9}, 3.813559815459648*^9, {3.813559878064206*^9, 
   3.813559899335644*^9}, {3.813560967225049*^9, 3.813560989401289*^9}, {
   3.813561020370647*^9, 3.8135610320541*^9}, {3.81356487094914*^9, 
   3.8135648906508913`*^9}, {3.813566513898582*^9, 3.813566525342051*^9}, {
   3.813566561947486*^9, 3.813566580593059*^9}, {3.813642979894417*^9, 
   3.813643008143165*^9}, 3.81364321571*^9, {3.850093200847307*^9, 
   3.850093205052359*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"8a9b8649-a2fe-48ee-b5ad-1f76156372d0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"newsp", ",", "expandBracket2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newsp", "[", "f_List", "]"}], ":=", 
   RowBox[{
    RowBox[{"sp", "@@", "f"}], "/.", 
    RowBox[{"sp", "\[Rule]", " ", "spBracket"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"expandBracket", "[", "f_", "]"}], ":=", 
    RowBox[{
     RowBox[{"f", "/.", 
      RowBox[{"{", 
       RowBox[{"spBracket", "\[Rule]", " ", "sp"}], "}"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"sp", "\[Rule]", " ", "spBracket"}], "}"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandBracket2", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"f", "/.", 
            RowBox[{"{", 
             RowBox[{"spBracket", "\[Rule]", " ", "sp"}], "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"sp", "\[Rule]", " ", "spBracket"}], "}"}]}], "/.", 
          RowBox[{"spinOnshell", "[", "n", "]"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"spBracket", "\[Rule]", " ", "sp"}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"sp", "\[Rule]", " ", "spBracket"}], "}"}]}], "//", 
       RowBox[{
        RowBox[{"normalOrder", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Range", "[", "n", "]"}]}], "]"}], "&"}]}], ")"}], "/.", 
     RowBox[{"spinOnshell", "[", "n", "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"spBracket", "\[Rule]", " ", "sp"}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{"sp", "\[Rule]", " ", "spBracket"}], 
    "}"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.727159740048994*^9, 3.7271598099773283`*^9}, {
   3.72716005879532*^9, 3.72716007780938*^9}, {3.7271630814667377`*^9, 
   3.727163201137512*^9}, 3.727163260797287*^9, {3.745272462854084*^9, 
   3.745272466725925*^9}, {3.780298587062475*^9, 3.780298613343061*^9}, {
   3.7802986537975807`*^9, 3.780298657576638*^9}, {3.7802989028292522`*^9, 
   3.780298915384096*^9}, {3.780298986923522*^9, 3.780298994189425*^9}, {
   3.780299071951756*^9, 3.780299097904861*^9}, 3.780299347983159*^9, {
   3.813566599750956*^9, 3.8135666320955753`*^9}, {3.813566899841146*^9, 
   3.813566914483301*^9}, {3.851045577945937*^9, 3.8510455825956497`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"e948af1c-6b3e-4bb9-b303-2b407544f379"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "AntiSym", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AntiSym", "[", "AA_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", "=", 
      RowBox[{"AA", "/.", 
       RowBox[{"List", "\[Rule]", " ", "T"}]}]}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", "A"}], "\[Equal]", "1"}], ",", "0", ",", 
      RowBox[{
       RowBox[{"Signature", "@", 
        RowBox[{
         RowBox[{"Permutations", "[", "A", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Signature", "/@", 
          RowBox[{"Permutations", "[", "A", "]"}]}], 
         RowBox[{"Permutations", "[", "A", "]"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]}], "Input",
 CellLabel->
  "In[179]:=",ExpressionUUID->"834b84c1-8e13-47c9-9261-faa123d0cd75"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "signNormalOrderG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"signNormalOrderG", "[", "li_", "]"}], ":=", 
  RowBox[{
   RowBox[{"spBracket", "[", 
    RowBox[{
     RowBox[{"spB", "[", "\[Beta]", "]"}], ",", "fp___", ",", 
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"p", "[", "1", "]"}], "]"}], ",", "fe___", ",", 
     RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}], "\[RuleDelayed]", 
   RowBox[{
    RowBox[{"Signature", "[", 
     RowBox[{"{", "fp", "}"}], "]"}], 
    RowBox[{"Signature", "[", 
     RowBox[{"{", "fe", "}"}], "]"}], " ", 
    RowBox[{"spBracket", "[", 
     RowBox[{
      RowBox[{"spB", "[", "\[Beta]", "]"}], ",", 
      RowBox[{
       RowBox[{"sortP", "[", 
        RowBox[{
         RowBox[{"{", "fp", "}"}], ",", 
         RowBox[{"{", "li", "}"}]}], "]"}], "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"{", "g___", "}"}], "\[RuleDelayed]", "g"}]}], ",", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"p", "[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"sortE", "[", 
        RowBox[{
         RowBox[{"{", "fe", "}"}], ",", 
         RowBox[{"{", "li", "}"}]}], "]"}], "/.", "\[VeryThinSpace]", 
       RowBox[{
        RowBox[{"{", "g___", "}"}], "\[RuleDelayed]", "g"}]}], ",", 
      RowBox[{"spA", "[", "\[Alpha]", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.752395834406448*^9, 3.752395853393408*^9}, {
  3.752396060043315*^9, 3.7523960627795887`*^9}, {3.752396189069179*^9, 
  3.7523962347935543`*^9}, {3.752396431264484*^9, 3.752396517374745*^9}, {
  3.7523970076391077`*^9, 3.752397037147374*^9}, {3.752397091455261*^9, 
  3.752397103589672*^9}, {3.757134006436254*^9, 3.7571340228917828`*^9}, {
  3.810006338279702*^9, 3.810006343041213*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"09d15103-7519-47ad-99bb-a4d7a28a7d0e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctionsClosedForm", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 3.810011824102497*^9}, 
   3.843431128166585*^9},ExpressionUUID->"51c8b79b-932a-4bdd-86b8-\
9f06849e255f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"KLTR", ",", "KLTRM"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KLTR", "[", "f_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"KLTR", "[", "f", "]"}], "=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], ">", "2"}], ",", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"imax", "=", 
          RowBox[{"Max", "[", "f", "]"}]}], ",", "idmax", ",", "fr", ",", 
         "fl"}], "}"}], ",", 
       RowBox[{
        RowBox[{"idmax", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"f", ",", "imax"}], "]"}], "//", "Flatten"}]}], ";", 
        RowBox[{"fr", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"f", ",", "idmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fl", "=", 
         RowBox[{"f", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"idmax", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ")"}]}], "]"}], 
          "]"}]}], ";", 
        RowBox[{"2", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "imax", "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "/@", "fl"}], ")"}], "//", "Total"}]}], "]"}], 
         RowBox[{"KLTR", "[", "fr", "]"}]}]}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], "\[Equal]", "2"}], ",", 
     RowBox[{"2", 
      RowBox[{"dot", "@@", 
       RowBox[{"(", 
        RowBox[{"p", "/@", "f"}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], "<", "2"}], ",", 
     RowBox[{
     "Print", "[", "\"\<Length of f should be large than 2\>\"", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KLTRM", "[", "n_", "]"}], ":=", 
  RowBox[{"KLTR", "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Drop", "[", 
       RowBox[{"#", ",", 
        RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
     RowBox[{"ddmBasis", "[", 
      RowBox[{"Range", "[", "n", "]"}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.839994425791482*^9, 3.83999443747307*^9}, {
  3.839994485137151*^9, 3.839994514837348*^9}, {3.839994592103528*^9, 
  3.8399945934682093`*^9}, {3.839994660012353*^9, 3.8399947892205067`*^9}, {
  3.8399948213233433`*^9, 3.839994858056067*^9}, {3.83999500626001*^9, 
  3.839995236474574*^9}, {3.839995334589308*^9, 3.839995449737526*^9}, {
  3.839995499077149*^9, 3.8399955037773733`*^9}, {3.8399955341042213`*^9, 
  3.839995606584497*^9}, {3.839995833962657*^9, 3.839995884233406*^9}, {
  3.8399959914105997`*^9, 3.8399960379865093`*^9}, {3.8399964204765368`*^9, 
  3.839996422705614*^9}, {3.8426128199710913`*^9, 3.8426128352353563`*^9}, {
  3.8499355175006638`*^9, 3.8499355207004642`*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"ea70f9c9-d4d2-46fe-9ada-2ec969aca9f4"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"KLTR\\\"}]\\) is Protected.\"", 2, 183, 43, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925801955*^9},
 CellLabel->
  "During evaluation of \
In[183]:=",ExpressionUUID->"00575d6a-df6e-47b5-81aa-7b8585bc3ed8"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"KLTRM\\\"}]\\) is Protected.\"", 2, 183, 44,
    33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925803051*^9},
 CellLabel->
  "During evaluation of \
In[183]:=",ExpressionUUID->"7b20b93d-6624-41d2-863a-c9dd0aff25ac"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"KLTR\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"KLTR\\\", \\\"[\\\", \\\"f_List\\\", \\\"]\\\"}]\\) is \
Protected.\"", 2, 184, 45, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925807849*^9},
 CellLabel->
  "During evaluation of \
In[183]:=",ExpressionUUID->"8ca1248d-b4b1-44c3-8569-da98975b1fff"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433925812244*^9},
 CellLabel->
  "Out[184]=",ExpressionUUID->"2974b22e-fa71-4f13-a675-e5ff78183f17"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"KLTRM\\\"}]\\) in \\!\\(\\*RowBox[{\\\"KLTRM\\\
\", \\\"[\\\", \\\"n_\\\", \\\"]\\\"}]\\) is Protected.\"", 2, 185, 46, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925813307*^9},
 CellLabel->
  "During evaluation of \
In[183]:=",ExpressionUUID->"7fffb705-68cb-4819-8821-2a654bb1aa61"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339258173122`*^9},
 CellLabel->
  "Out[185]=",ExpressionUUID->"bdbabdf8-f62b-4b94-a1df-cc8fcf7e68c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"niceT", ",", "niceET"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"niceT", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["T", "f"], "/.", "\[VeryThinSpace]", 
       RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
     RowBox[{"\"\<(\>\"", "<>", 
      RowBox[{"ToString", "/@", 
       RowBox[{"{", "f1", "}"}]}], "<>", "\"\<)\>\""}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"niceET", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i_", "]"}], ":>", 
     SuperscriptBox["t", 
      SubscriptBox["a", "i"]]}], ",", 
    RowBox[{
     RowBox[{"GT", "[", 
      RowBox[{
       RowBox[{"{", "f1___", "}"}], ",", 
       RowBox[{"{", "f2___", "}"}]}], "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        SubscriptBox["T", "f2"], 
        RowBox[{"\"\<(\>\"", "<>", 
         RowBox[{"ToString", "/@", 
          RowBox[{"{", "f1", "}"}]}], "<>", "\"\<)\>\""}]], "/.", 
       "\[VeryThinSpace]", 
       RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
     RowBox[{"\"\<(\>\"", "<>", 
      RowBox[{"ToString", "/@", 
       RowBox[{"{", "f1", "}"}]}], "<>", "\"\<)\>\""}]}], ",", 
    RowBox[{
     RowBox[{"ET", "[", 
      RowBox[{"f1_GT", ",", 
       RowBox[{"{", "f2__", "}"}]}], "]"}], "\[RuleDelayed]", 
     RowBox[{"f1", " ", 
      RowBox[{"tr", "[", 
       RowBox[{"CenterDot", "[", "f2", "]"}], "]"}]}]}]}], "}"}]}]}], "Input",\

 CellChangeTimes->{{3.839469631115183*^9, 3.839469674309537*^9}, {
   3.83956757300841*^9, 3.8395676630792627`*^9}, {3.843126203886073*^9, 
   3.843126224264575*^9}, {3.8499356053075113`*^9, 3.849935627081663*^9}, {
   3.856345045663068*^9, 3.856345048979126*^9}, 3.8563451629641123`*^9, {
   3.867049509541975*^9, 3.8670495351066103`*^9}, {3.8670495682947493`*^9, 
   3.8670495691789017`*^9}, {3.867049664187765*^9, 3.867049709467833*^9}, {
   3.867049751993469*^9, 3.867049752348894*^9}, {3.867049795436908*^9, 
   3.8670498276623898`*^9}, {3.8670504783485203`*^9, 
   3.8670504880616617`*^9}, {3.867050521367712*^9, 3.867050564213861*^9}, {
   3.867050739491564*^9, 3.867050750776265*^9}, 3.867050791473817*^9, {
   3.867050918501417*^9, 3.8670509818995457`*^9}, {3.8670510505459414`*^9, 
   3.86705107091497*^9}, {3.867051113274519*^9, 3.867051160579288*^9}, {
   3.867051196903377*^9, 3.8670512042467947`*^9}, {3.867051277745961*^9, 
   3.867051278233429*^9}, {3.8670513693112087`*^9, 3.867051377269781*^9}, {
   3.867051488371662*^9, 3.867051505313662*^9}, {3.867051579618641*^9, 
   3.867051609457695*^9}, {3.867051776206088*^9, 3.867051780070037*^9}, {
   3.867052229561306*^9, 3.867052251248715*^9}, {3.867052488680396*^9, 
   3.8670525105530787`*^9}, {3.867110221252329*^9, 3.86711022962354*^9}, {
   3.867110289423637*^9, 3.867110293704104*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"84d91cb8-e100-4f54-82fe-9f221285ab55"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"niceT\\\"}]\\) is Protected.\"", 2, 186, 47,
    33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925829278*^9},
 CellLabel->
  "During evaluation of \
In[186]:=",ExpressionUUID->"b36478be-2c30-41a1-aac9-fe5eb9115cfc"],

Cell[BoxData[
 TemplateBox[{
  "Set", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"niceT\\\"}]\\) is Protected.\"", 2, 187, 48,
    33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339258302717`*^9},
 CellLabel->
  "During evaluation of \
In[186]:=",ExpressionUUID->"edaca104-d616-4c2e-a612-c928f897dfad"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["T", "f"], "/.", "\[VeryThinSpace]", 
      RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
    RowBox[{"\<\"(\"\>", "<>", 
     RowBox[{"ToString", "/@", 
      RowBox[{"{", "f1", "}"}]}], "<>", "\<\")\"\>"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.839548619664312*^9, 3.8395675743138103`*^9, 3.839567663984125*^9, 
   3.840320641685912*^9, 3.840855735495926*^9, 3.840924431396873*^9, 
   3.841104931024561*^9, 3.842519185268689*^9, 3.842612865371006*^9, 
   3.84312622512184*^9, 3.843431364833078*^9, 3.8465642942147417`*^9, 
   3.847499020831465*^9, 3.849068096519346*^9, {3.84993453882728*^9, 
   3.849934564595379*^9}, 3.851044648504219*^9, 3.851045622652813*^9, 
   3.851339087658826*^9, 3.8514905452282047`*^9, 3.851490784841222*^9, 
   3.851748984274619*^9, 3.8518316283629513`*^9, 3.851849408030963*^9, 
   3.8518569773477907`*^9, 3.851992647512147*^9, 3.852079752067829*^9, 
   3.852205233188251*^9, 3.853201945924086*^9, 3.8533718881849527`*^9, 
   3.853476916960648*^9, 3.854165632530545*^9, 3.854428229326764*^9, 
   3.854428455513752*^9, 3.8545848107355747`*^9, 3.8547768413310957`*^9, 
   3.855028265165945*^9, 3.855293118170321*^9, 3.8556415851892767`*^9, 
   3.855665357942355*^9, 3.855723457246786*^9, 3.856316738227253*^9, 
   3.8563193342551117`*^9, 3.856345057670064*^9, 3.8563451227869596`*^9, 
   3.856345163933029*^9, 3.856397730446745*^9, 3.863825060869616*^9, 
   3.8639070512476263`*^9, 3.864101636503916*^9, 3.864362867277647*^9, 
   3.86436614713616*^9, 3.864474097706633*^9, 3.86487510173453*^9, 
   3.866677314608758*^9, 3.8670337709662724`*^9, 3.867034861844171*^9, {
   3.867035598553287*^9, 3.8670356251321087`*^9}, 3.867050504881651*^9, {
   3.8670505497241163`*^9, 3.867050566629754*^9}, 3.8670506646628113`*^9, 
   3.867050751543448*^9, 3.8670507938304043`*^9, {3.8670511489427223`*^9, 
   3.867051161164236*^9}, 3.8670512052320013`*^9, 3.867051282880905*^9, 
   3.867051378220948*^9, {3.8670514897988234`*^9, 3.867051506082806*^9}, {
   3.8670516103097963`*^9, 3.867051623397407*^9}, 3.867052252394486*^9, 
   3.867052514447427*^9, 3.867110234340056*^9, 3.867110331471683*^9, 
   3.868169388005954*^9, 3.868169430498211*^9, 3.868607314800735*^9, 
   3.936433925834573*^9},
 CellLabel->
  "Out[187]=",ExpressionUUID->"c79c1561-3daf-4a0b-812b-92d38426190e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "i_", "]"}], "\[RuleDelayed]", 
    SuperscriptBox["t", 
     SubscriptBox["a", "i"]]}], ",", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", "f1___", "}"}], ",", 
      RowBox[{"{", "f2___", "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      SubsuperscriptBox["T", "f2", 
       RowBox[{"\<\"(\"\>", "<>", 
        RowBox[{"ToString", "/@", 
         RowBox[{"{", "f1", "}"}]}], "<>", "\<\")\"\>"}]], "/.", 
      "\[VeryThinSpace]", 
      RowBox[{"List", "\[Rule]", "L"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"L", "[", "f1___", "]"}], "\[RuleDelayed]", 
    RowBox[{"\<\"(\"\>", "<>", 
     RowBox[{"ToString", "/@", 
      RowBox[{"{", "f1", "}"}]}], "<>", "\<\")\"\>"}]}], ",", 
   RowBox[{
    RowBox[{"ET", "[", 
     RowBox[{"f1_GT", ",", 
      RowBox[{"{", "f2__", "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"f1", " ", 
     RowBox[{"tr", "[", 
      RowBox[{"CenterDot", "[", "f2", "]"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.839548619664312*^9, 3.8395675743138103`*^9, 3.839567663984125*^9, 
   3.840320641685912*^9, 3.840855735495926*^9, 3.840924431396873*^9, 
   3.841104931024561*^9, 3.842519185268689*^9, 3.842612865371006*^9, 
   3.84312622512184*^9, 3.843431364833078*^9, 3.8465642942147417`*^9, 
   3.847499020831465*^9, 3.849068096519346*^9, {3.84993453882728*^9, 
   3.849934564595379*^9}, 3.851044648504219*^9, 3.851045622652813*^9, 
   3.851339087658826*^9, 3.8514905452282047`*^9, 3.851490784841222*^9, 
   3.851748984274619*^9, 3.8518316283629513`*^9, 3.851849408030963*^9, 
   3.8518569773477907`*^9, 3.851992647512147*^9, 3.852079752067829*^9, 
   3.852205233188251*^9, 3.853201945924086*^9, 3.8533718881849527`*^9, 
   3.853476916960648*^9, 3.854165632530545*^9, 3.854428229326764*^9, 
   3.854428455513752*^9, 3.8545848107355747`*^9, 3.8547768413310957`*^9, 
   3.855028265165945*^9, 3.855293118170321*^9, 3.8556415851892767`*^9, 
   3.855665357942355*^9, 3.855723457246786*^9, 3.856316738227253*^9, 
   3.8563193342551117`*^9, 3.856345057670064*^9, 3.8563451227869596`*^9, 
   3.856345163933029*^9, 3.856397730446745*^9, 3.863825060869616*^9, 
   3.8639070512476263`*^9, 3.864101636503916*^9, 3.864362867277647*^9, 
   3.86436614713616*^9, 3.864474097706633*^9, 3.86487510173453*^9, 
   3.866677314608758*^9, 3.8670337709662724`*^9, 3.867034861844171*^9, {
   3.867035598553287*^9, 3.8670356251321087`*^9}, 3.867050504881651*^9, {
   3.8670505497241163`*^9, 3.867050566629754*^9}, 3.8670506646628113`*^9, 
   3.867050751543448*^9, 3.8670507938304043`*^9, {3.8670511489427223`*^9, 
   3.867051161164236*^9}, 3.8670512052320013`*^9, 3.867051282880905*^9, 
   3.867051378220948*^9, {3.8670514897988234`*^9, 3.867051506082806*^9}, {
   3.8670516103097963`*^9, 3.867051623397407*^9}, 3.867052252394486*^9, 
   3.867052514447427*^9, 3.867110234340056*^9, 3.867110331471683*^9, 
   3.868169388005954*^9, 3.868169430498211*^9, 3.868607314800735*^9, 
   3.9364339258358793`*^9},
 CellLabel->
  "Out[188]=",ExpressionUUID->"003bf0dc-a2ad-42a0-b7d1-f673ded87a78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Tt", ",", "Tp"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tt", "[", "od_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"phat", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "od"}], "]"}]}], ",", "leftv", ",", "num", ",",
       "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
          "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"Length", "@", "od"}]], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v", ",", 
           RowBox[{"p", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tp", "[", 
   RowBox[{"{", "i_", "}"}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", "v"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tp", "[", "f__", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"od", "=", 
        RowBox[{"{", "f", "}"}]}], ",", "phat", ",", "leftv", ",", "num", ",",
        "den"}], "}"}], ",", 
     RowBox[{
      RowBox[{"phat", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{"od", "===", 
          RowBox[{"T", "[", 
           RowBox[{"{", "i_", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"phat", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"od", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
           RowBox[{"Max", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], "]"}]}], ","}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"phat", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"p", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", "<", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
           "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{",", 
           RowBox[{
            RowBox[{"phat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"p", "@@", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"od", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
              "]"}]}]}]}], "]"}], "*)"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
      RowBox[{"num", "=", 
       RowBox[{"Times", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"leftv", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"F", "/@", 
              RowBox[{"od", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"gg_", ",", 
              RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
            "\[RuleDelayed]", " ", 
            RowBox[{"dot", "[", 
             RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"den", "=", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "1", "]"}]}], "]"}], 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"v", ",", 
            RowBox[{"p", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"GT2F", ",", "GTRM0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GT2F", "[", 
   RowBox[{
    RowBox[{"{", "g__", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", "i_", "}"}], "}"}]}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", "v"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GT2F", "[", 
   RowBox[{"f1_List", ",", "f2_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cod", "=", "f1"}], ",", 
      RowBox[{"od", "=", "f2"}], ",", "phat", ",", "leftv", ",", "num", ",", 
      "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", 
                RowBox[{"od", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
              "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"p", "[", 
          RowBox[{
           RowBox[{"MinimalBy", "[", 
            RowBox[{
             RowBox[{"od", "//", "Flatten"}], ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"cod", ",", "#1"}], "]"}], "&"}]}], "]"}], "//", 
           "First"}], "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v", ",", 
           RowBox[{"p", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GTRM0", "[", 
    RowBox[{"f1_List", ",", "f2_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cod", "=", "f1"}], ",", 
       RowBox[{"od", "=", "f2"}], ",", "phat"}], "}"}], ",", 
     RowBox[{
      RowBox[{"phat", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "@", "od"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"phat", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"od", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
           RowBox[{"Max", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], "]"}]}], ","}]}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"phat", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"p", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"cod", ",", "#"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"cod", ",", 
                 RowBox[{"od", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}],
                "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{",", 
           RowBox[{
            RowBox[{"phat", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"p", "@@", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"od", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
              "]"}]}]}]}], "]"}], "*)"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "phat", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"phat", ",", 
          RowBox[{"p", "[", "]"}]}], "]"}], ",", "0", ",", 
        RowBox[{"GT", "[", 
         RowBox[{"f1", ",", "f2"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "TScalar", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TScalar", "[", 
   RowBox[{"{", "i_", "}"}], "]"}], ":=", 
  RowBox[{"dot", "[", 
   RowBox[{
    RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", 
    RowBox[{"p", "[", "0", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TScalar", "[", "f__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", 
       RowBox[{"{", "f", "}"}]}], ",", "phat", ",", "leftv", ",", "rightv", 
      ",", "num", ",", "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"od", "===", 
         RowBox[{"T", "[", 
          RowBox[{"{", "i_", "}"}], "]"}]}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"p", "[", "0", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
          "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"rightv", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rightv", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      RowBox[{"p", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"rightv", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"p", "[", "0", "]"}], "+", 
         RowBox[{"p", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", 
                RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}], "&"}]}], 
           "]"}]}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"rightv", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "0", "]"}], "+", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "0", "]"}], "+", 
            RowBox[{"p", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"od", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", 
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
              "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzV1IU2EAxvGlECaKRzrTQpC8yBNafqCkgUZHhtRFMQ/YREtwGCQI4lch
lW42hogiLqGSDFERluIKE9TN5pQNN/TgFIeobExjQh7BPgQ/8OT7vBcPv4vn
4p+krRGehSkUiutkUOfPe5fTJ/Ge4IPP0JbtHYTM4PQIbGtYt0A5fO8rVB9f
m4IFTtEGR+zMEoxkAyJ8aVWu0T8/yQfHAsFNKFj1R/BE1y7Tjm2UzSWuGecS
4YVlJ7VHxfJw6JOrAL5a7CuEGkeiAPXGn8XQN9yqgcJU8xvY0ZjRAl9weQYo
Vhx0wIwfD7vhlWHOBC8FL4swtCFvwd5OLgRLb0xTF3rj/8CU4oq/8EP69xWe
mMt2rUJPS+UW/Da0H4Cm2ff2FIvEN9f1U4XoJh90/zNRRfNmTCqxxBui/l5Y
z4KvPRHZcHHAkQ/P7HoVlFs16lW3xI97OQHevegogYLb8hRWmWO1kOn59Rwa
Hovq/8Tb9yeL4L2wGT/nkfjkm0fUL9uFEvRnGqi1qVG7acTqcuUhdFYmnEJX
+YwMr9aXRacT53cYFvabNcwdourR21j4UZccB9NuPaHOKiPazojjE0bqORIq
PJ8=
  "],
 CellLabel->
  "In[189]:=",ExpressionUUID->"0472f27d-9a7f-4178-9309-50f70c8fbd78"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"GT2F\\\"}]\\) is Protected.\"", 2, 193, 49, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339258650703`*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"1aca0c78-ec7b-4660-9254-485cdb6b6b15"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"GT2F\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"GT2F\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
\\\"g__\\\", \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \\\
\"i_\\\", \\\"}\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]\\) is Protected.\"", 2, 194,
    50, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339258661747`*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"71a8be87-ff30-466e-8c96-7aaa0316c56e"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433925871448*^9},
 CellLabel->
  "Out[194]=",ExpressionUUID->"567fa312-ba6a-4bb0-ac22-03d813f33c19"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"GT2F\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"GT2F\\\", \\\"[\\\", RowBox[{\\\"f1_List\\\", \\\",\\\", \
\\\"f2_List\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 195, 51, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925872517*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"e37982fd-8a0e-4401-b1c2-ec803c2cc1af"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433925876506*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"ecb96d49-01c4-4a18-b640-b95519843087"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"TScalar\\\"}]\\) is Protected.\"", 2, 197, 
   52, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925877548*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"e292c243-2bf9-404f-8521-5c02f55c0aa2"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"TScalar\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"TScalar\\\", \\\"[\\\", RowBox[{\\\"{\\\", \\\"i_\\\", \
\\\"}\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 198, 53, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339258823757`*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"3138b5cb-ed22-41b6-8086-eff4eafec231"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433925886388*^9},
 CellLabel->
  "Out[198]=",ExpressionUUID->"b95bcdcf-f684-45a7-8ea0-bdc08e28d84f"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"TScalar\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"TScalar\\\", \\\"[\\\", \\\"f__\\\", \\\"]\\\"}]\\) is \
Protected.\"", 2, 199, 54, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433925887429*^9},
 CellLabel->
  "During evaluation of \
In[189]:=",ExpressionUUID->"b8f9971c-b0d1-4306-8bd8-4991c6dd804d"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339258914013`*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"beb4c58e-0a8a-416b-a92d-51bb299ff4ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mypartition", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8644275847866993`*^9, 3.8644276706382103`*^9}, {
  3.864427706214572*^9, 3.864427709715233*^9}, {3.864427755559827*^9, 
  3.864427764765161*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"b2ceee9f-0a48-4209-8663-4d3f868954b2"],

Cell[BoxData[
 RowBox[{"mypartition", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.864427594609951*^9, 3.864427671253285*^9}, 
   3.8644277103431797`*^9, {3.8644277560269423`*^9, 3.8644277654592857`*^9}, 
   3.864474097735807*^9, 3.8648751017661877`*^9, 3.8666773146391907`*^9, 
   3.8670337710031757`*^9, 3.867034861872611*^9, {3.8670355986194887`*^9, 
   3.867035625166457*^9}, 3.86816938803834*^9, 3.868169430532337*^9, 
   3.868607314841063*^9, 3.93643392589884*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"23c303bb-3120-49ee-89fb-0a35144204ce"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "partition", ",", "mypartition", ",", "partitionOrdered", ",", 
   "partitionPreNum"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partition", "[", 
   RowBox[{"{", "x_", "}"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"{", "x", "}"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partition", "[", 
   RowBox[{"{", 
    RowBox[{"r__", ",", "x_"}], "}"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"partition", "[", 
    RowBox[{"{", 
     RowBox[{"r", ",", "x"}], "}"}], "]"}], "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"ReplaceList", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b___", ",", 
              RowBox[{"{", "S__", "}"}], ",", "a___"}], "}"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"b", ",", 
              RowBox[{"{", 
               RowBox[{"S", ",", "x"}], "}"}], ",", "a"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"{", "S__", "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"S", ",", 
              RowBox[{"{", "x", "}"}]}], "}"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
      RowBox[{"partition", "[", 
       RowBox[{"{", "r", "}"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mypartition", "[", 
   RowBox[{"ls_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allpt", ",", "tb1", ",", "tb2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "ls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allpt", "=", 
      RowBox[{
       RowBox[{"Permutations", "/@", "allpt"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     RowBox[{"tb1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "j", "}"}], ",", 
             RowBox[{"allpt", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
          RowBox[{"allpt", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"Length", "@", 
               RowBox[{"allpt", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "allpt"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tb2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "j", "}"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       "allpt"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{"tb1", ",", "tb2"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mypartition", "[", "ls_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allpt", ",", "tb1", ",", "tb2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "ls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allpt", "=", 
      RowBox[{
       RowBox[{"Permutations", "/@", "allpt"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     RowBox[{"tb1", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"allpt", "[", 
              RowBox[{"[", 
               RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
          RowBox[{"allpt", "[", 
           RowBox[{"[", 
            RowBox[{"ii", ",", 
             RowBox[{"2", ";;", 
              RowBox[{"Length", "@", 
               RowBox[{"allpt", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "allpt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tb2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       "allpt"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Join", "[", 
     RowBox[{"tb1", ",", "tb2"}], "]"}], "*)"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionPreNum", "[", "ls_", "]"}], ":=", 
  RowBox[{"mypartition", "[", 
   RowBox[{
    RowBox[{"ls", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
    RowBox[{"ls", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionOrdered", "[", "ls_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "allpt", "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "ls", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"allpt", "=", 
        RowBox[{
         RowBox[{"Permutations", "/@", "allpt"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], "*)"}], 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"allpt", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}]}], "]"}], "}"}], ",", 
         RowBox[{"allpt", "[", 
          RowBox[{"[", 
           RowBox[{"ii", ",", 
            RowBox[{"2", ";;", 
             RowBox[{"Length", "@", 
              RowBox[{"allpt", "[", 
               RowBox[{"[", "ii", "]"}], "]"}]}]}]}], "]"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "allpt"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8405265652626762`*^9, 3.8405265774733143`*^9}, {
   3.8405268718548527`*^9, 3.840526958498376*^9}, {3.840527014516148*^9, 
   3.840527016426841*^9}, {3.840527219853006*^9, 3.840527300133636*^9}, {
   3.8405277915613937`*^9, 3.840527814878928*^9}, {3.8406856290885677`*^9, 
   3.840685657517951*^9}, {3.841202745678379*^9, 3.841202754536993*^9}, 
   3.842568892163535*^9, {3.8425701408526707`*^9, 3.842570165806718*^9}, 
   3.8425702175552797`*^9, {3.842570260739533*^9, 3.842570331776321*^9}, {
   3.8425704504307756`*^9, 3.842570450475792*^9}, {3.8425713464861794`*^9, 
   3.8425713562442913`*^9}, {3.84257144332904*^9, 3.842571479494907*^9}, {
   3.842571565368428*^9, 3.842571583125154*^9}, {3.8426130292062674`*^9, 
   3.8426130638316193`*^9}},
 CellLabel->
  "In[201]:=",ExpressionUUID->"98f6ff7c-f071-411c-95fb-9bc9ab005816"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"partitionOd", ",", "MyPartitionOd"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitionOd", "[", "fl_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "allpt", "}"}], ",", 
    RowBox[{
     RowBox[{"allpt", "=", 
      RowBox[{"partition", "[", "fl", "]"}]}], ";", 
     RowBox[{"Cases", "[", 
      RowBox[{"allpt", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{"OrderedQ", "[", 
         RowBox[{"Flatten", "[", "x", "]"}], "]"}]}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyPartitionOd", "[", "f_", "]"}], ":=", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"partitionOd", "[", 
      RowBox[{"Sort", "[", "f", "]"}], "]"}], "/.", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Rule", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sort", "[", "f", "]"}], ",", "f"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"x_", "/;", 
     RowBox[{"And", "@@", 
      RowBox[{"OrderedQ", "/@", "x"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.840686399528157*^9, 3.840686408446405*^9}, {
  3.840686496207872*^9, 3.8406865221059637`*^9}, {3.840686572057829*^9, 
  3.840686614220367*^9}, {3.840686942657793*^9, 3.8406869641759377`*^9}, {
  3.8406870311296253`*^9, 3.840687035423389*^9}, {3.8406871674539623`*^9, 
  3.840687168557219*^9}, {3.8424415718901873`*^9, 3.8424415778117037`*^9}, {
  3.842488230992901*^9, 3.842488298268762*^9}, {3.842572415706497*^9, 
  3.842572421861507*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"76ebb2e1-fb6b-4889-9d7e-34f9228369b5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "inLeft", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inLeft", "[", 
   RowBox[{"i_", ",", " ", "ls_", ",", " ", "top_"}], "]"}], ":=", 
  RowBox[{"MemberQ", "[", 
   RowBox[{
    RowBox[{"ls", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"ls", ",", "i"}], "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"top", "//", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Rule", "[", 
          RowBox[{"ii_", ",", "i"}], "]"}], "\[RuleDelayed]", " ", "ii"}], 
        "]"}]}], ")"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inLeft", "[", 
   RowBox[{"ls_", ",", " ", "top_"}], "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"inLeft", "[", 
      RowBox[{
       RowBox[{"ls", "[", 
        RowBox[{"[", "ii", "]"}], "]"}], ",", "ls", ",", "top"}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"ii", ",", "2", ",", 
       RowBox[{"Length", "@", "ls"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ConsistentOrder", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConsistentOrder", "[", 
   RowBox[{"nm1_", ",", "top_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "allorder", "}"}], ",", 
    RowBox[{
     RowBox[{"allorder", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "2", "}"}], ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Permutations", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"3", ",", "nm1"}], "]"}], "]"}]}]}], ";", 
     RowBox[{"allorder", "=", 
      RowBox[{"allorder", "//", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"f_", "/;", 
           RowBox[{"inLeft", "[", 
            RowBox[{"f", ",", "top"}], "]"}]}]}], "]"}], "&"}]}]}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.842419806383766*^9, 3.8424199412089443`*^9}, {
   3.8424199940657454`*^9, 3.8424200286763763`*^9}, {3.842420444552554*^9, 
   3.842420445011114*^9}, 3.8424213239079*^9, {3.8424216057077913`*^9, 
   3.842421627034822*^9}, {3.84242166211164*^9, 3.8424216845191793`*^9}, {
   3.8424217674777822`*^9, 3.84242177712002*^9}, {3.84242950933322*^9, 
   3.8424295110326357`*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"915d91cd-c71e-4996-b17e-e6d137cb7421"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"order2Mfun", ",", "list2top"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"list2top", "[", "ls_List", "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "ls", "]"}], "\[Equal]", "1"}], ",", 
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"ls", "[", 
         RowBox[{"[", 
          RowBox[{"ii", "-", "1"}], "]"}], "]"}], ",", 
        RowBox[{"ls", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"ii", ",", "2", ",", 
        RowBox[{"Length", "@", "ls"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order2Mfun", "[", 
   RowBox[{"od_", ",", "top_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ls", ",", "allowedPartitions"}], "}"}], ",", 
    RowBox[{
     RowBox[{"allowedPartitions", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"MyPartitionOd", "[", "od", "]"}], ",", 
        RowBox[{"f_", "/;", 
         RowBox[{"And", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"top", ",", "#"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"list2top", "/@", "f"}], "//", "Flatten"}], ")"}]}], 
           ")"}]}]}]}], "]"}]}], ";", " ", 
     RowBox[{"ls", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"M", "@@@", "allowedPartitions"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"f1_", ",", "f___"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"M", "[", 
         RowBox[{
          RowBox[{"L", "@@", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", "f1"}], "]"}]}], ",", "f"}], 
         "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ls", "[", 
         RowBox[{"[", "iii", "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"List", "[", 
          RowBox[{"f1_", ",", "g___"}], "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"R", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"top", "//", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Rule", "[", 
                 RowBox[{"ii_", ",", "f1"}], "]"}], "\[RuleDelayed]", " ", 
                "ii"}], "]"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "f1", ",", "g"}], "]"}]}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"iii", ",", 
         RowBox[{"Length", "@", "ls"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8424296813789883`*^9, 3.842429684320457*^9}, {
   3.8424297361143417`*^9, 3.84242974122054*^9}, {3.8424298383197002`*^9, 
   3.842430025912467*^9}, {3.842430056461475*^9, 3.842430073852194*^9}, {
   3.842430128031891*^9, 3.842430300339055*^9}, {3.842430418039826*^9, 
   3.8424304581372147`*^9}, {3.842430595130908*^9, 3.8424306019792213`*^9}, {
   3.842430822826119*^9, 3.842430824491026*^9}, 3.842441586221746*^9, {
   3.8424902772312593`*^9, 3.842490366455612*^9}, {3.8424904122243233`*^9, 
   3.842490425389668*^9}, {3.842569649491745*^9, 3.842569651441369*^9}, 
   3.842570481555649*^9, 3.842572456318274*^9},
 CellLabel->
  "In[216]:=",ExpressionUUID->"4f2228f5-f4bc-446d-ba13-19a94d114a66"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Mt", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mt", "[", "ls_M", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", 
       RowBox[{"List", "@@", "ls"}]}], ",", "phat", ",", "leftv", ",", "num", 
      ",", "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"od", "/.", 
         RowBox[{
          RowBox[{"L", "[", "f___", "]"}], "\[RuleDelayed]", 
          RowBox[{"{", "}"}]}]}], "/.", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"f1_", ",", "f___"}], "]"}], "\[RuleDelayed]", " ", 
         "f1"}]}], "//", "Flatten"}]}], ";", " ", 
     RowBox[{"phat", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"p", "/@", "phat"}]}], "]"}]}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"od", "=", 
      RowBox[{
       RowBox[{"od", "/.", 
        RowBox[{
         RowBox[{"L", "[", "f___", "]"}], "\[RuleDelayed]", 
         RowBox[{"{", "f", "}"}]}]}], "/.", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{"f1_", ",", "f___"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"{", "f", "}"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"leftv", ",", "od"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"leftv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"F", "/@", 
             RowBox[{"od", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", "v"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"gg_", ",", 
             RowBox[{"List", "[", "gf___", "]"}], ",", "hh_"}], "]"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"dot", "[", 
            RowBox[{"gg", ",", "gf", ",", "hh"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"(*", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        RowBox[{"Length", "@", "od"}]], "*)"}], 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", 
         RowBox[{"p", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v", ",", 
           RowBox[{"p", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"od", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", 
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mt", "[", 
   RowBox[{"a_", " ", "ls_M"}], "]"}], ":=", 
  RowBox[{"a", " ", 
   RowBox[{"Mt", "[", "ls", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.842430840979085*^9, 3.842430852674786*^9}, 
   3.842431084940221*^9, {3.842431132658041*^9, 3.8424312052286787`*^9}, {
   3.8424312380841208`*^9, 3.8424312470716963`*^9}, {3.8424312795583363`*^9, 
   3.842431366972395*^9}, {3.842431401307167*^9, 3.842431478145885*^9}, {
   3.842431528162805*^9, 3.842431570148491*^9}, 3.842431620536182*^9, {
   3.842431741997093*^9, 3.842431747822502*^9}, 3.8425320668196793`*^9, {
   3.846565452622879*^9, 3.846565489243559*^9}, 3.8499381680908813`*^9, {
   3.849938377147605*^9, 3.849938380818019*^9}, {3.849938413853136*^9, 
   3.849938421162908*^9}, 3.849939067547724*^9, 3.849940338552994*^9, {
   3.853387493283533*^9, 3.853387506027759*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"b0f0e953-3846-4b11-bc15-1d8ecf344bb8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Tt", "/@", 
      RowBox[{"mypartition", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ")"}], "//", "expandF"}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.849934859049008*^9, 3.849934899094037*^9}, {
   3.8499357420187387`*^9, 3.84993575065245*^9}, 3.8544284125678368`*^9, 
   3.854428480533188*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"58a3d160-9174-49f5-9daf-a9c702f5dc0e"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "NumPre", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NumPre", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "alltop", ",", "lenTop", ",", "allods", ",", "res", ",", "res2"}], "}"}],
     ",", 
    RowBox[{
     RowBox[{"alltop", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"List", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"KLTRM", "[", "n", "]"}], "//.", "nice"}], "/.", 
                 RowBox[{
                  RowBox[{"CenterDot", "[", 
                   RowBox[{
                    SubscriptBox["p", "i_"], ",", 
                    SubscriptBox["p", "j_"]}], "]"}], "\[RuleDelayed]", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"i", ",", "j"}], "]"}]}]}], "/.", 
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"1", ",", "i_"}], "]"}], "\[RuleDelayed]", " ", 
                 RowBox[{"0", "/;", 
                  RowBox[{"i", ">", "2"}]}]}]}], "//", "Union"}], "//", 
              "Expand"}], "//", "Total"}], ")"}], "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_s"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "]"}], "/.", 
         RowBox[{"Plus", "\[Rule]", " ", "List"}]}], "//", "Flatten"}], "//", 
       "Union"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"alltop", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@@", "alltop"}], ")"}], "/.", 
       RowBox[{"s", "\[Rule]", " ", "Rule"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"lenTop", "=", 
      RowBox[{"Length", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Keys", "@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Counts", "[", "#1", "]"}], ",", 
              RowBox[{
               RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}]}], ")"}], "&"}],
          "/@", 
         RowBox[{"(", 
          RowBox[{"Flatten", "/@", 
           RowBox[{"(", 
            RowBox[{"alltop", "/.", 
             RowBox[{"Rule", "\[Rule]", " ", "List"}]}], ")"}]}], ")"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"allods", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"R", "[", 
         RowBox[{
          RowBox[{"ConsistentOrder", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", 
            RowBox[{"alltop", "[", 
             RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"alltop", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "alltop"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"allods", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"f1_", ",", "f2_"}], "]"}], "\[RuleDelayed]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"order2Mfun", "[", 
               RowBox[{"#", ",", "f2"}], "]"}], "&"}], "/@", "f1"}], 
            ")"}]}]}], "//", "Flatten"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "alltop"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"res", ",", "lenTop"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Total", "/@", "res"}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"#", ",", 
             RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", "lenTop"}], ")"}]}], "/.", 
       RowBox[{
        RowBox[{"M", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], 
          RowBox[{"Length", "[", 
           RowBox[{"{", "f", "}"}], "]"}]], 
         RowBox[{"M", "[", "f", "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"M", "[", "f___", "]"}], "\[RuleDelayed]", "  ", 
        RowBox[{"Mt", "[", 
         RowBox[{"M", "[", "f", "]"}], "]"}]}]}]}]}]}], "\[IndentingNewLine]",
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.853202164447188*^9, 3.85320217100595*^9}, {
   3.853202316807131*^9, 3.853202332415065*^9}, {3.853202366464652*^9, 
   3.8532023671973677`*^9}, {3.853202475537047*^9, 3.853202498162573*^9}, {
   3.853202563179946*^9, 3.853202586505467*^9}, {3.853215144189726*^9, 
   3.8532151816508217`*^9}, {3.8533875651127367`*^9, 
   3.8533875664069777`*^9}, {3.853387601858445*^9, 3.85338761779875*^9}, {
   3.853387656481176*^9, 3.853387660644102*^9}, {3.8533876917549267`*^9, 
   3.8533876941755342`*^9}, {3.853387849172793*^9, 3.853387887643906*^9}, 
   3.853387958572192*^9},
 CellLabel->
  "In[223]:=",ExpressionUUID->"84770e70-7f73-47e4-98a4-d78342eb9e92"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "ET2GT", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ET2GT", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"a", "[", "i_", "]"}], ":>", 
     SuperscriptBox["t", 
      SubscriptBox["a", "i"]]}]}], "/.", 
   RowBox[{
    RowBox[{"ET", "[", 
     RowBox[{"f1_GT", ",", 
      RowBox[{"{", "f2__", "}"}]}], "]"}], "\[RuleDelayed]", 
    RowBox[{"f1", " ", 
     RowBox[{"tr", "[", 
      RowBox[{"CenterDot", "[", "f2", "]"}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.867108514590242*^9, 3.867108535216876*^9}, 
   3.867108567662366*^9, {3.867108644397539*^9, 3.867108647810176*^9}},
 CellLabel->
  "In[225]:=",ExpressionUUID->"90439321-0d9a-46df-82a5-aea5e28fe481"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"NumPre", "[", "4", "]"}], "//.", "nice"}], "*)"}]], "Input",
 CellChangeTimes->{{3.853917747020267*^9, 3.853917755402676*^9}, 
   3.854428484426598*^9},
 CellLabel->
  "In[227]:=",ExpressionUUID->"189cf105-7455-4566-b8eb-b5851bef6c67"]
}, Closed]],

Cell[CellGroupData[{

Cell["IntegrandReducePrograms", "Section",
 CellChangeTimes->{{3.814013654478552*^9, 
  3.814013661132234*^9}},ExpressionUUID->"2068968a-7173-4513-b2f5-\
da82e26ce4ff"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "helicitysum", ",", "helicitysum2", ",", "Mono2List", ",", "deg", ",", 
   "degDotp", ",", "F2dot2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"helicitysum2", "[", "exleg_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f1_", ",", 
         RowBox[{"\[CurlyEpsilon]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}], " ", 
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f2_", ",", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}]}], " ",
      ":>", "  ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f1"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f2", ",", "f2"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f3_", ",", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}]}], " ",
      ":>", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f3"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f2", ",", "f3"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f3"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f3_", ",", 
         RowBox[{"\[CurlyEpsilon]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}]}], " ",
      ":>", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f1"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f3"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{"f3_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f4_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}]}], " ", ":>", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f1"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f4", ",", "f2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f4", ",", "f1"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f4"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"f1_", ",", "f2_"}], "]"}], ":>", " ", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"dott", "[", 
        RowBox[{"f1", ",", "f2"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"dott", "[", 
           RowBox[{
            RowBox[{"q", "[", "exleg", "]"}], ",", "f1"}], "]"}], 
          RowBox[{"dott", "[", 
           RowBox[{
            RowBox[{"p", "[", "exleg", "]"}], ",", "f2"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"dott", "[", 
           RowBox[{
            RowBox[{"p", "[", "exleg", "]"}], ",", "f1"}], "]"}], 
          RowBox[{"dott", "[", 
           RowBox[{
            RowBox[{"q", "[", "exleg", "]"}], ",", "f2"}], "]"}]}]}], ")"}], 
       "/", 
       RowBox[{"dott", "[", 
        RowBox[{
         RowBox[{"p", "[", "exleg", "]"}], ",", 
         RowBox[{"q", "[", "exleg", "]"}]}], "]"}]}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}]}], ":>", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "-", "DD"}], ")"}], "/", "2"}], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{"f1", ",", "f2"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}]}], ":>", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "-", "DD"}], ")"}], "/", "2"}], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{"f1", ",", "f2"}], "]"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}], "->", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"DD", "-", "2"}], ")"}], "^", "2"}], "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}], "->", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"DD", "-", "2"}], ")"}], "^", "2"}], "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}]}], "]"}], ":>", " ", "0"}], ",", 
    
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}]}], "]"}], ":>", " ", "0"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"helicitysum", "[", "exleg_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f1_", ",", 
         RowBox[{"\[CurlyEpsilon]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}], " ", 
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f2_", ",", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}]}], " ",
      ":>", "  ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f1"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f2", ",", "f2"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f3_", ",", 
         RowBox[{"\[Xi]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}]}], " ",
      ":>", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f3"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f2", ",", "f3"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f3"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{
       RowBox[{"dott", "[", 
        RowBox[{"f3_", ",", 
         RowBox[{"\[CurlyEpsilon]", "[", 
          RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}]}], " ",
      ":>", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f1"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f3"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{"f3_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], 
      RowBox[{"dott", "[", 
       RowBox[{"f4_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}]}], " ", ":>", " ", 
     RowBox[{
      RowBox[{"1", "/", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f1"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f4", ",", "f2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f4", ",", "f1"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"2", "/", 
          RowBox[{"(", 
           RowBox[{"DD", "-", "2"}], ")"}]}], " ", 
         RowBox[{"S", "[", 
          RowBox[{"f1", ",", "f2"}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{"f3", ",", "f4"}], "]"}]}]}], ")"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"f1_", ",", "f2_"}], "]"}], ":>", " ", 
     RowBox[{"-", 
      RowBox[{"dott", "[", 
       RowBox[{"f1", ",", "f2"}], "]"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}]}], ":>", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "-", "DD"}], ")"}], "/", "2"}], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{"f1", ",", "f2"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{"f1_", ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{"f2_", ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}]}], ":>", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "-", "DD"}], ")"}], "/", "2"}], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{"f1", ",", "f2"}], "]"}]}]}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}], "->", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"DD", "-", "2"}], ")"}], "^", "2"}], "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"dott", "[", 
       RowBox[{
        RowBox[{"\[Xi]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}], ",", 
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"p", "[", "exleg", "]"}], "]"}]}], "]"}], "^", "2"}], "->", 
     " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"DD", "-", "2"}], ")"}], "^", "2"}], "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}], ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}]}], "]"}], ":>", " ", "0"}], ",", 
    
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}]}], "]"}], ":>", " ", "0"}], ",", 
    
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}]}], "]"}], ":>", " ", "0"}], ",", 
    
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", " ", "0"}], ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}]}], "]"}], ":>", " ", "0"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Numerator", "[", "f", "]"}]}], ",", 
      RowBox[{"den", "=", 
       RowBox[{"Denominator", "[", "f", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "num", ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "den", ")"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"degDotp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"deg", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a_p", ",", "b_p"}], "]"}], ":>", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", "g__", "]"}], ":>", " ", "1"}]}], " ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "dimDen"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_List"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"dimDen", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "dimDen"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8140062706411543`*^9, 3.8140062994629107`*^9}, {
   3.8140065345967293`*^9, 3.814006621571209*^9}, {3.814013602758644*^9, 
   3.814013623765513*^9}, {3.8141669444990253`*^9, 3.81416694476873*^9}, {
   3.814167885781344*^9, 3.8141679601122026`*^9}, {3.8142473365567913`*^9, 
   3.814247407776434*^9}, {3.814248172605113*^9, 3.8142482007869463`*^9}, {
   3.8142482405116997`*^9, 3.814248244633265*^9}, 3.814248325450932*^9, {
   3.814248412319858*^9, 3.81424848741365*^9}, {3.814962545404784*^9, 
   3.814962585663475*^9}, {3.815009038314828*^9, 3.815009069963484*^9}, {
   3.8150091819305773`*^9, 3.815009184896039*^9}, {3.8169105478450737`*^9, 
   3.816910627411359*^9}, {3.81691067383867*^9, 3.816910689048641*^9}, {
   3.816910724098022*^9, 3.81691074362925*^9}, {3.8169108765190763`*^9, 
   3.816910902355114*^9}, {3.8434348474966497`*^9, 3.8434348516731462`*^9}, {
   3.843436099298913*^9, 3.84343610029069*^9}, {3.8553038436963387`*^9, 
   3.855303905303602*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"46cb760f-ecc2-4aff-a9aa-be0515046873"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "odcdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"odcdot", "[", "i_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i", "]"}], "]"}], ",", "f_"}], "]"}], 
     "\[RuleDelayed]", " ", 
     RowBox[{"dott", "[", 
      RowBox[{"f", ",", 
       RowBox[{"\[CurlyEpsilon]", "[", 
        RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i", "]"}], "]"}], ",", "f_"}], "]"}], 
     "\[RuleDelayed]", " ", 
     RowBox[{"dott", "[", 
      RowBox[{"f", ",", 
       RowBox[{"\[Xi]", "[", 
        RowBox[{"p", "[", "i", "]"}], "]"}]}], "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.814962668226801*^9, 3.814962688425741*^9}, {
  3.832141620648464*^9, 3.8321416227419243`*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"601feaf4-6821-40b5-a22a-bcad2ee76698"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "onshelldot", "]"}], "\[IndentingNewLine]", 
 RowBox[{"onshelldot", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
    ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{"v2", ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], " ", "\[RuleDelayed]", " ", 
     "0"}], ",", 
    RowBox[{
     RowBox[{"dott", "[", 
      RowBox[{
       RowBox[{"-", "v2"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], " ", ":>", " ", "0"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.843436782476797*^9, 3.843436895643207*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"a4d4f075-8661-4926-b826-4e4e0a06a9fa"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "loopOnshell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loopOnshell", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "i", "]"}], ",", 
     RowBox[{"p", "[", "j", "]"}]}], "]"}], "\[Rule]", "   ", 
   RowBox[{"s23", "-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], "-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], "-", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "3", "]"}]}], "]"}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], ",", 
      RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.814240242439022*^9, 3.814240349912619*^9}, {
   3.81424100698265*^9, 3.814241015778233*^9}, 3.8142411954599247`*^9},
 CellLabel->
  "In[239]:=",ExpressionUUID->"e832d907-1791-4d46-bb98-a453eefea01c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Algebra", "Section",
 CellChangeTimes->{{3.727085275547757*^9, 3.727085279642453*^9}, {
   3.749130217309951*^9, 3.749130238938786*^9}, 
   3.749179644362186*^9},ExpressionUUID->"da8a9d91-1b54-46b0-af96-\
6c4c1159d0e7"],

Cell[CellGroupData[{

Cell["subprogramme", "Subsubsection",
 CellChangeTimes->{{3.728292153199686*^9, 
  3.728292158406268*^9}},ExpressionUUID->"aa4171ce-ee5f-4149-a43e-\
f7491bb6e9f7"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "shuffle", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shuffle", "[", 
   RowBox[{"s1_List", ",", "s2_List"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"shuffle", "[", 
    RowBox[{"s1", ",", "s2"}], "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "tp", ",", "ord"}], "}"}], ",", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{
        RowBox[{"Permutations", "@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "&"}], "/@", "s1"}], ",", 
           RowBox[{
            RowBox[{"0", "&"}], "/@", "s2"}]}], "]"}]}], "\[Transpose]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"tp", "=", 
       RowBox[{"BitXor", "[", 
        RowBox[{"p", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ord", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Accumulate", "[", "p", "]"}], " ", "p"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Accumulate", "[", "tp", "]"}], "+", 
           RowBox[{"Length", "[", "s1", "]"}]}], ")"}], " ", "tp"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"Part", ",", 
          RowBox[{"{", 
           RowBox[{"Join", "[", 
            RowBox[{"s1", ",", "s2"}], "]"}], "}"}], ",", "ord", ",", "1"}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Transpose]"}]}]}], 
    "]"}]}]}]}], "Input",
 CellLabel->
  "In[241]:=",ExpressionUUID->"9ffb383e-0cc5-4273-924c-fe799c24189a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"mC", ",", "nMC"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mC", "[", "f_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "f", "]"}], "=!=", "Plus"}], "&&", 
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], ">=", "2"}]}], ",", "True", ",", 
    "False"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMC", "[", "f_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Not", "[", 
    RowBox[{"mC", "[", "f", "]"}], "]"}], "&&", " ", 
   RowBox[{
    RowBox[{"Head", "[", "f", "]"}], "=!=", "Plus"}]}]}]}], "Input",
 CellChangeTimes->{{3.856319318471849*^9, 3.8563193431920757`*^9}, {
   3.856320334312257*^9, 3.856320419240469*^9}, {3.8563205875649557`*^9, 
   3.856320594112719*^9}, {3.856320724920815*^9, 3.856320731151589*^9}, {
   3.8563297731533337`*^9, 3.8563298018032017`*^9}, {3.856334061482956*^9, 
   3.856334085687231*^9}, {3.856334158046072*^9, 3.8563341610118017`*^9}, {
   3.856334203490497*^9, 3.856334212033517*^9}, {3.856334288755166*^9, 
   3.856334294958416*^9}, 3.856334326466332*^9},
 CellLabel->
  "In[243]:=",ExpressionUUID->"ebe53da6-2405-474d-baaf-490009e2f361"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"ExpandNCM", ",", "ExpandT", ",", "GetTId"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
    RowBox[{"a___", ",", "b_Plus", ",", "c___"}], "]"}], "]"}], ":=", 
  RowBox[{"Distribute", "[", 
   RowBox[{
    RowBox[{"h", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "Plus", ",", "h", ",", 
    "Plus", ",", 
    RowBox[{
     RowBox[{"ExpandNCM", "[", 
      RowBox[{"h", "[", "##", "]"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
    RowBox[{"a___", ",", "b_Times", ",", "c___"}], "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Most", "[", "b", "]"}], 
   RowBox[{"ExpandNCM", "[", 
    RowBox[{"h", "[", 
     RowBox[{"a", ",", 
      RowBox[{"Last", "[", "b", "]"}], ",", "c"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "a_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExpandNCM", "[", "#", "]"}], "&"}], "/@", 
   "a"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "c_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "*", 
   RowBox[{"ExpandNCM", "[", 
    RowBox[{"c", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandNCM", "[", "a_", "]"}], ":=", 
  RowBox[{"ExpandAll", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandT", "[", "f_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"NonCommutativeMultiply", "@@", "f"}], "//", "ExpandNCM"}], 
      ")"}], "/.", 
     RowBox[{
      RowBox[{"T", "[", "hh__", "]"}], ":>", " ", "hh"}]}], "/.", 
    RowBox[{"NonCommutativeMultiply", "->", " ", "T"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandCT", "[", "f_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NonCommutativeMultiply", "@@", "f"}], "//", "ExpandNCM"}], 
     ")"}], "/.", 
    RowBox[{"NonCommutativeMultiply", "->", " ", "CircleTimes"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetTId", "[", "f_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"T", "[", "hh__", "]"}], ":>", " ", "hh"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "ExpandCircleTimes", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandCircleTimes", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "/.", 
      RowBox[{"CircleTimes", "->", "NonCommutativeMultiply"}]}], "//", 
     "ExpandNCM"}], ")"}], "/.", 
   RowBox[{"NonCommutativeMultiply", "->", "CircleTimes"}]}]}]}], "Input",
 CellChangeTimes->{{3.856331822553081*^9, 3.8563319201712914`*^9}, {
  3.856332130050441*^9, 3.856332226769471*^9}, {3.8563453592245083`*^9, 
  3.856345406962907*^9}, {3.864021262354207*^9, 3.8640212631965113`*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"81855e2f-3ffd-4f70-a2f3-dabfe460f2ae"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"ExpandNCM\\\"}]\\) is Protected.\"", 2, 246,
    55, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926041847*^9},
 CellLabel->
  "During evaluation of \
In[246]:=",ExpressionUUID->"8ccfdb36-fb53-47e1-9068-08a71e933ff4"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"ExpandNCM\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"ExpandNCM\\\", \\\"[\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"h\\\", \\\":\\\", \\\"NonCommutativeMultiply\\\"}], \\\")\\\"}], \
\\\"[\\\", RowBox[{\\\"a___\\\", \\\",\\\", \\\"b_Plus\\\", \\\",\\\", \
\\\"c___\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 247, 56, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926043036*^9},
 CellLabel->
  "During evaluation of \
In[246]:=",ExpressionUUID->"12266dc6-6ac2-4282-a096-593dce350bdb"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926048525*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"87d7847e-41e7-4707-9983-2eba9f66f7d6"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"ExpandNCM\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"ExpandNCM\\\", \\\"[\\\", RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"h\\\", \\\":\\\", \\\"NonCommutativeMultiply\\\"}], \\\")\\\"}], \
\\\"[\\\", RowBox[{\\\"a___\\\", \\\",\\\", \\\"b_Times\\\", \\\",\\\", \
\\\"c___\\\"}], \\\"]\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 248, 57, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926049831*^9},
 CellLabel->
  "During evaluation of \
In[246]:=",ExpressionUUID->"f7c19461-b3b1-48f8-83df-e95c9138dcd8"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339260547028`*^9},
 CellLabel->
  "Out[248]=",ExpressionUUID->"d5c516b8-8bae-4a6e-8aed-b26237845349"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"ExpandNCM\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"ExpandNCM\\\", \\\"[\\\", \\\"a_Plus\\\", \\\"]\\\"}]\\) \
is Protected.\"", 2, 249, 58, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926056011*^9},
 CellLabel->
  "During evaluation of \
In[246]:=",ExpressionUUID->"6c73c632-4919-4f6f-ac79-00f0eae808b7"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339260603743`*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"ddd4a990-3c42-4685-864b-ce4fb78f294f"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"ExpandNCM\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"ExpandNCM\\\", \\\"[\\\", \\\"c_Times\\\", \
\\\"]\\\"}]\\) is Protected.\"", 2, 250, 59, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926061618*^9},
 CellLabel->
  "During evaluation of \
In[246]:=",ExpressionUUID->"75436dbe-4abd-4b63-9b98-f9e9a8649dbd"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926065853*^9},
 CellLabel->
  "Out[250]=",ExpressionUUID->"2b276b3e-4434-4661-9f66-2626bcd78c38"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"ExpandNCM\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"ExpandNCM\\\", \\\"[\\\", \\\"a_\\\", \\\"]\\\"}]\\) is \
Protected.\"", 2, 251, 60, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926067069*^9},
 CellLabel->
  "During evaluation of \
In[246]:=",ExpressionUUID->"608bccef-2578-4860-b919-9bac71fe54bb"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.93643392607121*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"87ad2ed6-9ab6-4cce-9665-42074c29d3a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[FivePointedStar]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "mC"}], ",", 
    RowBox[{"g_T", "?", "mC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "g"}], "]"}]}], "]"}], "//",
       "ExpandT"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{"f", ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "ExpandT"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "ExpandT"}], ")"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "nMC"}], ",", 
    RowBox[{"g_T", "?", "mC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "GetTId"}], ")"}]}], 
     "]"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{"f", ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}]}], "]"}]}], "]"}], "//", 
      "ExpandT"}], ")"}], "-", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "GetTId"}], ")"}]}], 
     "]"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "mC"}], ",", 
    RowBox[{"g_T", "?", "nMC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "g"}], "]"}]}], "]"}], "//",
       "ExpandT"}], ")"}], "+", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "//", "GetTId"}], ")"}]}], 
     "]"}], "-", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "1"}]}], "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"T", "[", "hh__", "]"}], ":>", " ", "hh"}]}], ")"}]}], 
     "]"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"f_T", "?", "nMC"}], ",", 
    RowBox[{"g_T", "?", "nMC"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "+", 
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
    RowBox[{"T", "[", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"g", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_Plus", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_", ",", "g_Plus"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_Times", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_", ",", "g_Times"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", 
      RowBox[{"f", ",", "g"}], "]"}], "//", "ExpandNCM"}], ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[FivePointedStar]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"\[DoubleStruckCapitalI]", ",", "g_"}], "]"}], ":=", 
  "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"g_", ",", "\[DoubleStruckCapitalI]"}], "]"}], ":=", 
  "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f1_", ",", "f2_", ",", "g__"}], "]"}], ":=", 
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{
    RowBox[{"\[FivePointedStar]", "[", 
     RowBox[{"f1", ",", "f2"}], "]"}], ",", "g"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", "g_T", "]"}], ":=", 
  "g"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_GT", ",", "g_GT"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "==", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "==", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{
     RowBox[{"T", "@@", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "/.", 
     RowBox[{
      RowBox[{"T", "[", "h___", "]"}], ":>", " ", 
      RowBox[{"GT", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{"#1", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "#"}], "]"}], 
             "&"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", "h", "}"}]}]}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"\[FivePointedStar]", "[", 
      RowBox[{
       RowBox[{"T", "@@", 
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"T", "@@", 
        RowBox[{"g", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"T", "[", "h__", "]"}], ":>", " ", 
      RowBox[{"GT", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{"#1", ",", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"f", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"g", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "#"}], "]"}], 
             "&"}]}], "]"}], "&"}], "/@", 
         RowBox[{"{", "h", "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[FivePointedStar]", "[", 
   RowBox[{"f_ET", " ", ",", "g_ET"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "groupGens", "}"}], ",", 
    RowBox[{
     RowBox[{"groupGens", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], " ", ";", 
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
        RowBox[{"g", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "/.", 
      RowBox[{
       RowBox[{"GT", "[", "gg__", "]"}], ":>", 
       RowBox[{"ET", "[", 
        RowBox[{
         RowBox[{"GT", "[", "gg", "]"}], ",", "groupGens"}], "]"}]}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[FivePointedStar]", "[", 
     RowBox[{
      RowBox[{"f_GT", " ", "h_tr"}], ",", "g_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"h", " ", 
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{"f", " ", ",", "g"}], "]"}]}], "//", 
      RowBox[{"Expand", "\[IndentingNewLine]", 
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{"f_", " ", ",", 
         RowBox[{"g_GT", " ", "h_tr"}]}], "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"h", " ", 
       RowBox[{"\[FivePointedStar]", "[", 
        RowBox[{"f", " ", ",", "g"}], "]"}]}], "//", "Expand"}]}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8563191594251137`*^9, 3.856319223417831*^9}, {
   3.856319257175762*^9, 3.856319305365706*^9}, {3.856319976718423*^9, 
   3.856320218369108*^9}, {3.856320252485381*^9, 3.8563202543741827`*^9}, {
   3.856320298002324*^9, 3.856320302663621*^9}, {3.856320604353388*^9, 
   3.856320619683857*^9}, {3.856320710164442*^9, 3.856320736317131*^9}, {
   3.856320819477583*^9, 3.856320878478187*^9}, {3.8563209139140453`*^9, 
   3.85632096668184*^9}, {3.856329223068709*^9, 3.8563292579462023`*^9}, {
   3.856329296539744*^9, 3.856329410385338*^9}, {3.856329514847363*^9, 
   3.856329648339566*^9}, {3.8563297646477747`*^9, 3.856329769224903*^9}, {
   3.856329809013173*^9, 3.85632985414421*^9}, {3.8563299958647213`*^9, 
   3.856330010629747*^9}, {3.856330127525535*^9, 3.8563301333989553`*^9}, {
   3.8563301711283207`*^9, 3.856330179424288*^9}, {3.85633025449926*^9, 
   3.856330269185977*^9}, {3.8563306034896297`*^9, 3.856330724273782*^9}, {
   3.856331638043936*^9, 3.856331652512753*^9}, {3.8563317082017717`*^9, 
   3.856331734577879*^9}, {3.856331935956551*^9, 3.856331959186226*^9}, {
   3.856332051418643*^9, 3.856332059112619*^9}, {3.856332172567361*^9, 
   3.856332176521573*^9}, {3.856332424309197*^9, 3.856332512543316*^9}, {
   3.8563334863364*^9, 3.856333644817451*^9}, 3.85633386133387*^9, {
   3.856333932731287*^9, 3.856333933116054*^9}, {3.856334222188333*^9, 
   3.856334245796074*^9}, {3.85634405027798*^9, 3.856344108089128*^9}, {
   3.856345685495426*^9, 3.856345712974819*^9}, {3.856401049370289*^9, 
   3.856401107609158*^9}, {3.856403332111394*^9, 3.8564033721547413`*^9}, {
   3.856412979290757*^9, 3.856412997304871*^9}, {3.856526220409972*^9, 
   3.856526245974831*^9}, {3.863830613634076*^9, 3.863830614175213*^9}, {
   3.863838245251693*^9, 3.863838284353326*^9}, {3.864001646885152*^9, 
   3.864001650368113*^9}, {3.8640016842922497`*^9, 3.864001729387974*^9}, {
   3.8640017672487164`*^9, 3.864001802688643*^9}, 3.8640018328625097`*^9, {
   3.8670344011776953`*^9, 3.867034455660643*^9}, {3.8670345471831417`*^9, 
   3.8670345686568317`*^9}, {3.867036310992589*^9, 3.86703635171941*^9}, {
   3.867036397495845*^9, 3.8670364033793383`*^9}, {3.8670364699796886`*^9, 
   3.8670364750546923`*^9}, 3.8670367572135344`*^9, {3.867036956302236*^9, 
   3.867037097158066*^9}, {3.8670371412616158`*^9, 3.867037168207168*^9}, {
   3.867037301568342*^9, 3.867037304798341*^9}, {3.8670374401260433`*^9, 
   3.867037442023959*^9}, {3.867037484740986*^9, 3.867037493393705*^9}, {
   3.867048401041164*^9, 3.8670484411596813`*^9}, {3.867048689445307*^9, 
   3.867048706033613*^9}, {3.867048835439487*^9, 3.867048836623272*^9}, {
   3.8670489376832447`*^9, 3.86704903149479*^9}, {3.86704908574683*^9, 
   3.867049189795974*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"f2717780-8787-4623-8120-caef4ecabb88"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) is \
Protected.\"", 2, 257, 61, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339260816183`*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"c928ef66-d01e-4b0b-930f-d1b475568c64"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"f_T\\\", \\\"?\\\", \\\"mC\\\"}], \\\",\\\", \
RowBox[{\\\"g_T\\\", \\\"?\\\", \\\"mC\\\"}]}], \\\"]\\\"}]\\) is \
Protected.\"", 2, 258, 62, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926082899*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"928885b3-ee96-4dca-bded-2af173d92be4"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926087727*^9},
 CellLabel->
  "Out[258]=",ExpressionUUID->"9c37ebdb-a71b-40d1-ac20-8bc7283295ee"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"f_T\\\", \\\"?\\\", \\\"nMC\\\"}], \\\",\\\", \
RowBox[{\\\"g_T\\\", \\\"?\\\", \\\"mC\\\"}]}], \\\"]\\\"}]\\) is \
Protected.\"", 2, 259, 63, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926089033*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"a1a77aba-c79c-468e-a571-4f8b26684c0d"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926093226*^9},
 CellLabel->
  "Out[259]=",ExpressionUUID->"59cfd0b4-56ea-4291-9a1b-01048ea03646"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"f_T\\\", \\\"?\\\", \\\"mC\\\"}], \\\",\\\", \
RowBox[{\\\"g_T\\\", \\\"?\\\", \\\"nMC\\\"}]}], \\\"]\\\"}]\\) is Protected.\
\"", 2, 260, 64, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.93643392609442*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"654f0cfe-3b5c-412a-891b-75183afe9573"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926099324*^9},
 CellLabel->
  "Out[260]=",ExpressionUUID->"72f9a69f-121e-4047-814f-840994c18544"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"f_T\\\", \\\"?\\\", \\\"nMC\\\"}], \\\",\\\", \
RowBox[{\\\"g_T\\\", \\\"?\\\", \\\"nMC\\\"}]}], \\\"]\\\"}]\\) is Protected.\
\"", 2, 261, 65, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926100646*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"1dbd7cc4-fbac-44ad-94f9-64497c7cb01f"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926104774*^9},
 CellLabel->
  "Out[261]=",ExpressionUUID->"eaa65403-3dd0-49cb-a03f-67bc917893ed"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", \
RowBox[{\\\"f_Plus\\\", \\\",\\\", \\\"g_\\\"}], \\\"]\\\"}]\\) is Protected.\
\"", 2, 262, 66, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926105968*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"0b47c0ff-d7f6-4e37-aa40-4e24f0bd644e"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339261100903`*^9},
 CellLabel->
  "Out[262]=",ExpressionUUID->"012e26c3-c7c2-4741-88d0-e3381d6f3aee"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"f_\\\", \
\\\",\\\", \\\"g_Plus\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 263, 67, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926111257*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"d208b1ad-9466-4a1f-a340-99ed4aab122a"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339261152487`*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"31f0eb03-050e-418b-ac2e-e994c930d3ce"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"f_Times\\\
\", \\\",\\\", \\\"g_\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 264, 68, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926116391*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"4186e2af-cfd7-488b-81a0-7c5ad71a99e0"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926120385*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"dfbea743-1e14-4ed8-b96b-417be00342a2"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"f_\\\", \
\\\",\\\", \\\"g_Times\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 265, 69, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339261215363`*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"70a9c385-04cc-414e-9d53-6b402f8cee39"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926125661*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"5b405a39-5136-4cd3-90e7-74199b181190"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"\
\[DoubleStruckCapitalI]\\\", \\\",\\\", \\\"g_\\\"}], \\\"]\\\"}]\\) is \
Protected.\"", 2, 266, 70, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339261268167`*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"e48b5ea6-a31d-44e5-a5dd-76462f1caa0c"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.93643392613094*^9},
 CellLabel->
  "Out[266]=",ExpressionUUID->"3555b5ed-ee36-4f8c-9741-8b3b01b95e47"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"g_\\\", \
\\\",\\\", \\\"\[DoubleStruckCapitalI]\\\"}], \\\"]\\\"}]\\) is Protected.\"",
    2, 267, 71, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926132101*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"b7caafe6-623d-453c-acd9-e76484b74267"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926136273*^9},
 CellLabel->
  "Out[267]=",ExpressionUUID->"f24a0a85-826f-425f-8f65-5f87eb56f790"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"f1_\\\", \
\\\",\\\", \\\"f2_\\\", \\\",\\\", \\\"g__\\\"}], \\\"]\\\"}]\\) is \
Protected.\"", 2, 268, 72, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926137446*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"9ec3b056-50e8-4efe-b34d-23277b6e8246"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339261415157`*^9},
 CellLabel->
  "Out[268]=",ExpressionUUID->"c7d4cd7d-98f7-4692-a9bb-ffa0221195da"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", \\\"g_T\\\", \
\\\"]\\\"}]\\) is Protected.\"", 2, 269, 73, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926142682*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"8bb7e45c-541a-433a-b468-550bbf191651"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926146707*^9},
 CellLabel->
  "Out[269]=",ExpressionUUID->"a33562fb-223c-4d00-ac96-74c6246c7a42"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"f_GT\\\", \
\\\",\\\", \\\"g_GT\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 270, 74, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339261478662`*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"97d13e4a-ea40-40cd-a9c2-02d95704ea5a"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.9364339261519337`*^9},
 CellLabel->
  "Out[270]=",ExpressionUUID->"ab7df680-8e5f-4655-bdf1-113c0f6ae573"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[FivePointedStar]\\\", \\\"[\\\", RowBox[{\\\"f_ET\\\", \
\\\",\\\", \\\"g_ET\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 271, 75, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926153101*^9},
 CellLabel->
  "During evaluation of \
In[257]:=",ExpressionUUID->"bbd58e3a-710b-4d70-9287-bd60f3cad216"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926157157*^9},
 CellLabel->
  "Out[271]=",ExpressionUUID->"aec4de4d-e754-49ad-89c4-a77c0aeef08f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[ScriptCapitalK]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalK]", "[", 
   RowBox[{"i_", ",", "0"}], "]"}], ":=", 
  RowBox[{"ET", "[", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", "[", "i", "]"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalK]", "[", 
   RowBox[{"i_", ",", "1"}], "]"}], ":=", 
  RowBox[{"ET", "[", 
   RowBox[{
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "i", "}"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.867034710461698*^9, 3.867034734322834*^9}, {
  3.867034887191278*^9, 3.867034888550497*^9}, {3.867035650819004*^9, 
  3.867035785291233*^9}, {3.867035967475918*^9, 3.867035977673946*^9}, {
  3.867036209889843*^9, 3.867036210042486*^9}, {3.867038880754631*^9, 
  3.867038886704546*^9}, {3.867038973711566*^9, 3.867039008424569*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"88067925-6de4-4adf-b660-fee27f053564"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"\[ScriptCapitalK]\\\"}]\\) is Protected.\"",
    2, 272, 76, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339261768436`*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"83fbb123-50d0-488d-aca4-e4ef08fb01ff"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[ScriptCapitalK]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[ScriptCapitalK]\\\", \\\"[\\\", RowBox[{\\\"i_\\\", \\\
\",\\\", \\\"0\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 273, 77, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926178027*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"f13a9c7a-ec5d-4c68-9a6a-0c855a893890"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926182754*^9},
 CellLabel->
  "Out[273]=",ExpressionUUID->"7339511a-f24c-4699-af03-71909b57b805"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[ScriptCapitalK]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[ScriptCapitalK]\\\", \\\"[\\\", RowBox[{\\\"i_\\\", \\\
\",\\\", \\\"1\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 274, 78, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926183947*^9},
 CellLabel->
  "During evaluation of \
In[272]:=",ExpressionUUID->"a26cb03b-2b4e-4e35-a8a5-52d955121663"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926188929*^9},
 CellLabel->
  "Out[274]=",ExpressionUUID->"4be13ae5-7010-4a32-8e6f-6f8374fd7972"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalOmega]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{"f", ",", "g"}], "]"}], "-", 
   RowBox[{"\[FivePointedStar]", "[", 
    RowBox[{"g", ",", "f"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{"f1_", ",", "f2_", ",", "g__"}], "]"}], ":=", 
  RowBox[{"\[CapitalOmega]", "[", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", 
     RowBox[{"f1", ",", "f2"}], "]"}], ",", "g"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.863907801646339*^9, 3.8639078028123903`*^9}, {
  3.863907970708768*^9, 3.863907973951502*^9}, {3.8639080934595346`*^9, 
  3.8639081472676373`*^9}, {3.863908180432868*^9, 3.8639082452117853`*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"441bd8c5-3adf-43ab-bfb6-e9a8ffcdce3e"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"\[CapitalOmega]\\\"}]\\) is Protected.\"", 
   2, 275, 79, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926195888*^9},
 CellLabel->
  "During evaluation of \
In[275]:=",ExpressionUUID->"c38746c4-a21b-43e9-afbb-a04cc5816bd0"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalOmega]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalOmega]\\\", \\\"[\\\", RowBox[{\\\"f_\\\", \
\\\",\\\", \\\"g_\\\"}], \\\"]\\\"}]\\) is Protected.\"", 2, 276, 80, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926197033*^9},
 CellLabel->
  "During evaluation of \
In[275]:=",ExpressionUUID->"dbec5e4a-6544-4435-b544-b193d2eef54a"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926201717*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"29284c27-d1f2-4317-8d1b-2d4553e0ee1c"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalOmega]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalOmega]\\\", \\\"[\\\", RowBox[{\\\"f1_\\\", \
\\\",\\\", \\\"f2_\\\", \\\",\\\", \\\"g__\\\"}], \\\"]\\\"}]\\) is \
Protected.\"", 2, 277, 81, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.9364339262029552`*^9},
 CellLabel->
  "During evaluation of \
In[275]:=",ExpressionUUID->"3f4c8dd0-fe12-4353-8de5-ce2e482092f1"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.93643392620721*^9},
 CellLabel->
  "Out[277]=",ExpressionUUID->"f255960e-8e22-417a-a52c-9f85459fa05a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "S", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "f_T", "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "f", "]"}], ">", "1"}], ",", 
     RowBox[{
      RowBox[{"-", "f"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"\[FivePointedStar]", "[", 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{"f", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "i"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ";;", 
             RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}]}], "]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "f", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"-", "f"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "gg___", "]"}], ":>", 
    RowBox[{"T", "@@", 
     RowBox[{"(", 
      RowBox[{"Sort", "/@", 
       RowBox[{"{", "gg", "}"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "f_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", "S"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "f_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", "S"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", "\[DoubleStruckCapitalI]", "]"}], ":=", 
  "\[DoubleStruckCapitalI]"}]}], "Input",
 CellChangeTimes->{{3.856341767589827*^9, 3.856341787236245*^9}, 
   3.856342993267667*^9, {3.856343662477735*^9, 3.856343842104086*^9}, {
   3.856343977685211*^9, 3.856343979034301*^9}, {3.856344572414899*^9, 
   3.856344601934135*^9}, {3.8563452884732933`*^9, 3.856345292677517*^9}, {
   3.856345663314186*^9, 3.85634567551547*^9}, {3.85640337999352*^9, 
   3.8564033825549173`*^9}, {3.856412697206216*^9, 3.856412739952289*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"cc89f358-78bf-40fe-962a-c94d366446b3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\[CapitalDelta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_T", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "f", "]"}], ">", "1"}], ",", 
    RowBox[{
     RowBox[{"CircleTimes", "[", 
      RowBox[{"\[DoubleStruckCapitalI]", ",", "f"}], "]"}], "+", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"f", ",", "\[DoubleStruckCapitalI]"}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"CircleTimes", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "i"}], "]"}], "]"}], ",", 
          RowBox[{"f", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ";;", 
             RowBox[{"Length", "[", "f", "]"}]}], "]"}], "]"}]}], "]"}], "//",
         "ExpandCT"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "[", "f", "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
    ",", 
    RowBox[{
     RowBox[{"CircleTimes", "[", 
      RowBox[{"\[DoubleStruckCapitalI]", ",", "f"}], "]"}], "+", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"f", ",", "\[DoubleStruckCapitalI]"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[CapitalDelta]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_Times", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"NonCommutativeMultiply", "[", "f", "]"}], "//", "ExpandNCM"}], 
    ")"}], "/.", 
   RowBox[{
   "NonCommutativeMultiply", "->", " ", 
    "\[CapitalDelta]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "f_GT", "]"}], ":=", 
  RowBox[{
   RowBox[{"\[CapitalDelta]", "[", 
    RowBox[{"T", "@@", 
     RowBox[{"f", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"T", "[", "h__", "]"}], ":>", 
    RowBox[{"GT", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", "h", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "[", "\[DoubleStruckCapitalI]", "]"}], ":=", 
  RowBox[{"CircleTimes", "[", 
   RowBox[{"\[DoubleStruckCapitalI]", ",", "\[DoubleStruckCapitalI]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.856344692802022*^9, 3.856344861263785*^9}, {
   3.856344903038559*^9, 3.856344946890854*^9}, {3.856345431300519*^9, 
   3.856345435091799*^9}, {3.856345529021326*^9, 3.8563455420262012`*^9}, 
   3.856345847718631*^9, {3.8563459495745363`*^9, 3.856345952867259*^9}, {
   3.856403387620563*^9, 3.856403400466671*^9}, {3.863838141446711*^9, 
   3.8638381421102953`*^9}, {3.863838372108491*^9, 3.86383837563701*^9}, {
   3.864021127405699*^9, 3.864021151348419*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"1485dcfb-cc31-40fb-a75c-a3b44fa8a20c"],

Cell[BoxData[
 TemplateBox[{
  "ClearAll", "wrsym", 
   "\"Symbol \\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\"}]\\) is Protected.\"", 
   2, 283, 82, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926233892*^9},
 CellLabel->
  "During evaluation of \
In[283]:=",ExpressionUUID->"0b0fb4bb-49cf-4165-8ca5-d7b25187004f"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\", \\\"[\\\", \\\"f_T\\\", \\\"]\\\"}]\
\\) is Protected.\"", 2, 284, 83, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926235046*^9},
 CellLabel->
  "During evaluation of \
In[283]:=",ExpressionUUID->"727036b8-6f8c-44f6-8af3-52a87e495f97"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926240361*^9},
 CellLabel->
  "Out[284]=",ExpressionUUID->"fea8bf94-bd9b-4bab-b617-b33ac17e7674"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\", \\\"[\\\", \\\"f_Plus\\\", \
\\\"]\\\"}]\\) is Protected.\"", 2, 285, 84, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926241643*^9},
 CellLabel->
  "During evaluation of \
In[283]:=",ExpressionUUID->"c3b8b1a9-5b18-4831-914b-a0682438c81b"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926245821*^9},
 CellLabel->
  "Out[285]=",ExpressionUUID->"dcb6f69c-4dc1-4f6e-8c69-4ec82dd7ee82"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\", \\\"[\\\", \\\"f_Times\\\", \\\"]\\\
\"}]\\) is Protected.\"", 2, 286, 85, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926247057*^9},
 CellLabel->
  "During evaluation of \
In[283]:=",ExpressionUUID->"aa97f30f-401f-43a2-ad8e-98e5bf1988c9"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926251219*^9},
 CellLabel->
  "Out[286]=",ExpressionUUID->"df4ecaeb-d008-4758-8b03-80ca17e69cd3"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\", \\\"[\\\", \\\"f_GT\\\", \
\\\"]\\\"}]\\) is Protected.\"", 2, 287, 86, 33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926252448*^9},
 CellLabel->
  "During evaluation of \
In[283]:=",ExpressionUUID->"3d59fa97-780b-45fd-8da7-6b33c1fd0781"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926256589*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"d4fc890f-fe4a-492e-8872-91dee726c96b"],

Cell[BoxData[
 TemplateBox[{
  "SetDelayed", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\"}]\\) in \
\\!\\(\\*RowBox[{\\\"\[CapitalDelta]\\\", \\\"[\\\", \\\"\
\[DoubleStruckCapitalI]\\\", \\\"]\\\"}]\\) is Protected.\"", 2, 288, 87, 
   33702394991915530185, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.936433926257814*^9},
 CellLabel->
  "During evaluation of \
In[283]:=",ExpressionUUID->"83b00423-f837-449d-bf51-d6ed21e6dfbf"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.936433926262068*^9},
 CellLabel->
  "Out[288]=",ExpressionUUID->"8703b9f7-1f2a-49bf-b504-a8cd17fad3ab"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"picCTR", ",", "picCTL"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picCTR", "[", "ls_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"f__", ",", "g_"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"g", "===", "\[DoubleStruckCapitalI]"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"List", "@@", "g"}], "]"}], "]"}], "=!=", "ls"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picCTL", "[", "ls_", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"g_", ",", "f__"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{
     RowBox[{"g", "===", "\[DoubleStruckCapitalI]"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"List", "@@", "g"}], "]"}], "]"}], "=!=", "ls"}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"picTR", ",", "picTL"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picTR", "[", "h_T", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"f__", ",", "g_"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{"g", "=!=", "h"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"picTL", "[", "h_T", "]"}], ":=", 
  RowBox[{
   RowBox[{"CircleTimes", "[", 
    RowBox[{"g_", ",", "f__"}], "]"}], ":>", " ", 
   RowBox[{"0", "/;", 
    RowBox[{"g", "=!=", "h"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.856399620803289*^9, 3.856399698507834*^9}, {
   3.856399731098884*^9, 3.856399745574304*^9}, {3.8563998310084057`*^9, 
   3.856399858003364*^9}, {3.8563998906339417`*^9, 3.856399955720414*^9}, {
   3.856400695446101*^9, 3.856400754295403*^9}, {3.856400809950757*^9, 
   3.8564008280537863`*^9}, {3.856403410367573*^9, 3.8564034127158003`*^9}, 
   3.856413007279652*^9},
 CellLabel->
  "In[289]:=",ExpressionUUID->"109aa14b-d071-455f-85a8-485af7850572"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"CtCut", ",", "CTCut"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CtCut", "[", "f__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", 
       RowBox[{"{", "f", "}"}]}], ",", "phat", ",", "leftv", ",", "num", ",", 
      "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"od", ",", "\[DoubleStruckCapitalI]"}], "]"}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"First", "[", 
              RowBox[{"Min", "[", 
               RowBox[{
               "od", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"leftv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"od", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CTCut", "[", "f__", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"CtCut", "@@", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", "f", "}"}], "/.", 
        RowBox[{
         RowBox[{"T", "[", "g__", "]"}], ":>", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "g", "}"}], "]"}]}]}], ")"}], ")"}]}], ")"}], 
   RowBox[{"Times", "[", "f", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.864013314707815*^9, 3.864013418131531*^9}, {
   3.864013449310534*^9, 3.864013473661511*^9}, {3.864013650450053*^9, 
   3.864013676242391*^9}, 3.864015042182406*^9, {3.8641022729568253`*^9, 
   3.864102294335894*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"6081fdd3-4eb3-431d-9d57-c725f3951126"],

Cell[CellGroupData[{

Cell[BoxData["SortBy"], "Input",
 CellChangeTimes->{{3.864102055014082*^9, 3.864102059338228*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"6734054c-f8df-4c5f-b05e-e13ef842e031"],

Cell[BoxData["SortBy"], "Output",
 CellChangeTimes->{
  3.864362867467437*^9, 3.8643661473169193`*^9, 3.8644740979111977`*^9, 
   3.8648751019430656`*^9, 3.866677314817376*^9, 3.867033771183186*^9, 
   3.867034862126466*^9, {3.867035598829199*^9, 3.867035625385405*^9}, 
   3.8681693882266903`*^9, 3.868169437673685*^9, 3.868607315104979*^9, 
   3.936433926328814*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"1abd5b21-ae5f-4000-bd8b-777e50bdda7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MinimalBy", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "4", ",", "1"}], "}"}], ",", "#1"}], "]"}],
     "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8641019916314383`*^9, 3.8641019933029833`*^9}, {
  3.864102176828389*^9, 3.8641022493743677`*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"1585890d-e2d6-4f4e-bbf7-b8cea6d4b7d2"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{{3.8641022216069736`*^9, 3.864102235983807*^9}, 
   3.864362867472823*^9, 3.864366147332725*^9, 3.864474097916811*^9, 
   3.864875101948475*^9, 3.866677314824753*^9, 3.867033771189108*^9, 
   3.8670348621346607`*^9, {3.8670355988361683`*^9, 3.867035625391366*^9}, 
   3.8681693882328463`*^9, 3.868169437679203*^9, 3.868607315113391*^9, 
   3.936433926337981*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"bfcfa0e5-c515-4c82-a1e9-76005b85b42e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"GT2Cut", ",", "CT2GT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GT2Cut", "[", 
   RowBox[{"fc_", ",", "fk_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"od", "=", "fk"}], ",", 
      RowBox[{"odc", "=", "fc"}], ",", "phat", ",", "leftv", ",", "num", ",", 
      "den"}], "}"}], ",", 
    RowBox[{
     RowBox[{"phat", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "@", "od"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"phat", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "v"}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{"(*", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"od", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ">", 
          RowBox[{"Max", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], "]"}]}], ","}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"phat", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", 
        RowBox[{"p", "@@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"odc", ",", "#"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"odc", ",", 
                RowBox[{
                 RowBox[{"MinimalBy", "[", 
                  RowBox[{
                   RowBox[{
                   "od", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"odc", ",", "#1"}], "]"}], "&"}]}], "]"}], "//", 
                 "First"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "&"}]}], "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{",", 
          RowBox[{
           RowBox[{"phat", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"p", "@@", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"od", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", "1"}], 
             "]"}]}]}]}], "]"}], "*)"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"leftv", "=", "phat"}], ";", "\[IndentingNewLine]", 
     RowBox[{"num", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"leftv", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{
             RowBox[{"MinimalBy", "[", 
              RowBox[{
               RowBox[{
               "od", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"odc", ",", "#1"}], "]"}], "&"}]}], "]"}], "//", 
             "First"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"den", "=", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"od", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", 
              RowBox[{"(", 
               RowBox[{"i", "-", "1"}], ")"}]}], "\[RightDoubleBracket]"}], 
            "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "@", "od"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"num", "/", "den"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CT2GT", "[", "f__", "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", "f", "}"}], ",", "\[DoubleStruckCapitalI]"}], "]"}], ",", 
    RowBox[{"Return", "[", "0", "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"GT2Cut", "@@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "f", "}"}], "/.", 
             RowBox[{
              RowBox[{"GT", "[", 
               RowBox[{"c_", ",", "g_"}], "]"}], ":>", "c"}]}], ")"}], "//", 
           "Union"}], "//", "Flatten"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", "f", "}"}], "/.", 
           RowBox[{
            RowBox[{"GT", "[", 
             RowBox[{"c_", ",", "g_"}], "]"}], ":>", 
            RowBox[{"Flatten", "[", "g", "]"}]}]}], ")"}]}], "}"}]}], ")"}], 
     RowBox[{"Times", "[", "f", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.864005726313146*^9, 3.8640057267126703`*^9}, {
   3.8640073262593*^9, 3.864007336198358*^9}, {3.864012275149953*^9, 
   3.864012305338114*^9}, {3.864012436466858*^9, 3.864012449061061*^9}, {
   3.8640126440948772`*^9, 3.864012667128831*^9}, {3.864014420471593*^9, 
   3.864014467932979*^9}, {3.864014557387258*^9, 3.864014575458349*^9}, {
   3.864016026746132*^9, 3.864016045185341*^9}, {3.8640161247111053`*^9, 
   3.864016129503875*^9}, 3.864016960933386*^9, {3.864017043020999*^9, 
   3.864017060264268*^9}, {3.864017153492383*^9, 3.864017236480606*^9}, {
   3.864017277005508*^9, 3.864017327444517*^9}, {3.864017358098238*^9, 
   3.8640173809283543`*^9}, {3.8640176954876537`*^9, 
   3.8640176969752502`*^9}, {3.864017791410964*^9, 3.864017809265267*^9}, {
   3.864102346196558*^9, 3.864102384095622*^9}, {3.864102448244149*^9, 
   3.864102450679813*^9}, 3.864102624671569*^9},
 CellLabel->
  "In[300]:=",ExpressionUUID->"dcf534f1-3d4f-44fc-973c-a5c1e3eb1583"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalDelta]", "[", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.856345570013097*^9, 3.856345588088924*^9}, {
   3.86382705094645*^9, 3.863827092896261*^9}, {3.863827353985824*^9, 
   3.863827361527443*^9}, {3.863828337562736*^9, 3.863828369771544*^9}, {
   3.8638284240732737`*^9, 3.86382846280264*^9}, {3.863828502545103*^9, 
   3.863828510264798*^9}, {3.863828565378174*^9, 3.863828572412634*^9}, {
   3.863828810177979*^9, 3.8638288388068037`*^9}, 3.863838419527261*^9, {
   3.864013123322544*^9, 3.86401314527297*^9}},
 CellLabel->
  "In[303]:=",ExpressionUUID->"fd0a54cd-2351-4ce9-9e2a-36e47215275e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[DoubleStruckCapitalI]", "\[CircleTimes]", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}], "\[CircleTimes]", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"4", ",", "3"}], "}"}], "}"}]}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3"}], "}"}]}], "}"}]}], "]"}], "\[CircleTimes]", 
   "\[DoubleStruckCapitalI]"}]}]], "Output",
 CellChangeTimes->{
  3.86382883945164*^9, 3.863907051428915*^9, {3.864013129979299*^9, 
   3.864013145988575*^9}, 3.8641016366821213`*^9, 3.86436286749641*^9, 
   3.864366147344948*^9, 3.864474097939362*^9, 3.8648751019692507`*^9, 
   3.866677314845685*^9, 3.867033771213726*^9, 3.867034862159521*^9, {
   3.86703559886001*^9, 3.867035625415627*^9}, 3.868169388257236*^9, 
   3.8681694377001057`*^9, 3.868607315138029*^9, 3.936433926373763*^9},
 CellLabel->
  "Out[303]=",ExpressionUUID->"18c48fbe-dea4-4b55-ab45-cd073ed0b27a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}], "\[CircleTimes]", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], "/.", 
  RowBox[{"CircleTimes", "->", "CT2GT"}]}]], "Input",
 CellChangeTimes->{{3.864102479551299*^9, 3.864102511183682*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"ea5119f4-f7f9-4db1-bdc4-6a8ab5a87518"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", "4", "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"1", ",", "2"}], "]"}]}], "]"}], " ", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}], " ", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}]}], "]"}]}], 
  RowBox[{"dot", "[", 
   RowBox[{"v", ",", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "]"}]]], "Output",
 CellChangeTimes->{{3.864102492500392*^9, 3.8641025273723507`*^9}, 
   3.8641026415989532`*^9, 3.864362867501753*^9, 3.864366147351097*^9, 
   3.8644740979544783`*^9, 3.864875101985063*^9, 3.8666773148590403`*^9, 
   3.867033771231745*^9, 3.867034862180586*^9, {3.867035598865028*^9, 
   3.867035625421728*^9}, 3.868169388276455*^9, 3.868169437716316*^9, 
   3.868607315144485*^9, 3.936433926395186*^9},
 CellLabel->
  "Out[304]=",ExpressionUUID->"e365626c-78f3-40d8-be11-43a9a23d21bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalOmega]", "[", 
  RowBox[{
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "2", "}"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.863830348110487*^9, 3.8638303517092876`*^9}, {
  3.863838209579482*^9, 3.863838217261692*^9}, {3.864001882583105*^9, 
  3.864001924797205*^9}},
 CellLabel->
  "In[305]:=",ExpressionUUID->"15afbb5c-2510-40ae-b3a7-ab109d212069"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"GT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], "+", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}], "+", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}], "+", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], "}"}]}], "]"}], "-", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "2", "}"}]}], "}"}]}], "]"}], "-", 
  RowBox[{"GT", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.8638303522694073`*^9, 3.8638306221846743`*^9, {3.8638381946375723`*^9, 
   3.8638382177073708`*^9}, 3.863838294904525*^9, 3.863907051434423*^9, 
   3.8640018956667833`*^9, 3.864001925871306*^9, 3.864101636687339*^9, 
   3.864362867518488*^9, 3.8643661473662786`*^9, 3.864474097959735*^9, 
   3.8648751019903593`*^9, 3.866677314864687*^9, 3.867033771237236*^9, 
   3.86703486218781*^9, {3.867035598870243*^9, 3.8670356254393387`*^9}, 
   3.868169388283205*^9, 3.868169437722349*^9, 3.868607315151219*^9, 
   3.9364339264040422`*^9},
 CellLabel->
  "Out[305]=",ExpressionUUID->"4ce7d402-643d-4109-9fc4-fd7af7a7f6a1"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Chapter",
 CellChangeTimes->{{3.854428181759294*^9, 
  3.85442818627633*^9}},ExpressionUUID->"33fa4030-ed72-4bf1-ab48-\
7145b1dd9e42"],

Cell[CellGroupData[{

Cell["General BCJ numerator and YMS amplitude", "Section",
 CellChangeTimes->{{3.8564069369813757`*^9, 3.8564069411881237`*^9}, {
  3.856528505387108*^9, 3.856528508392273*^9}, {3.864366397575654*^9, 
  3.8643663998630047`*^9}, {3.864474113286031*^9, 3.864474114889228*^9}, {
  3.8644743167650013`*^9, 3.864474317970113*^9}, {3.864521747019771*^9, 
  3.864521765508876*^9}, {3.8671075959622383`*^9, 3.867107597914331*^9}, {
  3.867130856368524*^9, 3.86713085787368*^9}, {3.9364920011328287`*^9, 
  3.936492022817656*^9}},ExpressionUUID->"46e87e36-11ff-4c31-b68c-\
9175983751c8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"numpreP", "=", 
    RowBox[{"\[FivePointedStar]", "@@", 
     RowBox[{"(", 
      RowBox[{"T", "/@", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "n"}], "]"}]}]}], ")"}]}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"bpeff2", "=", 
  RowBox[{"BinaryProduct", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nod", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"numpreP", "/.", 
        RowBox[{"T", "->", "TScalar"}]}], "/.", "rmzero"}], "/.", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"f1_", ",", "g__"}], "]"}], ":>", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"p", "/@", 
         RowBox[{"{", 
          RowBox[{"f1", ",", "g"}], "}"}]}], "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
    RowBox[{
     RowBox[{"F", "[", "i_", "]"}], ":>", " ", 
     RowBox[{"F", "[", 
      RowBox[{"p", "[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numList", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpandNCM", "/@", 
      RowBox[{"(", 
       RowBox[{"bpeff2", "/.", 
        RowBox[{"X", "\[Rule]", " ", "NC"}]}], ")"}]}], "/.", 
     RowBox[{"NonCommutativeMultiply", "\[Rule]", " ", "T"}]}], "/.", 
    RowBox[{
     RowBox[{"T", "[", 
      RowBox[{"i1_", ",", "f___"}], "]"}], ":>", " ", 
     RowBox[{"0", "/;", 
      RowBox[{"i1", "\[NotEqual]", "1"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{"numList", "/.", 
    RowBox[{
     RowBox[{"T", "[", "f___", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"(", 
      RowBox[{"nod", "/.", 
       RowBox[{"replace", "[", 
        RowBox[{
         RowBox[{"p", "/@", 
          RowBox[{"{", "f", "}"}]}], ",", 
         RowBox[{"n", "+", "1"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numListL", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"numListL", "/.", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
       RowBox[{"F", "[", "i", "]"}]}]}], ")"}], "//", "Expand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PPList", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"bpeff2", "/.", 
       RowBox[{"(", 
        RowBox[{"i_", "\[RuleDelayed]", " ", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "/;", 
          RowBox[{"IntegerQ", "[", "i", "]"}]}]}], ")"}]}], "/.", 
      RowBox[{"X", "\[Rule]", " ", "PG"}]}], ")"}], "/", 
    RowBox[{"P", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"p", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.863908632376007*^9, 3.8639089921278954`*^9, 3.863909538258716*^9, 
   3.864092638866745*^9, 3.864362957235798*^9, {3.8643645371336527`*^9, 
   3.864364537299149*^9}, {3.864429924518302*^9, 3.864429924657095*^9}, {
   3.8644304907115383`*^9, 3.86443053910989*^9}, {3.864430575285963*^9, 
   3.864430575736898*^9}, {3.8644306131719923`*^9, 3.864430637096447*^9}, 
   3.86452122642413*^9, {3.936437327665132*^9, 3.936437331888867*^9}, {
   3.9364376191981697`*^9, 3.9364376842221193`*^9}, {3.936437964644648*^9, 
   3.93643796519695*^9}, {3.9364878256442947`*^9, 3.936487826869771*^9}, {
   3.9364882722415113`*^9, 3.936488273526972*^9}},
 CellLabel->
  "In[576]:=",ExpressionUUID->"58533ddb-9408-40c9-b61f-fc317f07bc29"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00169`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.863909538767284*^9, 3.863910117976581*^9, 3.864000935756377*^9, 
   3.864001211803432*^9, 3.864001979774987*^9, 3.864002150385695*^9, 
   3.864019167677395*^9, 3.864092639508335*^9, 3.864102652929594*^9, 
   3.8641951550869226`*^9, {3.8643629296357527`*^9, 3.864362958183241*^9}, 
   3.864364487748992*^9, 3.8643645379322357`*^9, 3.864366153604473*^9, 
   3.864429891171723*^9, {3.86442992525119*^9, 3.8644299444680233`*^9}, {
   3.864430523866461*^9, 3.8644305424215717`*^9}, {3.864430623231099*^9, 
   3.864430637817705*^9}, 3.8644741215423927`*^9, 3.864474329007594*^9, 
   3.864474894201754*^9, 3.864474967902459*^9, 3.864474999861784*^9, 
   3.8644756457692842`*^9, 3.864521231530431*^9, 3.864521468116156*^9, 
   3.8645215254156733`*^9, 3.864521814311811*^9, 3.9364368528410883`*^9, 
   3.9364373331066103`*^9, 3.936437619985187*^9, {3.936437652484913*^9, 
   3.9364376848252373`*^9}, 3.936437965764419*^9, 3.936487828399023*^9, 
   3.936488275235464*^9},
 CellLabel->
  "Out[577]=",ExpressionUUID->"e4263e28-3795-4711-8a4f-6d53f78e1672"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"1", ",", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.863909538767284*^9, 3.863910117976581*^9, 3.864000935756377*^9, 
   3.864001211803432*^9, 3.864001979774987*^9, 3.864002150385695*^9, 
   3.864019167677395*^9, 3.864092639508335*^9, 3.864102652929594*^9, 
   3.8641951550869226`*^9, {3.8643629296357527`*^9, 3.864362958183241*^9}, 
   3.864364487748992*^9, 3.8643645379322357`*^9, 3.864366153604473*^9, 
   3.864429891171723*^9, {3.86442992525119*^9, 3.8644299444680233`*^9}, {
   3.864430523866461*^9, 3.8644305424215717`*^9}, {3.864430623231099*^9, 
   3.864430637817705*^9}, 3.8644741215423927`*^9, 3.864474329007594*^9, 
   3.864474894201754*^9, 3.864474967902459*^9, 3.864474999861784*^9, 
   3.8644756457692842`*^9, 3.864521231530431*^9, 3.864521468116156*^9, 
   3.8645215254156733`*^9, 3.864521814311811*^9, 3.9364368528410883`*^9, 
   3.9364373331066103`*^9, 3.936437619985187*^9, {3.936437652484913*^9, 
   3.9364376848252373`*^9}, 3.936437965764419*^9, 3.936487828399023*^9, 
   3.936488275238072*^9},
 CellLabel->
  "Out[578]=",ExpressionUUID->"3d5e85c5-cdba-4643-ab26-e21c595e39e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nod", "//.", "nice"}]], "Input",
 CellChangeTimes->{{3.9364880211250134`*^9, 3.936488035922154*^9}},
 CellLabel->
  "In[584]:=",ExpressionUUID->"7b683a52-acd5-456b-9d9d-ae02967f757e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["F", 
         SubscriptBox["p", "3"]], "\[CenterDot]", 
        SubscriptBox["p", "0"]}], "+", 
       RowBox[{
        SubscriptBox["p", "2"], "\[CenterDot]", 
        SubscriptBox["F", 
         SubscriptBox["p", "3"]], "\[CenterDot]", 
        SubscriptBox["p", "0"]}]}], ")"}], " ", 
     RowBox[{
      SubscriptBox["p", "0"], "\[CenterDot]", 
      SubscriptBox["F", 
       SubscriptBox["p", "1"]], "\[CenterDot]", 
      SubscriptBox["F", 
       SubscriptBox["p", "2"]], "\[CenterDot]", 
      SubscriptBox["p", "0"]}]}], 
    RowBox[{
     RowBox[{
      SubscriptBox["p", "0"], "\[CenterDot]", 
      SubscriptBox["p", "1"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "0"], "\[CenterDot]", 
           SubscriptBox["p", "1"]}], "+", 
          RowBox[{
           SubscriptBox["p", "0"], "\[CenterDot]", 
           SubscriptBox["p", "2"]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SubscriptBox["p", "1"], "\[CenterDot]", 
         SubscriptBox["p", "2"]}]}]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", 
        SubscriptBox["p", "2"]], "\[CenterDot]", 
       SubscriptBox["p", "0"]}], "+", 
      RowBox[{
       SubscriptBox["p", "1"], "\[CenterDot]", 
       SubscriptBox["F", 
        SubscriptBox["p", "2"]], "\[CenterDot]", 
       SubscriptBox["p", "3"]}]}], ")"}], " ", 
    RowBox[{
     SubscriptBox["p", "0"], "\[CenterDot]", 
     SubscriptBox["F", 
      SubscriptBox["p", "1"]], "\[CenterDot]", 
     SubscriptBox["F", 
      SubscriptBox["p", "3"]], "\[CenterDot]", 
     SubscriptBox["p", "0"]}]}], 
   RowBox[{
    RowBox[{
     SubscriptBox["p", "0"], "\[CenterDot]", 
     SubscriptBox["p", "1"]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["p", "0"], "\[CenterDot]", 
          SubscriptBox["p", "1"]}], "+", 
         RowBox[{
          SubscriptBox["p", "0"], "\[CenterDot]", 
          SubscriptBox["p", "3"]}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SubscriptBox["p", "1"], "\[CenterDot]", 
        SubscriptBox["p", "3"]}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["p", "0"], "\[CenterDot]", 
    SubscriptBox["F", 
     SubscriptBox["p", "1"]], "\[CenterDot]", 
    SubscriptBox["F", 
     SubscriptBox["p", "2"]], "\[CenterDot]", 
    SubscriptBox["F", 
     SubscriptBox["p", "3"]], "\[CenterDot]", 
    SubscriptBox["p", "0"]}], 
   RowBox[{
    SubscriptBox["p", "0"], "\[CenterDot]", 
    SubscriptBox["p", "1"]}]]}]], "Output",
 CellChangeTimes->{{3.9364376357267017`*^9, 3.936437661081862*^9}, {
   3.936488022606265*^9, 3.936488037256432*^9}, 3.936488280376549*^9},
 CellLabel->
  "Out[584]=",ExpressionUUID->"1f77f5ba-19b9-476f-9099-bac745b5f0df"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Amp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"numListL", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/", 
        RowBox[{"PPList", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "PPList"}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"P", "[", "f_", "]"}], ":>", "f"}]}], "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", 
     RowBox[{"0", "/;", 
      RowBox[{"i", ">", "0"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.864363698153947*^9, 3.864363707774523*^9}, {
   3.864363797669764*^9, 3.864363833077093*^9}, 3.8643641156160793`*^9, {
   3.864365278055747*^9, 3.864365300837401*^9}, 3.864366174226077*^9, {
   3.8644306445293694`*^9, 3.86443070606489*^9}, 3.86452153564714*^9},
 CellLabel->
  "In[585]:=",ExpressionUUID->"14af6ed1-df99-4957-a313-4b674b22c3ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmpAlg", "=", 
   RowBox[{"Amp", "//", "expandFDirect"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.86443074161694*^9, 3.864430752566854*^9}, {
  3.864430811498796*^9, 3.8644308120650473`*^9}, {3.9364372394708643`*^9, 
  3.936437244379445*^9}, {3.936437948849599*^9, 3.936437949429124*^9}},
 CellLabel->
  "In[586]:=",ExpressionUUID->"cd1731c1-c745-4326-bf8d-e365e5ba5b27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AmpFeyn", "=", 
   RowBox[{
    RowBox[{"TwoScalarAmp", "[", "n", "]"}], "/.", 
    RowBox[{
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"p", "[", "i_", "]"}], "]"}], ":>", " ", 
     RowBox[{"\[Epsilon]", "[", "i", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.864430793666795*^9, 3.864430817359805*^9}, 
   3.864430853129808*^9, 3.8644309295555353`*^9, {3.864431390606019*^9, 
   3.8644314036867437`*^9}, 3.864433128116868*^9, 3.864447579411282*^9, 
   3.864447802692786*^9, 3.8644743624880943`*^9},
 CellLabel->
  "In[587]:=",ExpressionUUID->"5cffdd3a-2da2-4275-81bf-8843becae3de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res1", "=", 
   RowBox[{"AmpAlg", "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"onshellQCD", "[", 
       RowBox[{"n", "+", "1"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.864430823146852*^9, 3.8644308272009172`*^9}, {
  3.8644309581473217`*^9, 3.8644309589736433`*^9}, {3.86443110803159*^9, 
  3.864431108648315*^9}, {3.864447842570281*^9, 3.86444784417139*^9}, {
  3.864474352512549*^9, 3.8644743603020487`*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"c0305c13-cb5b-4078-abf7-3cc4ab402e2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"res2", "=", 
   RowBox[{"AmpFeyn", "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"onshellQCD", "[", 
       RowBox[{"n", "+", "1"}], "]"}], "/.", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"i_", ",", "j_"}], "]"}], ":>", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}], ")"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.864447587354487*^9, 3.86444758883022*^9}, {
  3.864447619128355*^9, 3.864447635780517*^9}, {3.8644478214474993`*^9, 
  3.864447847880803*^9}, {3.864474368790513*^9, 3.8644743742031*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"aec3ed12-97f7-408e-ba01-e8932dd22eba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"res1", "-", " ", "res2"}], "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "i_", "]"}], ",", 
      RowBox[{"p", "[", "j_", "]"}]}], "]"}], ":>", 
    RowBox[{
     RowBox[{"10", "i"}], "+", "j"}]}]}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.864447852883913*^9, 3.864447861246121*^9}, {
   3.864474387994504*^9, 3.864474432689089*^9}, 3.86447462732898*^9, {
   3.864521357579041*^9, 3.8645213582453833`*^9}, {3.864521495435135*^9, 
   3.864521496117071*^9}, {3.8645217123132477`*^9, 3.864521728968398*^9}, {
   3.936437063646533*^9, 3.936437091424518*^9}, 3.936437676932726*^9},
 CellLabel->
  "In[590]:=",ExpressionUUID->"5d2dbdb3-26c5-40cb-9d4c-d262da37b424"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.864447857352478*^9, 3.864447861623569*^9}, 
   3.86447428684757*^9, {3.864474379915118*^9, 3.8644743895334797`*^9}, {
   3.864474427263461*^9, 3.864474433202026*^9}, 3.864474627864303*^9, 
   3.8645213336716537`*^9, 3.864521369019969*^9, {3.8645214856566057`*^9, 
   3.8645214975575943`*^9}, {3.8645217100320683`*^9, 3.864521730566147*^9}, 
   3.864524539012347*^9, {3.936437073293627*^9, 3.936437093166794*^9}, {
   3.936437673993195*^9, 3.93643767756775*^9}, 3.936437716422114*^9, 
   3.936437959281546*^9, 3.936438084243774*^9, 3.936487849085878*^9, 
   3.93648831780547*^9},
 CellLabel->
  "Out[590]=",ExpressionUUID->"deff1f51-1fa0-4bc0-be3c-bd90474a92cf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1019, 796},
WindowMargins->{{20, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"30cf57ec-0df1-46ea-bf08-d5eeac610284"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 87, "Section",ExpressionUUID->"14683071-943c-4012-bcab-810b516799fe"],
Cell[CellGroupData[{
Cell[766, 29, 630, 10, 78, "Input",ExpressionUUID->"63b04dbe-df92-4309-b176-b1a6da73bcf5"],
Cell[1399, 41, 262, 4, 51, "Output",ExpressionUUID->"4e3f3971-efcc-479e-84c3-435281ff5b3d"],
Cell[1664, 47, 764, 15, 116, "Print",ExpressionUUID->"16e51e20-a1a4-454b-8317-d54a5f7c2ce8"]
}, Open  ]],
Cell[2443, 65, 217, 4, 43, "Text",ExpressionUUID->"efa4edab-1682-4823-b682-9d89a1db6ee6"],
Cell[CellGroupData[{
Cell[2685, 73, 1319, 28, 130, "Input",ExpressionUUID->"0b95de27-aa10-41ff-8c11-306948bffc6e"],
Cell[CellGroupData[{
Cell[4029, 105, 1089, 17, 29, "Print",ExpressionUUID->"44a198dc-fd6c-473d-b62a-f00957808d66"],
Cell[5121, 124, 1099, 17, 29, "Print",ExpressionUUID->"2d8032d5-6d8c-4375-8a5c-4edf7415f065"],
Cell[6223, 143, 1091, 17, 29, "Print",ExpressionUUID->"85f602a4-1a64-402a-9b08-80dccce93009"],
Cell[7317, 162, 1103, 18, 29, "Print",ExpressionUUID->"a767b95b-de16-4f8b-9766-22df0489c890"],
Cell[8423, 182, 1096, 17, 29, "Print",ExpressionUUID->"3fe2e1d5-19d6-4698-a54a-ddb67d8a6225"],
Cell[9522, 201, 1112, 18, 29, "Print",ExpressionUUID->"06230f49-1443-4b00-9fe3-2170eaf1cb14"],
Cell[10637, 221, 1089, 17, 29, "Print",ExpressionUUID->"52cb5ae4-23b4-4efb-8385-6f1548fc2416"],
Cell[11729, 240, 1099, 17, 29, "Print",ExpressionUUID->"ffba3feb-4fee-43aa-b58a-2bb347dbc9f6"],
Cell[12831, 259, 1110, 18, 29, "Print",ExpressionUUID->"263aa773-8b9a-4689-85b4-52bfa70bb925"],
Cell[13944, 279, 1108, 18, 29, "Print",ExpressionUUID->"89532f42-b4d5-436f-97b4-d215522436f6"],
Cell[15055, 299, 1110, 18, 29, "Print",ExpressionUUID->"ec2df2d8-0500-44a9-b62d-7c69320d9ff5"],
Cell[16168, 319, 1108, 18, 29, "Print",ExpressionUUID->"9e0de6ee-a369-45dd-963c-e436a0e608d4"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17337, 344, 159, 3, 86, "Chapter",ExpressionUUID->"6f54012d-343c-4ceb-b753-c573c7d67539"],
Cell[CellGroupData[{
Cell[17521, 351, 157, 3, 87, "Section",ExpressionUUID->"51c8b79b-932a-4bdd-86b8-9f06849e255f"],
Cell[17681, 356, 7219, 159, 322, "Input",ExpressionUUID->"55360a2d-4dd7-400f-a70c-a61b9360a901"],
Cell[24903, 517, 1665, 51, 182, "Input",ExpressionUUID->"db980e6f-c9eb-40df-82ed-d128a8cd4e6a"],
Cell[26571, 570, 4835, 117, 182, "Input",ExpressionUUID->"353b453e-7fe1-4c88-9e64-e211a751f1d3"],
Cell[31409, 689, 4532, 136, 442, "Input",ExpressionUUID->"d39168db-af52-466a-8c1c-3dce7bdae539"],
Cell[35944, 827, 1177, 31, 104, "Input",ExpressionUUID->"efe94482-f280-4b66-8aa3-fed140d0cead"],
Cell[37124, 860, 2355, 73, 182, "Input",ExpressionUUID->"df94535a-4cf7-400a-8f0d-bc011efc1341"],
Cell[39482, 935, 1201, 36, 156, "Input",ExpressionUUID->"e91fa3ea-9348-4961-b522-401ec5557bd8"],
Cell[40686, 973, 2536, 68, 208, "Input",ExpressionUUID->"66e83810-5681-4752-bf3a-11426cdcbc6b"],
Cell[43225, 1043, 1688, 52, 156, "Input",ExpressionUUID->"01c993fa-ade8-4950-82a8-f3dc7b951d13"],
Cell[44916, 1097, 1213, 29, 104, "Input",ExpressionUUID->"cc5f4918-d6f8-4850-bf9f-ee49c7cde23b"],
Cell[46132, 1128, 1231, 33, 104, "Input",ExpressionUUID->"4ca1da07-81cb-4631-88a9-f703a50b34d5"],
Cell[47366, 1163, 615, 17, 78, "Input",ExpressionUUID->"4b80cfac-5cc6-4749-b1cb-94688ff33281"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48018, 1185, 251, 4, 87, "Section",ExpressionUUID->"cfb31aa4-4c33-47e3-9314-40b147b11cd7"],
Cell[48272, 1191, 5763, 169, 442, "Input",ExpressionUUID->"3b026f50-74e8-47ea-9b65-5708cecb4224"],
Cell[54038, 1362, 576, 16, 101, "Input",ExpressionUUID->"32678e5b-cacb-4914-871b-e514db6b9001"],
Cell[54617, 1380, 1457, 38, 182, "Input",ExpressionUUID->"9fca1398-c03c-43e4-bd99-054cba98489d"],
Cell[56077, 1420, 1147, 27, 182, "Input",ExpressionUUID->"4a6d63ba-b190-4097-bc1e-1de1dbdb9712"],
Cell[57227, 1449, 2692, 80, 260, "Input",ExpressionUUID->"bd2f10cc-2728-43f9-9e29-3ecccadfecad"],
Cell[59922, 1531, 11937, 341, 855, "Input",ExpressionUUID->"5c228a1e-30a8-4551-ac44-013adb9fee58"],
Cell[71862, 1874, 5908, 193, 494, "Input",ExpressionUUID->"835d0c66-9e89-4ea6-beb8-e47124c22ee9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77807, 2072, 276, 5, 87, "Section",ExpressionUUID->"61a905e8-3881-4aee-91b0-455fa0d6f63b"],
Cell[78086, 2079, 17262, 437, 1275, "Input",ExpressionUUID->"3923b89b-3ed2-4b50-8e4d-4031fe113774"],
Cell[95351, 2518, 2334, 61, 208, "Input",ExpressionUUID->"221227f1-430b-47c7-890b-013f834d9af6"],
Cell[97688, 2581, 1155, 33, 130, "Input",ExpressionUUID->"fa1308b3-ffd8-4afa-8caf-a5fb9dfe4c25"],
Cell[CellGroupData[{
Cell[98868, 2618, 213, 4, 51, "Input",ExpressionUUID->"29b4e093-3829-44fa-977b-9ea7842b8619"],
Cell[99084, 2624, 3314, 104, 223, "Output",ExpressionUUID->"010f3650-9539-471e-8c67-288010cec95c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[102447, 2734, 251, 4, 87, "Section",ExpressionUUID->"a9bf22d1-21a7-4eaf-a108-c59191ea6b02"],
Cell[102701, 2740, 9370, 229, 676, "Input",ExpressionUUID->"8a9b8649-a2fe-48ee-b5ad-1f76156372d0"],
Cell[112074, 2971, 2495, 61, 234, "Input",ExpressionUUID->"e948af1c-6b3e-4bb9-b303-2b407544f379"],
Cell[114572, 3034, 921, 26, 156, "Input",ExpressionUUID->"834b84c1-8e13-47c9-9261-faa123d0cd75"],
Cell[115496, 3062, 1861, 43, 156, "Input",ExpressionUUID->"09d15103-7519-47ad-99bb-a4d7a28a7d0e"]
}, Closed]],
Cell[CellGroupData[{
Cell[117394, 3110, 190, 3, 68, "Section",ExpressionUUID->"51c8b79b-932a-4bdd-86b8-9f06849e255f"],
Cell[CellGroupData[{
Cell[117609, 3117, 2982, 76, 260, "Input",ExpressionUUID->"ea70f9c9-d4d2-46fe-9ada-2ec969aca9f4"],
Cell[120594, 3195, 355, 9, 70, "Message",ExpressionUUID->"00575d6a-df6e-47b5-81aa-7b8585bc3ed8"],
Cell[120952, 3206, 356, 9, 70, "Message",ExpressionUUID->"7b20b93d-6624-41d2-863a-c9dd0aff25ac"],
Cell[121311, 3217, 430, 10, 70, "Message",ExpressionUUID->"8ca1248d-b4b1-44c3-8569-da98975b1fff"],
Cell[121744, 3229, 159, 3, 70, "Output",ExpressionUUID->"2974b22e-fa71-4f13-a675-e5ff78183f17"],
Cell[121906, 3234, 430, 10, 70, "Message",ExpressionUUID->"7fffb705-68cb-4819-8821-2a654bb1aa61"],
Cell[122339, 3246, 161, 3, 70, "Output",ExpressionUUID->"bdbabdf8-f62b-4b94-a1df-cc8fcf7e68c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122537, 3254, 3154, 72, 147, "Input",ExpressionUUID->"84d91cb8-e100-4f54-82fe-9f221285ab55"],
Cell[125694, 3328, 356, 9, 70, "Message",ExpressionUUID->"b36478be-2c30-41a1-aac9-fe5eb9115cfc"],
Cell[126053, 3339, 353, 9, 70, "Message",ExpressionUUID->"edaca104-d616-4c2e-a612-c928f897dfad"],
Cell[126409, 3350, 2531, 44, 70, "Output",ExpressionUUID->"c79c1561-3daf-4a0b-812b-92d38426190e"],
Cell[128943, 3396, 3127, 62, 70, "Output",ExpressionUUID->"003bf0dc-a2ad-42a0-b7d1-f673ded87a78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132107, 3463, 24371, 681, 2212, "Input",ExpressionUUID->"0472f27d-9a7f-4178-9309-50f70c8fbd78"],
Cell[156481, 4146, 357, 9, 70, "Message",ExpressionUUID->"1aca0c78-ec7b-4660-9254-485cdb6b6b15"],
Cell[156841, 4157, 564, 12, 70, "Message",ExpressionUUID->"71a8be87-ff30-466e-8c96-7aaa0316c56e"],
Cell[157408, 4171, 159, 3, 70, "Output",ExpressionUUID->"567fa312-ba6a-4bb0-ac22-03d813f33c19"],
Cell[157570, 4176, 473, 11, 70, "Message",ExpressionUUID->"e37982fd-8a0e-4401-b1c2-ec803c2cc1af"],
Cell[158046, 4189, 159, 3, 70, "Output",ExpressionUUID->"ecb96d49-01c4-4a18-b640-b95519843087"],
Cell[158208, 4194, 358, 9, 70, "Message",ExpressionUUID->"e292c243-2bf9-404f-8521-5c02f55c0aa2"],
Cell[158569, 4205, 470, 11, 70, "Message",ExpressionUUID->"3138b5cb-ed22-41b6-8086-eff4eafec231"],
Cell[159042, 4218, 159, 3, 70, "Output",ExpressionUUID->"b95bcdcf-f684-45a7-8ea0-bdc08e28d84f"],
Cell[159204, 4223, 433, 10, 70, "Message",ExpressionUUID->"b8f9971c-b0d1-4306-8bd8-4991c6dd804d"],
Cell[159640, 4235, 161, 3, 70, "Output",ExpressionUUID->"beb4c58e-0a8a-416b-a92d-51bb299ff4ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159838, 4243, 372, 8, 51, "Input",ExpressionUUID->"b2ceee9f-0a48-4209-8663-4d3f868954b2"],
Cell[160213, 4253, 615, 11, 70, "Output",ExpressionUUID->"23c303bb-3120-49ee-89fb-0a35144204ce"]
}, Open  ]],
Cell[160843, 4267, 7342, 208, 624, "Input",ExpressionUUID->"98f6ff7c-f071-411c-95fb-9bc9ab005816"],
Cell[168188, 4477, 1620, 40, 156, "Input",ExpressionUUID->"76ebb2e1-fb6b-4889-9d7e-34f9228369b5"],
Cell[169811, 4519, 2612, 72, 234, "Input",ExpressionUUID->"915d91cd-c71e-4996-b17e-e6d137cb7421"],
Cell[172426, 4593, 3551, 94, 286, "Input",ExpressionUUID->"4f2228f5-f4bc-446d-ba13-19a94d114a66"],
Cell[175980, 4689, 4194, 109, 396, "Input",ExpressionUUID->"b0f0e953-3846-4b11-bc15-1d8ecf344bb8"],
Cell[180177, 4800, 515, 14, 51, "Input",ExpressionUUID->"58a3d160-9174-49f5-9daf-a9c702f5dc0e"],
Cell[180695, 4816, 5515, 147, 469, "Input",ExpressionUUID->"84770e70-7f73-47e4-98a4-d78342eb9e92"],
Cell[186213, 4965, 759, 20, 78, "Input",ExpressionUUID->"90439321-0d9a-46df-82a5-aea5e28fe481"],
Cell[186975, 4987, 288, 7, 51, "Input",ExpressionUUID->"189cf105-7455-4566-b8eb-b5851bef6c67"]
}, Closed]],
Cell[CellGroupData[{
Cell[187300, 4999, 168, 3, 68, "Section",ExpressionUUID->"2068968a-7173-4513-b2f5-da82e26ce4ff"],
Cell[187471, 5004, 21075, 618, 1248, "Input",ExpressionUUID->"46cb760f-ecc2-4aff-a9aa-be0515046873"],
Cell[208549, 5624, 1048, 29, 104, "Input",ExpressionUUID->"601feaf4-6821-40b5-a22a-bcad2ee76698"],
Cell[209600, 5655, 824, 24, 78, "Input",ExpressionUUID->"a4d4f075-8661-4926-b826-4e4e0a06a9fa"],
Cell[210427, 5681, 1108, 30, 130, "Input",ExpressionUUID->"e832d907-1791-4d46-bb98-a453eefea01c"]
}, Closed]],
Cell[CellGroupData[{
Cell[211572, 5716, 225, 4, 68, "Section",ExpressionUUID->"da8a9d91-1b54-46b0-af96-6c4c1159d0e7"],
Cell[CellGroupData[{
Cell[211822, 5724, 163, 3, 41, "Subsubsection",ExpressionUUID->"aa4171ce-ee5f-4149-a43e-f7491bb6e9f7"],
Cell[211988, 5729, 1621, 47, 182, "Input",ExpressionUUID->"9ffb383e-0cc5-4273-924c-fe799c24189a"],
Cell[213612, 5778, 1214, 28, 104, "Input",ExpressionUUID->"ebe53da6-2405-474d-baaf-490009e2f361"],
Cell[CellGroupData[{
Cell[214851, 5810, 3233, 93, 442, "Input",ExpressionUUID->"81855e2f-3ffd-4f70-a2f3-dabfe460f2ae"],
Cell[218087, 5905, 360, 9, 70, "Message",ExpressionUUID->"8ccfdb36-fb53-47e1-9068-08a71e933ff4"],
Cell[218450, 5916, 636, 13, 70, "Message",ExpressionUUID->"12266dc6-6ac2-4282-a096-593dce350bdb"],
Cell[219089, 5931, 159, 3, 70, "Output",ExpressionUUID->"87d7847e-41e7-4707-9983-2eba9f66f7d6"],
Cell[219251, 5936, 637, 13, 70, "Message",ExpressionUUID->"f7c19461-b3b1-48f8-83df-e95c9138dcd8"],
Cell[219891, 5951, 161, 3, 70, "Output",ExpressionUUID->"d5c516b8-8bae-4a6e-8aed-b26237845349"],
Cell[220055, 5956, 440, 10, 70, "Message",ExpressionUUID->"6c73c632-4919-4f6f-ac79-00f0eae808b7"],
Cell[220498, 5968, 161, 3, 70, "Output",ExpressionUUID->"ddd4a990-3c42-4685-864b-ce4fb78f294f"],
Cell[220662, 5973, 441, 10, 70, "Message",ExpressionUUID->"75436dbe-4abd-4b63-9b98-f9e9a8649dbd"],
Cell[221106, 5985, 159, 3, 70, "Output",ExpressionUUID->"2b276b3e-4434-4661-9f66-2626bcd78c38"],
Cell[221268, 5990, 436, 10, 70, "Message",ExpressionUUID->"608bccef-2578-4860-b919-9bac71fe54bb"],
Cell[221707, 6002, 158, 3, 70, "Output",ExpressionUUID->"87ad2ed6-9ab6-4cce-9665-42074c29d3a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221902, 6010, 15355, 432, 910, "Input",ExpressionUUID->"f2717780-8787-4623-8120-caef4ecabb88"],
Cell[237260, 6444, 369, 9, 70, "Message",ExpressionUUID->"c928ef66-d01e-4b0b-930f-d1b475568c64"],
Cell[237632, 6455, 559, 12, 70, "Message",ExpressionUUID->"928885b3-ee96-4dca-bded-2af173d92be4"],
Cell[238194, 6469, 159, 3, 70, "Output",ExpressionUUID->"9c37ebdb-a71b-40d1-ac20-8bc7283295ee"],
Cell[238356, 6474, 560, 12, 70, "Message",ExpressionUUID->"a1a77aba-c79c-468e-a571-4f8b26684c0d"],
Cell[238919, 6488, 159, 3, 70, "Output",ExpressionUUID->"59cfd0b4-56ea-4291-9a1b-01048ea03646"],
Cell[239081, 6493, 559, 12, 70, "Message",ExpressionUUID->"654f0cfe-3b5c-412a-891b-75183afe9573"],
Cell[239643, 6507, 159, 3, 70, "Output",ExpressionUUID->"72f9a69f-121e-4047-814f-840994c18544"],
Cell[239805, 6512, 561, 12, 70, "Message",ExpressionUUID->"1dbd7cc4-fbac-44ad-94f9-64497c7cb01f"],
Cell[240369, 6526, 159, 3, 70, "Output",ExpressionUUID->"eaa65403-3dd0-49cb-a03f-67bc917893ed"],
Cell[240531, 6531, 493, 11, 70, "Message",ExpressionUUID->"0b47c0ff-d7f6-4e37-aa40-4e24f0bd644e"],
Cell[241027, 6544, 161, 3, 70, "Output",ExpressionUUID->"012e26c3-c7c2-4741-88d0-e3381d6f3aee"],
Cell[241191, 6549, 495, 11, 70, "Message",ExpressionUUID->"d208b1ad-9466-4a1f-a340-99ed4aab122a"],
Cell[241689, 6562, 161, 3, 70, "Output",ExpressionUUID->"31f0eb03-050e-418b-ac2e-e994c930d3ce"],
Cell[241853, 6567, 496, 11, 70, "Message",ExpressionUUID->"4186e2af-cfd7-488b-81a0-7c5ad71a99e0"],
Cell[242352, 6580, 159, 3, 70, "Output",ExpressionUUID->"dfbea743-1e14-4ed8-b96b-417be00342a2"],
Cell[242514, 6585, 498, 11, 70, "Message",ExpressionUUID->"70a9c385-04cc-414e-9d53-6b402f8cee39"],
Cell[243015, 6598, 159, 3, 70, "Output",ExpressionUUID->"5b405a39-5136-4cd3-90e7-74199b181190"],
Cell[243177, 6603, 512, 11, 70, "Message",ExpressionUUID->"e48b5ea6-a31d-44e5-a5dd-76462f1caa0c"],
Cell[243692, 6616, 158, 3, 70, "Output",ExpressionUUID->"3555b5ed-ee36-4f8c-9741-8b3b01b95e47"],
Cell[243853, 6621, 512, 11, 70, "Message",ExpressionUUID->"b7caafe6-623d-453c-acd9-e76484b74267"],
Cell[244368, 6634, 159, 3, 70, "Output",ExpressionUUID->"f24a0a85-826f-425f-8f65-5f87eb56f790"],
Cell[244530, 6639, 515, 11, 70, "Message",ExpressionUUID->"9ec3b056-50e8-4efe-b34d-23277b6e8246"],
Cell[245048, 6652, 161, 3, 70, "Output",ExpressionUUID->"c7d4cd7d-98f7-4692-a9bb-ffa0221195da"],
Cell[245212, 6657, 455, 10, 70, "Message",ExpressionUUID->"8bb7e45c-541a-433a-b468-550bbf191651"],
Cell[245670, 6669, 159, 3, 70, "Output",ExpressionUUID->"a33562fb-223c-4d00-ac96-74c6246c7a42"],
Cell[245832, 6674, 497, 11, 70, "Message",ExpressionUUID->"97d13e4a-ea40-40cd-a9c2-02d95704ea5a"],
Cell[246332, 6687, 161, 3, 70, "Output",ExpressionUUID->"ab7df680-8e5f-4655-bdf1-113c0f6ae573"],
Cell[246496, 6692, 495, 11, 70, "Message",ExpressionUUID->"bbd58e3a-710b-4d70-9287-bd60f3cad216"],
Cell[246994, 6705, 159, 3, 70, "Output",ExpressionUUID->"aec4de4d-e754-49ad-89c4-a77c0aeef08f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247190, 6713, 1183, 30, 104, "Input",ExpressionUUID->"88067925-6de4-4adf-b660-fee27f053564"],
Cell[248376, 6745, 370, 9, 70, "Message",ExpressionUUID->"83fbb123-50d0-488d-aca4-e4ef08fb01ff"],
Cell[248749, 6756, 488, 11, 70, "Message",ExpressionUUID->"f13a9c7a-ec5d-4c68-9a6a-0c855a893890"],
Cell[249240, 6769, 159, 3, 70, "Output",ExpressionUUID->"7339511a-f24c-4699-af03-71909b57b805"],
Cell[249402, 6774, 488, 11, 70, "Message",ExpressionUUID->"a26cb03b-2b4e-4e35-a8a5-52d955121663"],
Cell[249893, 6787, 159, 3, 70, "Output",ExpressionUUID->"4be13ae5-7010-4a32-8e6f-6f8374fd7972"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250089, 6795, 933, 21, 104, "Input",ExpressionUUID->"441bd8c5-3adf-43ab-bfb6-e9a8ffcdce3e"],
Cell[251025, 6818, 366, 9, 70, "Message",ExpressionUUID->"c38746c4-a21b-43e9-afbb-a04cc5816bd0"],
Cell[251394, 6829, 485, 11, 70, "Message",ExpressionUUID->"dbec5e4a-6544-4435-b544-b193d2eef54a"],
Cell[251882, 6842, 159, 3, 70, "Output",ExpressionUUID->"29284c27-d1f2-4317-8d1b-2d4553e0ee1c"],
Cell[252044, 6847, 511, 11, 70, "Message",ExpressionUUID->"3f4c8dd0-fe12-4353-8de5-ce2e482092f1"],
Cell[252558, 6860, 158, 3, 70, "Output",ExpressionUUID->"f255960e-8e22-417a-a52c-9f85459fa05a"]
}, Open  ]],
Cell[252731, 6866, 2355, 65, 208, "Input",ExpressionUUID->"cc89f358-78bf-40fe-962a-c94d366446b3"],
Cell[CellGroupData[{
Cell[255111, 6935, 3188, 85, 260, "Input",ExpressionUUID->"1485dcfb-cc31-40fb-a75c-a3b44fa8a20c"],
Cell[258302, 7022, 366, 9, 70, "Message",ExpressionUUID->"0b0fb4bb-49cf-4165-8ca5-d7b25187004f"],
Cell[258671, 7033, 449, 10, 70, "Message",ExpressionUUID->"727036b8-6f8c-44f6-8af3-52a87e495f97"],
Cell[259123, 7045, 159, 3, 70, "Output",ExpressionUUID->"fea8bf94-bd9b-4bab-b617-b33ac17e7674"],
Cell[259285, 7050, 452, 10, 70, "Message",ExpressionUUID->"c3b8b1a9-5b18-4831-914b-a0682438c81b"],
Cell[259740, 7062, 159, 3, 70, "Output",ExpressionUUID->"dcb6f69c-4dc1-4f6e-8c69-4ec82dd7ee82"],
Cell[259902, 7067, 453, 10, 70, "Message",ExpressionUUID->"aa97f30f-401f-43a2-ad8e-98e5bf1988c9"],
Cell[260358, 7079, 159, 3, 70, "Output",ExpressionUUID->"df4ecaeb-d008-4758-8b03-80ca17e69cd3"],
Cell[260520, 7084, 450, 10, 70, "Message",ExpressionUUID->"3d59fa97-780b-45fd-8da7-6b33c1fd0781"],
Cell[260973, 7096, 159, 3, 70, "Output",ExpressionUUID->"d4fc890f-fe4a-492e-8872-91dee726c96b"],
Cell[261135, 7101, 473, 11, 70, "Message",ExpressionUUID->"83b00423-f837-449d-bf51-d6ed21e6dfbf"],
Cell[261611, 7114, 159, 3, 70, "Output",ExpressionUUID->"8703b9f7-1f2a-49bf-b504-a8cd17fad3ab"]
}, Open  ]],
Cell[261785, 7120, 2042, 54, 182, "Input",ExpressionUUID->"109aa14b-d071-455f-85a8-485af7850572"],
Cell[263830, 7176, 4678, 129, 364, "Input",ExpressionUUID->"6081fdd3-4eb3-431d-9d57-c725f3951126"],
Cell[CellGroupData[{
Cell[268533, 7309, 181, 3, 51, "Input",ExpressionUUID->"6734054c-f8df-4c5f-b05e-e13ef842e031"],
Cell[268717, 7314, 451, 8, 70, "Output",ExpressionUUID->"1abd5b21-ae5f-4000-bd8b-777e50bdda7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269205, 7327, 511, 14, 51, "Input",ExpressionUUID->"1585890d-e2d6-4f4e-bbf7-b8cea6d4b7d2"],
Cell[269719, 7343, 515, 9, 70, "Output",ExpressionUUID->"bfcfa0e5-c515-4c82-a1e9-76005b85b42e"]
}, Open  ]],
Cell[270249, 7355, 6592, 172, 520, "Input",ExpressionUUID->"dcf534f1-3d4f-44fc-973c-a5c1e3eb1583"],
Cell[CellGroupData[{
Cell[276866, 7531, 917, 20, 51, "Input",ExpressionUUID->"fd0a54cd-2351-4ce9-9e2a-36e47215275e"],
Cell[277786, 7553, 1753, 48, 70, "Output",ExpressionUUID->"18c48fbe-dea4-4b55-ab45-cd073ed0b27a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279576, 7606, 719, 21, 51, "Input",ExpressionUUID->"ea5119f4-f7f9-4db1-bdc4-6a8ab5a87518"],
Cell[280298, 7629, 1269, 34, 70, "Output",ExpressionUUID->"e365626c-78f3-40d8-be11-43a9a23d21bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281604, 7668, 608, 17, 51, "Input",ExpressionUUID->"15afbb5c-2510-40ae-b3a7-ab109d212069"],
Cell[282215, 7687, 1954, 59, 70, "Output",ExpressionUUID->"4ce7d402-643d-4109-9fc4-fd7af7a7f6a1"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[284242, 7754, 152, 3, 71, "Chapter",ExpressionUUID->"33fa4030-ed72-4bf1-ab48-7145b1dd9e42"],
Cell[CellGroupData[{
Cell[284419, 7761, 578, 8, 87, "Section",ExpressionUUID->"46e87e36-11ff-4c31-b68c-9175983751c8"],
Cell[CellGroupData[{
Cell[285022, 7773, 3798, 108, 286, "Input",ExpressionUUID->"58533ddb-9408-40c9-b61f-fc317f07bc29"],
Cell[288823, 7883, 1152, 19, 51, "Output",ExpressionUUID->"e4263e28-3795-4711-8a4f-6d53f78e1672"],
Cell[289978, 7904, 1366, 27, 51, "Output",ExpressionUUID->"3d5e85c5-cdba-4643-ab26-e21c595e39e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291381, 7936, 207, 4, 51, "Input",ExpressionUUID->"7b683a52-acd5-456b-9d9d-ae02967f757e"],
Cell[291591, 7942, 3220, 99, 133, "Output",ExpressionUUID->"1f77f5ba-19b9-476f-9099-bac745b5f0df"]
}, Open  ]],
Cell[294826, 8044, 1080, 29, 78, "Input",ExpressionUUID->"14af6ed1-df99-4957-a313-4b674b22c3ed"],
Cell[295909, 8075, 407, 8, 51, "Input",ExpressionUUID->"cd1731c1-c745-4326-bf8d-e365e5ba5b27"],
Cell[296319, 8085, 628, 14, 51, "Input",ExpressionUUID->"5cffdd3a-2da2-4275-81bf-8843becae3de"],
Cell[296950, 8101, 797, 21, 51, "Input",ExpressionUUID->"c0305c13-cb5b-4078-abf7-3cc4ab402e2c"],
Cell[297750, 8124, 742, 20, 51, "Input",ExpressionUUID->"aec3ed12-97f7-408e-ba01-e8932dd22eba"],
Cell[CellGroupData[{
Cell[298517, 8148, 752, 17, 51, "Input",ExpressionUUID->"5d2dbdb3-26c5-40cb-9d4c-d262da37b424"],
Cell[299272, 8167, 712, 11, 51, "Output",ExpressionUUID->"deff1f51-1fa0-4bc0-be3c-bd90474a92cf"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

